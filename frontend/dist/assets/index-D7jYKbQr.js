import{j as n,M as Ea,S as Ca,U as Ne,C as Ta,P as Bt,a as Z,G as zt,B as ke,D as de,b as Pa,L as Aa,c as me,H as Oa,d as De,E as V,e as _e,f as at,g as cn,h as Ra,T as Ht,i as nr,k as Rs,l as Ds,A as ar,F as dn,m as gr,n as Zt,o as Re,X as yr,I as br,p as wt,q as Da,r as $a,s as un,t as hn,u as fn,v as mn,w as $s,x as pn,y as vr,z as Fa,J as Ua,K as La,N as wr,O as Ia,Q as Ma,R as qa,V as bs,W as Ba,Y as za}from"./ui-B8NJjiyd.js";import{a as Ha,b as Wa,c as nt,r as j,g as Ka,d as ue}from"./vendor-D2vcVbK5.js";import{L,u as Va,a as Ve,b as ir,R as Ja,c as te,B as Ga}from"./router-C0zEL855.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var Fs={},jr=Ha;Fs.createRoot=jr.createRoot,Fs.hydrateRoot=jr.hydrateRoot;function Us(r,e){return Us=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t},Us(r,e)}function es(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Us(r,e)}var ts=function(){function r(){this.listeners=[]}var e=r.prototype;return e.subscribe=function(s){var a=this,i=s||function(){};return this.listeners.push(i),this.onSubscribe(),function(){a.listeners=a.listeners.filter(function(o){return o!==i}),a.onUnsubscribe()}},e.hasListeners=function(){return this.listeners.length>0},e.onSubscribe=function(){},e.onUnsubscribe=function(){},r}();function q(){return q=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)({}).hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},q.apply(null,arguments)}var xn=typeof window>"u";function Y(){}function Qa(r,e){return typeof r=="function"?r(e):r}function Ya(r){return typeof r=="number"&&r>=0&&r!==1/0}function Wt(r){return Array.isArray(r)?r:[r]}function Xa(r,e){return Math.max(r+(e||0)-Date.now(),0)}function vs(r,e,t){return ss(r)?typeof e=="function"?q({},t,{queryKey:r,queryFn:e}):q({},e,{queryKey:r}):r}function Pe(r,e,t){return ss(r)?[q({},e,{queryKey:r}),t]:[r||{},e]}function Za(r,e){if(r===!0&&e===!0||r==null&&e==null)return"all";if(r===!1&&e===!1)return"none";var t=r??!e;return t?"active":"inactive"}function kr(r,e){var t=r.active,s=r.exact,a=r.fetching,i=r.inactive,o=r.predicate,l=r.queryKey,c=r.stale;if(ss(l)){if(s){if(e.queryHash!==or(l,e.options))return!1}else if(!Kt(e.queryKey,l))return!1}var d=Za(t,i);if(d==="none")return!1;if(d!=="all"){var u=e.isActive();if(d==="active"&&!u||d==="inactive"&&u)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||typeof a=="boolean"&&e.isFetching()!==a||o&&!o(e))}function _r(r,e){var t=r.exact,s=r.fetching,a=r.predicate,i=r.mutationKey;if(ss(i)){if(!e.options.mutationKey)return!1;if(t){if(Be(e.options.mutationKey)!==Be(i))return!1}else if(!Kt(e.options.mutationKey,i))return!1}return!(typeof s=="boolean"&&e.state.status==="loading"!==s||a&&!a(e))}function or(r,e){var t=(e==null?void 0:e.queryKeyHashFn)||Be;return t(r)}function Be(r){var e=Wt(r);return ei(e)}function ei(r){return JSON.stringify(r,function(e,t){return Ls(t)?Object.keys(t).sort().reduce(function(s,a){return s[a]=t[a],s},{}):t})}function Kt(r,e){return gn(Wt(r),Wt(e))}function gn(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?!Object.keys(e).some(function(t){return!gn(r[t],e[t])}):!1}function yn(r,e){if(r===e)return r;var t=Array.isArray(r)&&Array.isArray(e);if(t||Ls(r)&&Ls(e)){for(var s=t?r.length:Object.keys(r).length,a=t?e:Object.keys(e),i=a.length,o=t?[]:{},l=0,c=0;c<i;c++){var d=t?c:a[c];o[d]=yn(r[d],e[d]),o[d]===r[d]&&l++}return s===i&&l===s?r:o}return e}function Ls(r){if(!Nr(r))return!1;var e=r.constructor;if(typeof e>"u")return!0;var t=e.prototype;return!(!Nr(t)||!t.hasOwnProperty("isPrototypeOf"))}function Nr(r){return Object.prototype.toString.call(r)==="[object Object]"}function ss(r){return typeof r=="string"||Array.isArray(r)}function ti(r){return new Promise(function(e){setTimeout(e,r)})}function Sr(r){Promise.resolve().then(r).catch(function(e){return setTimeout(function(){throw e})})}function bn(){if(typeof AbortController=="function")return new AbortController}var si=function(r){es(e,r);function e(){var s;return s=r.call(this)||this,s.setup=function(a){var i;if(!xn&&((i=window)!=null&&i.addEventListener)){var o=function(){return a()};return window.addEventListener("visibilitychange",o,!1),window.addEventListener("focus",o,!1),function(){window.removeEventListener("visibilitychange",o),window.removeEventListener("focus",o)}}},s}var t=e.prototype;return t.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},t.onUnsubscribe=function(){if(!this.hasListeners()){var a;(a=this.cleanup)==null||a.call(this),this.cleanup=void 0}},t.setEventListener=function(a){var i,o=this;this.setup=a,(i=this.cleanup)==null||i.call(this),this.cleanup=a(function(l){typeof l=="boolean"?o.setFocused(l):o.onFocus()})},t.setFocused=function(a){this.focused=a,a&&this.onFocus()},t.onFocus=function(){this.listeners.forEach(function(a){a()})},t.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},e}(ts),$t=new si,ri=function(r){es(e,r);function e(){var s;return s=r.call(this)||this,s.setup=function(a){var i;if(!xn&&((i=window)!=null&&i.addEventListener)){var o=function(){return a()};return window.addEventListener("online",o,!1),window.addEventListener("offline",o,!1),function(){window.removeEventListener("online",o),window.removeEventListener("offline",o)}}},s}var t=e.prototype;return t.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},t.onUnsubscribe=function(){if(!this.hasListeners()){var a;(a=this.cleanup)==null||a.call(this),this.cleanup=void 0}},t.setEventListener=function(a){var i,o=this;this.setup=a,(i=this.cleanup)==null||i.call(this),this.cleanup=a(function(l){typeof l=="boolean"?o.setOnline(l):o.onOnline()})},t.setOnline=function(a){this.online=a,a&&this.onOnline()},t.onOnline=function(){this.listeners.forEach(function(a){a()})},t.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},e}(ts),Ft=new ri;function ni(r){return Math.min(1e3*Math.pow(2,r),3e4)}function Vt(r){return typeof(r==null?void 0:r.cancel)=="function"}var vn=function(e){this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent};function ws(r){return r instanceof vn}var wn=function(e){var t=this,s=!1,a,i,o,l;this.abort=e.abort,this.cancel=function(m){return a==null?void 0:a(m)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return i==null?void 0:i()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(m,f){o=m,l=f});var c=function(f){t.isResolved||(t.isResolved=!0,e.onSuccess==null||e.onSuccess(f),i==null||i(),o(f))},d=function(f){t.isResolved||(t.isResolved=!0,e.onError==null||e.onError(f),i==null||i(),l(f))},u=function(){return new Promise(function(f){i=f,t.isPaused=!0,e.onPause==null||e.onPause()}).then(function(){i=void 0,t.isPaused=!1,e.onContinue==null||e.onContinue()})},h=function m(){if(!t.isResolved){var f;try{f=e.fn()}catch(p){f=Promise.reject(p)}a=function(w){if(!t.isResolved&&(d(new vn(w)),t.abort==null||t.abort(),Vt(f)))try{f.cancel()}catch{}},t.isTransportCancelable=Vt(f),Promise.resolve(f).then(c).catch(function(p){var w,g;if(!t.isResolved){var y=(w=e.retry)!=null?w:3,N=(g=e.retryDelay)!=null?g:ni,x=typeof N=="function"?N(t.failureCount,p):N,C=y===!0||typeof y=="number"&&t.failureCount<y||typeof y=="function"&&y(t.failureCount,p);if(s||!C){d(p);return}t.failureCount++,e.onFail==null||e.onFail(t.failureCount,p),ti(x).then(function(){if(!$t.isFocused()||!Ft.isOnline())return u()}).then(function(){s?d(p):m()})}})}};h()},ai=function(){function r(){this.queue=[],this.transactions=0,this.notifyFn=function(t){t()},this.batchNotifyFn=function(t){t()}}var e=r.prototype;return e.batch=function(s){var a;this.transactions++;try{a=s()}finally{this.transactions--,this.transactions||this.flush()}return a},e.schedule=function(s){var a=this;this.transactions?this.queue.push(s):Sr(function(){a.notifyFn(s)})},e.batchCalls=function(s){var a=this;return function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];a.schedule(function(){s.apply(void 0,o)})}},e.flush=function(){var s=this,a=this.queue;this.queue=[],a.length&&Sr(function(){s.batchNotifyFn(function(){a.forEach(function(i){s.notifyFn(i)})})})},e.setNotifyFunction=function(s){this.notifyFn=s},e.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},r}(),G=new ai,jn=console;function kn(){return jn}function ii(r){jn=r}var oi=function(){function r(t){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.cache=t.cache,this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.initialState=t.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=t.meta,this.scheduleGc()}var e=r.prototype;return e.setOptions=function(s){var a;this.options=q({},this.defaultOptions,s),this.meta=s==null?void 0:s.meta,this.cacheTime=Math.max(this.cacheTime||0,(a=this.options.cacheTime)!=null?a:5*60*1e3)},e.setDefaultOptions=function(s){this.defaultOptions=s},e.scheduleGc=function(){var s=this;this.clearGcTimeout(),Ya(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},e.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},e.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},e.setData=function(s,a){var i,o,l=this.state.data,c=Qa(s,l);return(i=(o=this.options).isDataEqual)!=null&&i.call(o,l,c)?c=l:this.options.structuralSharing!==!1&&(c=yn(l,c)),this.dispatch({data:c,type:"success",dataUpdatedAt:a==null?void 0:a.updatedAt}),c},e.setState=function(s,a){this.dispatch({type:"setState",state:s,setStateOptions:a})},e.cancel=function(s){var a,i=this.promise;return(a=this.retryer)==null||a.cancel(s),i?i.then(Y).catch(Y):Promise.resolve()},e.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},e.reset=function(){this.destroy(),this.setState(this.initialState)},e.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},e.isFetching=function(){return this.state.isFetching},e.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},e.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!Xa(this.state.dataUpdatedAt,s)},e.onFocus=function(){var s,a=this.observers.find(function(i){return i.shouldFetchOnWindowFocus()});a&&a.refetch(),(s=this.retryer)==null||s.continue()},e.onOnline=function(){var s,a=this.observers.find(function(i){return i.shouldFetchOnReconnect()});a&&a.refetch(),(s=this.retryer)==null||s.continue()},e.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},e.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(a){return a!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},e.getObserversCount=function(){return this.observers.length},e.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},e.fetch=function(s,a){var i=this,o,l,c;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(a!=null&&a.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var d;return(d=this.retryer)==null||d.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var u=this.observers.find(function(N){return N.options.queryFn});u&&this.setOptions(u.options)}var h=Wt(this.queryKey),m=bn(),f={queryKey:h,pageParam:void 0,meta:this.meta};Object.defineProperty(f,"signal",{enumerable:!0,get:function(){if(m)return i.abortSignalConsumed=!0,m.signal}});var p=function(){return i.options.queryFn?(i.abortSignalConsumed=!1,i.options.queryFn(f)):Promise.reject("Missing queryFn")},w={fetchOptions:a,options:this.options,queryKey:h,state:this.state,fetchFn:p,meta:this.meta};if((o=this.options.behavior)!=null&&o.onFetch){var g;(g=this.options.behavior)==null||g.onFetch(w)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((l=w.fetchOptions)==null?void 0:l.meta)){var y;this.dispatch({type:"fetch",meta:(y=w.fetchOptions)==null?void 0:y.meta})}return this.retryer=new wn({fn:w.fetchFn,abort:m==null||(c=m.abort)==null?void 0:c.bind(m),onSuccess:function(x){i.setData(x),i.cache.config.onSuccess==null||i.cache.config.onSuccess(x,i),i.cacheTime===0&&i.optionalRemove()},onError:function(x){ws(x)&&x.silent||i.dispatch({type:"error",error:x}),ws(x)||(i.cache.config.onError==null||i.cache.config.onError(x,i),kn().error(x)),i.cacheTime===0&&i.optionalRemove()},onFail:function(){i.dispatch({type:"failed"})},onPause:function(){i.dispatch({type:"pause"})},onContinue:function(){i.dispatch({type:"continue"})},retry:w.options.retry,retryDelay:w.options.retryDelay}),this.promise=this.retryer.promise,this.promise},e.dispatch=function(s){var a=this;this.state=this.reducer(this.state,s),G.batch(function(){a.observers.forEach(function(i){i.onQueryUpdate(s)}),a.cache.notify({query:a,type:"queryUpdated",action:s})})},e.getDefaultState=function(s){var a=typeof s.initialData=="function"?s.initialData():s.initialData,i=typeof s.initialData<"u",o=i?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,l=typeof a<"u";return{data:a,dataUpdateCount:0,dataUpdatedAt:l?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:l?"success":"idle"}},e.reducer=function(s,a){var i,o;switch(a.type){case"failed":return q({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return q({},s,{isPaused:!0});case"continue":return q({},s,{isPaused:!1});case"fetch":return q({},s,{fetchFailureCount:0,fetchMeta:(i=a.meta)!=null?i:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return q({},s,{data:a.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(o=a.dataUpdatedAt)!=null?o:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var l=a.error;return ws(l)&&l.revert&&this.revertState?q({},this.revertState):q({},s,{error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return q({},s,{isInvalidated:!0});case"setState":return q({},s,a.state);default:return s}},r}(),li=function(r){es(e,r);function e(s){var a;return a=r.call(this)||this,a.config=s||{},a.queries=[],a.queriesMap={},a}var t=e.prototype;return t.build=function(a,i,o){var l,c=i.queryKey,d=(l=i.queryHash)!=null?l:or(c,i),u=this.get(d);return u||(u=new oi({cache:this,queryKey:c,queryHash:d,options:a.defaultQueryOptions(i),state:o,defaultOptions:a.getQueryDefaults(c),meta:i.meta}),this.add(u)),u},t.add=function(a){this.queriesMap[a.queryHash]||(this.queriesMap[a.queryHash]=a,this.queries.push(a),this.notify({type:"queryAdded",query:a}))},t.remove=function(a){var i=this.queriesMap[a.queryHash];i&&(a.destroy(),this.queries=this.queries.filter(function(o){return o!==a}),i===a&&delete this.queriesMap[a.queryHash],this.notify({type:"queryRemoved",query:a}))},t.clear=function(){var a=this;G.batch(function(){a.queries.forEach(function(i){a.remove(i)})})},t.get=function(a){return this.queriesMap[a]},t.getAll=function(){return this.queries},t.find=function(a,i){var o=Pe(a,i),l=o[0];return typeof l.exact>"u"&&(l.exact=!0),this.queries.find(function(c){return kr(l,c)})},t.findAll=function(a,i){var o=Pe(a,i),l=o[0];return Object.keys(l).length>0?this.queries.filter(function(c){return kr(l,c)}):this.queries},t.notify=function(a){var i=this;G.batch(function(){i.listeners.forEach(function(o){o(a)})})},t.onFocus=function(){var a=this;G.batch(function(){a.queries.forEach(function(i){i.onFocus()})})},t.onOnline=function(){var a=this;G.batch(function(){a.queries.forEach(function(i){i.onOnline()})})},e}(ts),ci=function(){function r(t){this.options=q({},t.defaultOptions,t.options),this.mutationId=t.mutationId,this.mutationCache=t.mutationCache,this.observers=[],this.state=t.state||di(),this.meta=t.meta}var e=r.prototype;return e.setState=function(s){this.dispatch({type:"setState",state:s})},e.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},e.removeObserver=function(s){this.observers=this.observers.filter(function(a){return a!==s})},e.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(Y).catch(Y)):Promise.resolve()},e.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},e.execute=function(){var s=this,a,i=this.state.status==="loading",o=Promise.resolve();return i||(this.dispatch({type:"loading",variables:this.options.variables}),o=o.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(l){l!==s.state.context&&s.dispatch({type:"loading",context:l,variables:s.state.variables})})),o.then(function(){return s.executeMutation()}).then(function(l){a=l,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(a,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(a,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(a,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:a}),a}).catch(function(l){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(l,s.state.variables,s.state.context,s),kn().error(l),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(l,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,l,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:l}),l})})},e.executeMutation=function(){var s=this,a;return this.retryer=new wn({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(a=this.options.retry)!=null?a:0,retryDelay:this.options.retryDelay}),this.retryer.promise},e.dispatch=function(s){var a=this;this.state=ui(this.state,s),G.batch(function(){a.observers.forEach(function(i){i.onMutationUpdate(s)}),a.mutationCache.notify(a)})},r}();function di(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function ui(r,e){switch(e.type){case"failed":return q({},r,{failureCount:r.failureCount+1});case"pause":return q({},r,{isPaused:!0});case"continue":return q({},r,{isPaused:!1});case"loading":return q({},r,{context:e.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:e.variables});case"success":return q({},r,{data:e.data,error:null,status:"success",isPaused:!1});case"error":return q({},r,{data:void 0,error:e.error,failureCount:r.failureCount+1,isPaused:!1,status:"error"});case"setState":return q({},r,e.state);default:return r}}var hi=function(r){es(e,r);function e(s){var a;return a=r.call(this)||this,a.config=s||{},a.mutations=[],a.mutationId=0,a}var t=e.prototype;return t.build=function(a,i,o){var l=new ci({mutationCache:this,mutationId:++this.mutationId,options:a.defaultMutationOptions(i),state:o,defaultOptions:i.mutationKey?a.getMutationDefaults(i.mutationKey):void 0,meta:i.meta});return this.add(l),l},t.add=function(a){this.mutations.push(a),this.notify(a)},t.remove=function(a){this.mutations=this.mutations.filter(function(i){return i!==a}),a.cancel(),this.notify(a)},t.clear=function(){var a=this;G.batch(function(){a.mutations.forEach(function(i){a.remove(i)})})},t.getAll=function(){return this.mutations},t.find=function(a){return typeof a.exact>"u"&&(a.exact=!0),this.mutations.find(function(i){return _r(a,i)})},t.findAll=function(a){return this.mutations.filter(function(i){return _r(a,i)})},t.notify=function(a){var i=this;G.batch(function(){i.listeners.forEach(function(o){o(a)})})},t.onFocus=function(){this.resumePausedMutations()},t.onOnline=function(){this.resumePausedMutations()},t.resumePausedMutations=function(){var a=this.mutations.filter(function(i){return i.state.isPaused});return G.batch(function(){return a.reduce(function(i,o){return i.then(function(){return o.continue().catch(Y)})},Promise.resolve())})},e}(ts);function fi(){return{onFetch:function(e){e.fetchFn=function(){var t,s,a,i,o,l,c=(t=e.fetchOptions)==null||(s=t.meta)==null?void 0:s.refetchPage,d=(a=e.fetchOptions)==null||(i=a.meta)==null?void 0:i.fetchMore,u=d==null?void 0:d.pageParam,h=(d==null?void 0:d.direction)==="forward",m=(d==null?void 0:d.direction)==="backward",f=((o=e.state.data)==null?void 0:o.pages)||[],p=((l=e.state.data)==null?void 0:l.pageParams)||[],w=bn(),g=w==null?void 0:w.signal,y=p,N=!1,x=e.options.queryFn||function(){return Promise.reject("Missing queryFn")},C=function(E,I,z,le){return y=le?[I].concat(y):[].concat(y,[I]),le?[z].concat(E):[].concat(E,[z])},P=function(E,I,z,le){if(N)return Promise.reject("Cancelled");if(typeof z>"u"&&!I&&E.length)return Promise.resolve(E);var ie={queryKey:e.queryKey,signal:g,pageParam:z,meta:e.meta},J=x(ie),ye=Promise.resolve(J).then(function(Ee){return C(E,z,Ee,le)});if(Vt(J)){var ce=ye;ce.cancel=J.cancel}return ye},S;if(!f.length)S=P([]);else if(h){var _=typeof u<"u",R=_?u:Er(e.options,f);S=P(f,_,R)}else if(m){var A=typeof u<"u",b=A?u:mi(e.options,f);S=P(f,A,b,!0)}else(function(){y=[];var $=typeof e.options.getNextPageParam>"u",E=c&&f[0]?c(f[0],0,f):!0;S=E?P([],$,p[0]):Promise.resolve(C([],p[0],f[0]));for(var I=function(ie){S=S.then(function(J){var ye=c&&f[ie]?c(f[ie],ie,f):!0;if(ye){var ce=$?p[ie]:Er(e.options,J);return P(J,$,ce)}return Promise.resolve(C(J,p[ie],f[ie]))})},z=1;z<f.length;z++)I(z)})();var k=S.then(function($){return{pages:$,pageParams:y}}),D=k;return D.cancel=function(){N=!0,w==null||w.abort(),Vt(S)&&S.cancel()},k}}}}function Er(r,e){return r.getNextPageParam==null?void 0:r.getNextPageParam(e[e.length-1],e)}function mi(r,e){return r.getPreviousPageParam==null?void 0:r.getPreviousPageParam(e[0],e)}var pi=function(){function r(t){t===void 0&&(t={}),this.queryCache=t.queryCache||new li,this.mutationCache=t.mutationCache||new hi,this.defaultOptions=t.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var e=r.prototype;return e.mount=function(){var s=this;this.unsubscribeFocus=$t.subscribe(function(){$t.isFocused()&&Ft.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=Ft.subscribe(function(){$t.isFocused()&&Ft.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},e.unmount=function(){var s,a;(s=this.unsubscribeFocus)==null||s.call(this),(a=this.unsubscribeOnline)==null||a.call(this)},e.isFetching=function(s,a){var i=Pe(s,a),o=i[0];return o.fetching=!0,this.queryCache.findAll(o).length},e.isMutating=function(s){return this.mutationCache.findAll(q({},s,{fetching:!0})).length},e.getQueryData=function(s,a){var i;return(i=this.queryCache.find(s,a))==null?void 0:i.state.data},e.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(a){var i=a.queryKey,o=a.state,l=o.data;return[i,l]})},e.setQueryData=function(s,a,i){var o=vs(s),l=this.defaultQueryOptions(o);return this.queryCache.build(this,l).setData(a,i)},e.setQueriesData=function(s,a,i){var o=this;return G.batch(function(){return o.getQueryCache().findAll(s).map(function(l){var c=l.queryKey;return[c,o.setQueryData(c,a,i)]})})},e.getQueryState=function(s,a){var i;return(i=this.queryCache.find(s,a))==null?void 0:i.state},e.removeQueries=function(s,a){var i=Pe(s,a),o=i[0],l=this.queryCache;G.batch(function(){l.findAll(o).forEach(function(c){l.remove(c)})})},e.resetQueries=function(s,a,i){var o=this,l=Pe(s,a,i),c=l[0],d=l[1],u=this.queryCache,h=q({},c,{active:!0});return G.batch(function(){return u.findAll(c).forEach(function(m){m.reset()}),o.refetchQueries(h,d)})},e.cancelQueries=function(s,a,i){var o=this,l=Pe(s,a,i),c=l[0],d=l[1],u=d===void 0?{}:d;typeof u.revert>"u"&&(u.revert=!0);var h=G.batch(function(){return o.queryCache.findAll(c).map(function(m){return m.cancel(u)})});return Promise.all(h).then(Y).catch(Y)},e.invalidateQueries=function(s,a,i){var o,l,c,d=this,u=Pe(s,a,i),h=u[0],m=u[1],f=q({},h,{active:(o=(l=h.refetchActive)!=null?l:h.active)!=null?o:!0,inactive:(c=h.refetchInactive)!=null?c:!1});return G.batch(function(){return d.queryCache.findAll(h).forEach(function(p){p.invalidate()}),d.refetchQueries(f,m)})},e.refetchQueries=function(s,a,i){var o=this,l=Pe(s,a,i),c=l[0],d=l[1],u=G.batch(function(){return o.queryCache.findAll(c).map(function(m){return m.fetch(void 0,q({},d,{meta:{refetchPage:c==null?void 0:c.refetchPage}}))})}),h=Promise.all(u).then(Y);return d!=null&&d.throwOnError||(h=h.catch(Y)),h},e.fetchQuery=function(s,a,i){var o=vs(s,a,i),l=this.defaultQueryOptions(o);typeof l.retry>"u"&&(l.retry=!1);var c=this.queryCache.build(this,l);return c.isStaleByTime(l.staleTime)?c.fetch(l):Promise.resolve(c.state.data)},e.prefetchQuery=function(s,a,i){return this.fetchQuery(s,a,i).then(Y).catch(Y)},e.fetchInfiniteQuery=function(s,a,i){var o=vs(s,a,i);return o.behavior=fi(),this.fetchQuery(o)},e.prefetchInfiniteQuery=function(s,a,i){return this.fetchInfiniteQuery(s,a,i).then(Y).catch(Y)},e.cancelMutations=function(){var s=this,a=G.batch(function(){return s.mutationCache.getAll().map(function(i){return i.cancel()})});return Promise.all(a).then(Y).catch(Y)},e.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},e.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},e.getQueryCache=function(){return this.queryCache},e.getMutationCache=function(){return this.mutationCache},e.getDefaultOptions=function(){return this.defaultOptions},e.setDefaultOptions=function(s){this.defaultOptions=s},e.setQueryDefaults=function(s,a){var i=this.queryDefaults.find(function(o){return Be(s)===Be(o.queryKey)});i?i.defaultOptions=a:this.queryDefaults.push({queryKey:s,defaultOptions:a})},e.getQueryDefaults=function(s){var a;return s?(a=this.queryDefaults.find(function(i){return Kt(s,i.queryKey)}))==null?void 0:a.defaultOptions:void 0},e.setMutationDefaults=function(s,a){var i=this.mutationDefaults.find(function(o){return Be(s)===Be(o.mutationKey)});i?i.defaultOptions=a:this.mutationDefaults.push({mutationKey:s,defaultOptions:a})},e.getMutationDefaults=function(s){var a;return s?(a=this.mutationDefaults.find(function(i){return Kt(s,i.mutationKey)}))==null?void 0:a.defaultOptions:void 0},e.defaultQueryOptions=function(s){if(s!=null&&s._defaulted)return s;var a=q({},this.defaultOptions.queries,this.getQueryDefaults(s==null?void 0:s.queryKey),s,{_defaulted:!0});return!a.queryHash&&a.queryKey&&(a.queryHash=or(a.queryKey,a)),a},e.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},e.defaultMutationOptions=function(s){return s!=null&&s._defaulted?s:q({},this.defaultOptions.mutations,this.getMutationDefaults(s==null?void 0:s.mutationKey),s,{_defaulted:!0})},e.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},r}(),xi=Wa.unstable_batchedUpdates;G.setBatchNotifyFunction(xi);var gi=console;ii(gi);var Cr=nt.createContext(void 0),yi=nt.createContext(!1);function bi(r){return r&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Cr),window.ReactQueryClientContext):Cr}var vi=function(e){var t=e.client,s=e.contextSharing,a=s===void 0?!1:s,i=e.children;nt.useEffect(function(){return t.mount(),function(){t.unmount()}},[t]);var o=bi(a);return nt.createElement(yi.Provider,{value:a},nt.createElement(o.Provider,{value:t},i))};let wi={data:""},ji=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||wi,ki=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,_i=/\/\*[^]*?\*\/|  +/g,Tr=/\n+/g,Ae=(r,e)=>{let t="",s="",a="";for(let i in r){let o=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":s+=i[1]=="f"?Ae(o,i):i+"{"+Ae(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=Ae(o,e?e.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Ae.p?Ae.p(i,o):i+":"+o+";")}return t+(e&&a?e+"{"+a+"}":a)+s},be={},_n=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+_n(r[t]);return e}return r},Ni=(r,e,t,s,a)=>{let i=_n(r),o=be[i]||(be[i]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(i));if(!be[o]){let c=i!==r?r:(d=>{let u,h,m=[{}];for(;u=ki.exec(d.replace(_i,""));)u[4]?m.shift():u[3]?(h=u[3].replace(Tr," ").trim(),m.unshift(m[0][h]=m[0][h]||{})):m[0][u[1]]=u[2].replace(Tr," ").trim();return m[0]})(r);be[o]=Ae(a?{["@keyframes "+o]:c}:c,t?"":"."+o)}let l=t&&be.g?be.g:null;return t&&(be.g=be[o]),((c,d,u,h)=>{h?d.data=d.data.replace(h,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(be[o],e,s,l),o},Si=(r,e,t)=>r.reduce((s,a,i)=>{let o=e[i];if(o&&o.call){let l=o(t),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":Ae(l,""):l===!1?"":l}return s+a+(o??"")},"");function rs(r){let e=this||{},t=r.call?r(e.p):r;return Ni(t.unshift?t.raw?Si(t,[].slice.call(arguments,1),e.p):t.reduce((s,a)=>Object.assign(s,a&&a.call?a(e.p):a),{}):t,ji(e.target),e.g,e.o,e.k)}let Nn,Is,Ms;rs.bind({g:1});let Se=rs.bind({k:1});function Ei(r,e,t,s){Ae.p=e,Nn=r,Is=t,Ms=s}function $e(r,e){let t=this||{};return function(){let s=arguments;function a(i,o){let l=Object.assign({},i),c=l.className||a.className;t.p=Object.assign({theme:Is&&Is()},l),t.o=/ *go\d+/.test(c),l.className=rs.apply(t,s)+(c?" "+c:"");let d=r;return r[0]&&(d=l.as||r,delete l.as),Ms&&d[0]&&Ms(l),Nn(d,l)}return a}}var Ci=r=>typeof r=="function",Jt=(r,e)=>Ci(r)?r(e):r,Ti=(()=>{let r=0;return()=>(++r).toString()})(),Sn=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),Pi=20,En=(r,e)=>{switch(e.type){case 0:return{...r,toasts:[e.toast,...r.toasts].slice(0,Pi)};case 1:return{...r,toasts:r.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:t}=e;return En(r,{type:r.toasts.find(i=>i.id===t.id)?1:0,toast:t});case 3:let{toastId:s}=e;return{...r,toasts:r.toasts.map(i=>i.id===s||s===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...r,pausedAt:e.time};case 6:let a=e.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Ut=[],ze={toasts:[],pausedAt:void 0},Je=r=>{ze=En(ze,r),Ut.forEach(e=>{e(ze)})},Ai={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Oi=(r={})=>{let[e,t]=j.useState(ze),s=j.useRef(ze);j.useEffect(()=>(s.current!==ze&&t(ze),Ut.push(t),()=>{let i=Ut.indexOf(t);i>-1&&Ut.splice(i,1)}),[]);let a=e.toasts.map(i=>{var o,l,c;return{...r,...r[i.type],...i,removeDelay:i.removeDelay||((o=r[i.type])==null?void 0:o.removeDelay)||(r==null?void 0:r.removeDelay),duration:i.duration||((l=r[i.type])==null?void 0:l.duration)||(r==null?void 0:r.duration)||Ai[i.type],style:{...r.style,...(c=r[i.type])==null?void 0:c.style,...i.style}}});return{...e,toasts:a}},Ri=(r,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:(t==null?void 0:t.id)||Ti()}),jt=r=>(e,t)=>{let s=Ri(e,r,t);return Je({type:2,toast:s}),s.id},X=(r,e)=>jt("blank")(r,e);X.error=jt("error");X.success=jt("success");X.loading=jt("loading");X.custom=jt("custom");X.dismiss=r=>{Je({type:3,toastId:r})};X.remove=r=>Je({type:4,toastId:r});X.promise=(r,e,t)=>{let s=X.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof r=="function"&&(r=r()),r.then(a=>{let i=e.success?Jt(e.success,a):void 0;return i?X.success(i,{id:s,...t,...t==null?void 0:t.success}):X.dismiss(s),a}).catch(a=>{let i=e.error?Jt(e.error,a):void 0;i?X.error(i,{id:s,...t,...t==null?void 0:t.error}):X.dismiss(s)}),r};var Di=(r,e)=>{Je({type:1,toast:{id:r,height:e}})},$i=()=>{Je({type:5,time:Date.now()})},pt=new Map,Fi=1e3,Ui=(r,e=Fi)=>{if(pt.has(r))return;let t=setTimeout(()=>{pt.delete(r),Je({type:4,toastId:r})},e);pt.set(r,t)},Li=r=>{let{toasts:e,pausedAt:t}=Oi(r);j.useEffect(()=>{if(t)return;let i=Date.now(),o=e.map(l=>{if(l.duration===1/0)return;let c=(l.duration||0)+l.pauseDuration-(i-l.createdAt);if(c<0){l.visible&&X.dismiss(l.id);return}return setTimeout(()=>X.dismiss(l.id),c)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[e,t]);let s=j.useCallback(()=>{t&&Je({type:6,time:Date.now()})},[t]),a=j.useCallback((i,o)=>{let{reverseOrder:l=!1,gutter:c=8,defaultPosition:d}=o||{},u=e.filter(f=>(f.position||d)===(i.position||d)&&f.height),h=u.findIndex(f=>f.id===i.id),m=u.filter((f,p)=>p<h&&f.visible).length;return u.filter(f=>f.visible).slice(...l?[m+1]:[0,m]).reduce((f,p)=>f+(p.height||0)+c,0)},[e]);return j.useEffect(()=>{e.forEach(i=>{if(i.dismissed)Ui(i.id,i.removeDelay);else{let o=pt.get(i.id);o&&(clearTimeout(o),pt.delete(i.id))}})},[e]),{toasts:e,handlers:{updateHeight:Di,startPause:$i,endPause:s,calculateOffset:a}}},Ii=Se`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Mi=Se`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,qi=Se`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Bi=$e("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ii} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Mi} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${qi} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,zi=Se`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Hi=$e("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${zi} 1s linear infinite;
`,Wi=Se`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ki=Se`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Vi=$e("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Wi} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ki} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Ji=$e("div")`
  position: absolute;
`,Gi=$e("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Qi=Se`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Yi=$e("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Qi} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Xi=({toast:r})=>{let{icon:e,type:t,iconTheme:s}=r;return e!==void 0?typeof e=="string"?j.createElement(Yi,null,e):e:t==="blank"?null:j.createElement(Gi,null,j.createElement(Hi,{...s}),t!=="loading"&&j.createElement(Ji,null,t==="error"?j.createElement(Bi,{...s}):j.createElement(Vi,{...s})))},Zi=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,eo=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,to="0%{opacity:0;} 100%{opacity:1;}",so="0%{opacity:1;} 100%{opacity:0;}",ro=$e("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,no=$e("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ao=(r,e)=>{let t=r.includes("top")?1:-1,[s,a]=Sn()?[to,so]:[Zi(t),eo(t)];return{animation:e?`${Se(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Se(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},io=j.memo(({toast:r,position:e,style:t,children:s})=>{let a=r.height?ao(r.position||e||"top-center",r.visible):{opacity:0},i=j.createElement(Xi,{toast:r}),o=j.createElement(no,{...r.ariaProps},Jt(r.message,r));return j.createElement(ro,{className:r.className,style:{...a,...t,...r.style}},typeof s=="function"?s({icon:i,message:o}):j.createElement(j.Fragment,null,i,o))});Ei(j.createElement);var oo=({id:r,className:e,style:t,onHeightUpdate:s,children:a})=>{let i=j.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;s(r,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[r,s]);return j.createElement("div",{ref:i,className:e,style:t},a)},lo=(r,e)=>{let t=r.includes("top"),s=t?{top:0}:{bottom:0},a=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Sn()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...s,...a}},co=rs`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Pt=16,uo=({reverseOrder:r,position:e="top-center",toastOptions:t,gutter:s,children:a,containerStyle:i,containerClassName:o})=>{let{toasts:l,handlers:c}=Li(t);return j.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Pt,left:Pt,right:Pt,bottom:Pt,pointerEvents:"none",...i},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(d=>{let u=d.position||e,h=c.calculateOffset(d,{reverseOrder:r,gutter:s,defaultPosition:e}),m=lo(u,h);return j.createElement(oo,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?co:"",style:m},d.type==="custom"?Jt(d.message,d):a?a(d):j.createElement(io,{toast:d,position:u}))}))},O=X;const ho="modulepreload",fo=function(r){return"/"+r},Pr={},kt=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(t.map(c=>{if(c=fo(c),c in Pr)return;Pr[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":ho,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,f)=>{h.addEventListener("load",m),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},mo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>kt(async()=>{const{default:s}=await Promise.resolve().then(()=>ot);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class lr extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class po extends lr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ar extends lr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Or extends lr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var qs;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(qs||(qs={}));var xo=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class go{constructor(e,{headers:t={},customFetch:s,region:a=qs.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=mo(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return xo(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=t;let l={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:u}).catch(w=>{throw new po(w)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new Ar(h);if(!h.ok)throw new Or(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Or||a instanceof Ar?a.context:void 0}}})}}var re={},cr={},ns={},_t={},as={},is={},yo=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},it=yo();const bo=it.fetch,Cn=it.fetch.bind(it),Tn=it.Headers,vo=it.Request,wo=it.Response,ot=Object.freeze(Object.defineProperty({__proto__:null,Headers:Tn,Request:vo,Response:wo,default:Cn,fetch:bo},Symbol.toStringTag,{value:"Module"})),jo=Ka(ot);var os={};Object.defineProperty(os,"__esModule",{value:!0});let ko=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};os.default=ko;var Pn=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(is,"__esModule",{value:!0});const _o=Pn(jo),No=Pn(os);let So=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=_o.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let d=null,u=null,h=null,m=i.status,f=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=y:u=JSON.parse(y))}const w=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&g&&g.length>1&&(h=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const w=await i.text();try{d=JSON.parse(w),Array.isArray(d)&&i.status===404&&(u=[],d=null,m=200,f="OK")}catch{i.status===404&&w===""?(m=204,f="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,m=200,f="OK"),d&&this.shouldThrowOnError)throw new No.default(d)}return{error:d,data:u,count:h,status:m,statusText:f}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}};is.default=So;var Eo=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(as,"__esModule",{value:!0});const Co=Eo(is);let To=class extends Co.default{select(e){let t=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:a=s}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};as.default=To;var Po=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(_t,"__esModule",{value:!0});const Ao=Po(as);let Oo=class extends Ao.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};_t.default=Oo;var Ro=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ns,"__esModule",{value:!0});const ht=Ro(_t);let Do=class{constructor(e,{headers:t={},schema:s,fetch:a}){this.url=e,this.headers=t,this.schema=s,this.fetch=a}select(e,{head:t=!1,count:s}={}){const a=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new ht.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ht.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:a,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new ht.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),this.headers.Prefer=a.join(","),new ht.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new ht.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ns.default=Do;var ls={},cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.version=void 0;cs.version="0.0.0-automated";Object.defineProperty(ls,"__esModule",{value:!0});ls.DEFAULT_HEADERS=void 0;const $o=cs;ls.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${$o.version}`};var An=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(cr,"__esModule",{value:!0});const Fo=An(ns),Uo=An(_t),Lo=ls;let Io=class On{constructor(e,{headers:t={},schema:s,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},Lo.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=a}from(e){const t=new URL(`${this.url}/${e}`);return new Fo.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new On(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:a=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||a?(o=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=t);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new Uo.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};cr.default=Io;var lt=ue&&ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(re,"__esModule",{value:!0});re.PostgrestError=re.PostgrestBuilder=re.PostgrestTransformBuilder=re.PostgrestFilterBuilder=re.PostgrestQueryBuilder=re.PostgrestClient=void 0;const Rn=lt(cr);re.PostgrestClient=Rn.default;const Dn=lt(ns);re.PostgrestQueryBuilder=Dn.default;const $n=lt(_t);re.PostgrestFilterBuilder=$n.default;const Fn=lt(as);re.PostgrestTransformBuilder=Fn.default;const Un=lt(is);re.PostgrestBuilder=Un.default;const Ln=lt(os);re.PostgrestError=Ln.default;var Mo=re.default={PostgrestClient:Rn.default,PostgrestQueryBuilder:Dn.default,PostgrestFilterBuilder:$n.default,PostgrestTransformBuilder:Fn.default,PostgrestBuilder:Un.default,PostgrestError:Ln.default};const{PostgrestClient:qo,PostgrestQueryBuilder:Uu,PostgrestFilterBuilder:Lu,PostgrestTransformBuilder:Iu,PostgrestBuilder:Mu,PostgrestError:qu}=Mo;class Bo{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const zo="2.15.1",Ho=`realtime-js/${zo}`,Wo="1.0.0",Bs=1e4,Ko=1e3,Vo=100;var xt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(xt||(xt={}));var W;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(W||(W={}));var fe;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(fe||(fe={}));var zs;(function(r){r.websocket="websocket"})(zs||(zs={}));var qe;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(qe||(qe={}));class Jo{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const a=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+a));o=o+a;const c=s.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class In{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var B;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(B||(B={}));const Rr=(r,e,t={})=>{var s;const a=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Go(o,r,e,a),i),{})},Go=(r,e,t,s)=>{const a=e.find(l=>l.name===r),i=a==null?void 0:a.type,o=t[r];return i&&!s.includes(i)?Mn(i,o):Hs(o)},Mn=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Zo(e,t)}switch(r){case B.bool:return Qo(e);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return Yo(e);case B.json:case B.jsonb:return Xo(e);case B.timestamp:return el(e);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return Hs(e);default:return Hs(e)}},Hs=r=>r,Qo=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Yo=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Xo=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Zo=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Mn(e,l))}return r},el=r=>typeof r=="string"?r.replace(" ","T"):r,qn=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class js{constructor(e,t,s={},a=Bs){this.channel=e,this.event=t,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Dr;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Dr||(Dr={}));class gt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gt.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=gt.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=gt.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,a){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=i[d];if(h){const m=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),p=u.filter(g=>f.indexOf(g.presence_ref)<0),w=h.filter(g=>m.indexOf(g.presence_ref)<0);p.length>0&&(l[d]=p),w.length>0&&(c[d]=w)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},s,a)}static syncDiff(e,t,s,a){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(f=>f.presence_ref),m=u.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...m)}s(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,a(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const a=e[s];return"metas"in a?t[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $r;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})($r||($r={}));var yt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(yt||(yt={}));var we;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(we||(we={}));class dr{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=W.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new js(this,fe.join,this.params,this.timeout),this.rejoinTimer=new In(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=W.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=W.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fe.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new gt(this),this.broadcastEndpointURL=qn(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==W.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[yt.PRESENCE]&&this.bindings[yt.PRESENCE].length>0,u={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(we.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(we.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){e==null||e(we.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,w=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,g=[];for(let y=0;y<w;y++){const N=p[y],{filter:{event:x,schema:C,table:P,filter:S}}=N,_=m&&m[y];if(_&&_.event===x&&_.schema===C&&_.table===P&&_.filter===S)g.push(Object.assign(Object.assign({},N),{id:_.id}));else{this.unsubscribe(),this.state=W.errored,e==null||e(we.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(we.SUBSCRIBED);return}}).receive("error",m=>{this.state=W.errored,e==null||e(we.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(we.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===W.joined&&e===yt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=W.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fe.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new js(this,fe.leave,{},e),s.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=W.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(i),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new js(this,e,t,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Vo){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=fe;if(s&&[l,c,d,u].indexOf(o)>=0&&s!==this._joinRef())return;let m=this._onMessage(o,t,s);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(f=>{var p,w,g;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((g=(w=f.filter)===null||w===void 0?void 0:w.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(m,s)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var p,w,g,y,N,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const C=f.id,P=(p=f.filter)===null||p===void 0?void 0:p.event;return C&&((w=t.ids)===null||w===void 0?void 0:w.includes(C))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const C=(N=(y=f==null?void 0:f.filter)===null||y===void 0?void 0:y.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return C==="*"||C===((x=t==null?void 0:t.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof m=="object"&&"ids"in m){const p=m.data,{schema:w,table:g,commit_timestamp:y,type:N,errors:x}=p;m=Object.assign(Object.assign({},{schema:w,table:g,commit_timestamp:y,eventType:N,new:{},old:{},errors:x}),this._getPayloadRecords(p))}f.callback(m,s)})}_isClosed(){return this.state===W.closed}_isJoined(){return this.state===W.joined}_isJoining(){return this.state===W.joining}_isLeaving(){return this.state===W.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const a=e.toLocaleLowerCase(),i={type:a,filter:t,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&dr.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fe.close,{},e)}_onError(e){this._on(fe.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=W.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Rr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Rr(e.columns,e.old_record)),t}}const Fr=()=>{},At={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tl=[1e3,2e3,5e3,1e4],sl=1e4,rl=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class nl{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bs,this.transport=null,this.heartbeatIntervalMs=At.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Fr,this.ref=0,this.reconnectTimer=null,this.logger=Fr,this.conn=null,this.sendBuffer=[],this.serializer=new Jo,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>kt(async()=>{const{default:l}=await Promise.resolve().then(()=>ot);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${zs.websocket}`,this.httpEndpoint=qn(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bo.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Wo}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case xt.connecting:return qe.Connecting;case xt.open:return qe.Open;case xt.closing:return qe.Closing;default:return qe.Closed}}isConnected(){return this.connectionState()===qe.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new dr(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ko,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},At.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:a,payload:i,ref:o}=t,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(a,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(fe.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${s}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([rl],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const a={access_token:t,version:Ho};t&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(fe.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new In(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},At.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,a,i,o,l,c,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Bs,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:At.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:u=>tl[u-1]||sl,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(u,h)=>h(JSON.stringify(u)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class ur extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function K(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class al extends ur{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ws extends ur{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var il=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Bn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>kt(async()=>{const{default:s}=await Promise.resolve().then(()=>ot);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},ol=()=>il(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield kt(()=>Promise.resolve().then(()=>ot),void 0)).Response:Response}),Ks=r=>{if(Array.isArray(r))return r.map(t=>Ks(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const a=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Ks(s)}),e},ll=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var Ge=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const ks=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),cl=(r,e,t)=>Ge(void 0,void 0,void 0,function*(){const s=yield ol();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(a=>{const i=r.status||500,o=(a==null?void 0:a.statusCode)||i+"";e(new al(ks(a),i,o))}).catch(a=>{e(new Ws(ks(a),a))}):e(new Ws(ks(r),r))}),dl=(r,e,t,s)=>{const a={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!s?a:(ll(s)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(s)):a.body=s,Object.assign(Object.assign({},a),t))};function Nt(r,e,t,s,a,i){return Ge(this,void 0,void 0,function*(){return new Promise((o,l)=>{r(t,dl(e,s,a,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>cl(c,l,s))})})}function Gt(r,e,t,s){return Ge(this,void 0,void 0,function*(){return Nt(r,"GET",e,t,s)})}function je(r,e,t,s,a){return Ge(this,void 0,void 0,function*(){return Nt(r,"POST",e,s,a,t)})}function Vs(r,e,t,s,a){return Ge(this,void 0,void 0,function*(){return Nt(r,"PUT",e,s,a,t)})}function ul(r,e,t,s){return Ge(this,void 0,void 0,function*(){return Nt(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function zn(r,e,t,s,a){return Ge(this,void 0,void 0,function*(){return Nt(r,"DELETE",e,s,a,t)})}var se=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const hl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ur={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fl{constructor(e,t={},s,a){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Bn(a)}uploadOrUpdate(e,t,s,a){return se(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ur),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?Vs:je)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}})}upload(e,t,s){return se(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,a){return se(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Ur.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield Vs(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(K(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return se(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=yield je(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new ur("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}update(e,t,s){return se(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return se(this,void 0,void 0,function*(){try{return{data:yield je(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(K(a))return{data:null,error:a};throw a}})}copy(e,t,s){return se(this,void 0,void 0,function*(){try{return{data:{path:(yield je(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(K(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,s){return se(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield je(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(K(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,s){return se(this,void 0,void 0,function*(){try{const a=yield je(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(K(a))return{data:null,error:a};throw a}})}download(e,t){return se(this,void 0,void 0,function*(){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Gt(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(K(l))return{data:null,error:l};throw l}})}info(e){return se(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Gt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ks(s),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}exists(e){return se(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield ul(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(K(s)&&s instanceof Ws){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),a=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&a.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return se(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}list(e,t,s){return se(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},hl),t),{prefix:e||""});return{data:yield je(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(K(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ml="2.10.4",pl={"X-Client-Info":`storage-js/${ml}`};var Ye=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class xl{constructor(e,t={},s,a){const i=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},pl),t),this.fetch=Bn(s)}listBuckets(){return Ye(this,void 0,void 0,function*(){try{return{data:yield Gt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(K(e))return{data:null,error:e};throw e}})}getBucket(e){return Ye(this,void 0,void 0,function*(){try{return{data:yield Gt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ye(this,void 0,void 0,function*(){try{return{data:yield je(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ye(this,void 0,void 0,function*(){try{return{data:yield Vs(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ye(this,void 0,void 0,function*(){try{return{data:yield je(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ye(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}}class gl extends xl{constructor(e,t={},s,a){super(e,t,s,a)}from(e){return new fl(this.url,this.headers,e,this.fetch)}}const yl="2.55.0";let mt="";typeof Deno<"u"?mt="deno":typeof document<"u"?mt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mt="react-native":mt="node";const bl={"X-Client-Info":`supabase-js-${mt}/${yl}`},vl={headers:bl},wl={schema:"public"},jl={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},kl={};var _l=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Nl=r=>{let e;return r?e=r:typeof fetch>"u"?e=Cn:e=fetch,(...t)=>e(...t)},Sl=()=>typeof Headers>"u"?Tn:Headers,El=(r,e,t)=>{const s=Nl(t),a=Sl();return(i,o)=>_l(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:r;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:d}))})};var Cl=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};function Tl(r){return r.endsWith("/")?r:r+"/"}function Pl(r,e){var t,s;const{db:a,auth:i,realtime:o,global:l}=r,{db:c,auth:d,realtime:u,global:h}=e,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>Cl(this,void 0,void 0,function*(){return""})};return r.accessToken?m.accessToken=r.accessToken:delete m.accessToken,m}const Hn="2.71.1",st=30*1e3,Js=3,_s=Js*st,Al="http://localhost:9999",Ol="supabase.auth.token",Rl={"X-Client-Info":`gotrue-js/${Hn}`},Gs="X-Supabase-Api-Version",Wn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Dl=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,$l=10*60*1e3;class hr extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function F(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Fl extends hr{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Ul(r){return F(r)&&r.name==="AuthApiError"}class Kn extends hr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Fe extends hr{constructor(e,t,s,a){super(e,s,a),this.name=t,this.status=s}}class Te extends Fe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ll(r){return F(r)&&r.name==="AuthSessionMissingError"}class Ot extends Fe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Rt extends Fe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Dt extends Fe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Il(r){return F(r)&&r.name==="AuthImplicitGrantRedirectError"}class Lr extends Fe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qs extends Fe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ns(r){return F(r)&&r.name==="AuthRetryableFetchError"}class Ir extends Fe{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Ys extends Fe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Qt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mr=` 	
\r=`.split(""),Ml=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Mr.length;e+=1)r[Mr[e].charCodeAt(0)]=-2;for(let e=0;e<Qt.length;e+=1)r[Qt[e].charCodeAt(0)]=e;return r})();function qr(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Qt[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Qt[s]),e.queuedBits-=6}}function Vn(r,e,t){const s=Ml[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Br(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{zl(o,s,t)};for(let o=0;o<r.length;o+=1)Vn(r.charCodeAt(o),a,i);return e.join("")}function ql(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Bl(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}ql(s,e)}}function zl(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if(!(r>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Hl(r){const e=[],t={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<r.length;a+=1)Vn(r.charCodeAt(a),t,s);return new Uint8Array(e)}function Wl(r){const e=[];return Bl(r,t=>e.push(t)),new Uint8Array(e)}function Kl(r){const e=[],t={queue:0,queuedBits:0},s=a=>{e.push(a)};return r.forEach(a=>qr(a,t,s)),qr(null,t,s),e.join("")}function Vl(r){return Math.round(Date.now()/1e3)+r}function Jl(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const he=()=>typeof window<"u"&&typeof document<"u",Le={tested:!1,writable:!1},Jn=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Le.tested)return Le.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Le.tested=!0,Le.writable=!0}catch{Le.tested=!0,Le.writable=!1}return Le.writable};function Gl(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return t.searchParams.forEach((s,a)=>{e[a]=s}),e}const Gn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>kt(async()=>{const{default:s}=await Promise.resolve().then(()=>ot);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Ql=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",rt=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ie=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ce=async(r,e)=>{await r.removeItem(e)};class ds{constructor(){this.promise=new ds.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ds.promiseConstructor=Promise;function Ss(r){const e=r.split(".");if(e.length!==3)throw new Ys("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Dl.test(e[s]))throw new Ys("JWT not in base64url format");return{header:JSON.parse(Br(e[0])),payload:JSON.parse(Br(e[1])),signature:Hl(e[2]),raw:{header:e[0],payload:e[1]}}}async function Yl(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Xl(r,e){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function Zl(r){return("0"+r.toString(16)).substr(-2)}function ec(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let a="";for(let i=0;i<56;i++)a+=t.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,Zl).join("")}async function tc(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function sc(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await tc(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Xe(r,e,t=!1){const s=ec();let a=s;t&&(a+="/PASSWORD_RECOVERY"),await rt(r,`${e}-code-verifier`,a);const i=await sc(s);return[i,s===i?"plain":"s256"]}const rc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nc(r){const e=r.headers.get(Gs);if(!e||!e.match(rc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function ac(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function ic(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const oc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ze(r){if(!oc.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Es(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zr(r){return JSON.parse(JSON.stringify(r))}var lc=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(r);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(r,s[a])&&(t[s[a]]=r[s[a]]);return t};const Me=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),cc=[502,503,504];async function Hr(r){var e;if(!Ql(r))throw new Qs(Me(r),0);if(cc.includes(r.status))throw new Qs(Me(r),r.status);let t;try{t=await r.json()}catch(i){throw new Kn(Me(i),i)}let s;const a=nc(r);if(a&&a.getTime()>=Wn["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Ir(Me(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Te}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ir(Me(t),r.status,t.weak_password.reasons);throw new Fl(Me(t),r.status||500,s)}const dc=(r,e,t,s)=>{const a={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),t))};async function M(r,e,t,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[Gs]||(i[Gs]=Wn["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await uc(r,e,t+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function uc(r,e,t,s,a,i){const o=dc(e,s,a,i);let l;try{l=await r(t,Object.assign({},o))}catch(c){throw console.error(c),new Qs(Me(c),0)}if(l.ok||await Hr(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Hr(c)}}function ve(r){var e;let t=null;pc(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Vl(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Wr(r){const e=ve(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Oe(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function hc(r){return{data:r,error:null}}function fc(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:a,verification_type:i}=r,o=lc(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function mc(r){return r}function pc(r){return r.access_token&&r.refresh_token&&r.expires_in}const Cs=["global","local","others"];var xc=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(r);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(r,s[a])&&(t[s[a]]=r[s[a]]);return t};class gc{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Gn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Cs[0]){if(Cs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Cs.join(", ")}`);try{return await M(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(F(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await M(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Oe})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=xc(e,["options"]),a=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await M(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:fc,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(F(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await M(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Oe})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await M(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:mc});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(p=>{const w=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(p.split(";")[1].split("=")[1]);d[`${g}Page`]=w}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(F(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ze(e);try{return await M(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Oe})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ze(e);try{return await M(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Oe})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Ze(e);try{return await M(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Oe})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ze(e.userId);try{const{data:t,error:s}=await M(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:s}}catch(t){if(F(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ze(e.userId),Ze(e.id);try{return{data:await M(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}}function Kr(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function yc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const et={debug:!!(globalThis&&Jn()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Qn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class bc extends Qn{}async function vc(r,e,t){et.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),et.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){et.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,a.name);try{return await t()}finally{et.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,a.name)}}else{if(e===0)throw et.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new bc(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(et.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}yc();const wc={url:Al,storageKey:Ol,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Rl,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Vr(r,e,t){return await t()}const tt={};class bt{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=bt.nextInstanceID,bt.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},wc),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new gc({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Gn(a.fetch),this.lock=a.lock||Vr,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:he()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=vc:this.lock=Vr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Jn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Kr(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Kr(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=tt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){tt[this.storageKey]=Object.assign(Object.assign({},tt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=tt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){tt[this.storageKey]=Object.assign(Object.assign({},tt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Hn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Gl(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),he()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Il(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return F(t)?{error:t}:{error:new Kn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,a;try{const i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ve}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(F(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,a;try{let i;if("email"in e){const{email:u,password:h,options:m}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Xe(this.storage,this.storageKey)),i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:f,code_challenge_method:p},xform:ve})}else if("phone"in e){const{phone:u,password:h,options:m}=e;i=await M(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},channel:(a=m==null?void 0:m.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:ve})}else throw new Rt("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(F(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Wr})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await M(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Wr})}else throw new Rt("You must provide either an email or phone number and a password");const{data:s,error:a}=t;return a?{data:{user:null,session:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Ot}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,a,i,o,l,c,d,u,h,m,f;let p,w;if("message"in e)p=e.message,w=e.signature;else{const{chain:g,wallet:y,statement:N,options:x}=e;let C;if(he())if(typeof y=="object")C=y;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))C=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=y}const P=new URL((t=x==null?void 0:x.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const S=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),N?{statement:N}:null));let _;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")_=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)_=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)p=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),w=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${P.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(a=(s=x==null?void 0:x.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((d=x==null?void 0:x.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(u=x==null?void 0:x.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const S=await C.signMessage(new TextEncoder().encode(p),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=S}}try{const{data:g,error:y}=await M(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Kl(w)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:ve});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Ot}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(F(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const t=await Ie(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(t??"").split("/");try{const{data:i,error:o}=await M(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ve});if(await Ce(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ot}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(F(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:a,access_token:i,nonce:o}=e,l=await M(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ve}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ot}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Xe(this.storage,this.storageKey));const{error:h}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await M(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Rt("You must provide either an email or phone number.")}catch(l){if(F(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,s;try{let a,i;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await M(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ve});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(F(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var t,s,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Xe(this.storage,this.storageKey)),await M(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:hc})}catch(i){if(F(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Te;const{error:a}=await M(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:i}=e,{error:o}=await M(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:a,options:i}=e,{data:o,error:l}=await M(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Rt("You must provide either an email or phone number and a type")}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ie(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<_s:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Ie(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Es()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Oe}):await this._useSession(async t=>{var s,a,i;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Te}:await M(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Oe})})}catch(t){if(F(t))return Ll(t)&&(await this._removeSession(),await Ce(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new Te;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Xe(this.storage,this.storageKey));const{data:d,error:u}=await M(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Oe});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Te;const t=Date.now()/1e3;let s=t,a=!0,i=null;const{payload:o}=Ss(e.access_token);if(o.exp&&(s=o.exp,a=s<=t),a){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(F(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Te;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(F(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!he())throw new Dt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Dt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Lr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Dt("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Lr("No code detected.");const{data:N,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new Dt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const f=m-u;f*1e3<=st&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=m-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,m,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,m,u);const{data:w,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(s){if(F(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ie(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:a,error:i}=t;if(i)return{error:i};const o=(s=a.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Ul(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ce(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Jl(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,a;try{const{data:{session:i},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await Xe(this.storage,this.storageKey,!0));try{return await M(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(F(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:h,error:m}=i;if(m)throw m;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await M(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return he()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(F(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,a;const{data:i,error:o}=t;if(o)throw o;return await M(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(F(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Xl(async a=>(a>0&&await Yl(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await M(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ve})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Ns(i)&&Date.now()+o-s<st})}catch(s){if(this._debug(t,"error",s),F(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),he()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await Ie(this.storage,this.storageKey);if(a&&this.userStorage){let o=await Ie(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await rt(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Es()}else if(a&&!a.user&&!a.user){const o=await Ie(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Ce(this.storage,this.storageKey+"-user"),await rt(this.storage,this.storageKey,a)):a.user=Es()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const i=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<_s;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${_s}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),Ns(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Te;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ds;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Te;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),F(i)){const o={session:null,error:i};return Ns(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await rt(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const i=zr(a);await rt(this.storage,this.storageKey,i)}else{const a=zr(t);await rt(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ce(this.storage,this.storageKey),await Ce(this.storage,this.storageKey+"-code-verifier"),await Ce(this.storage,this.storageKey+"-user"),this.userStorage&&await Ce(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),st);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/st);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${st}ms, refresh threshold is ${Js} ticks`),a<=Js&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Qn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const a=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Xe(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:a,error:i}=t;return i?{data:null,error:i}:await M(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(F(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,a;const{data:i,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await M(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(F(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:a,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(F(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:a,error:i}=t;return i?{data:null,error:i}:await M(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(F(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],a=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ss(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(t=a.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+$l>a)return s;const{data:i,error:o}=await M(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};s=f.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=Ss(s);t!=null&&t.allowExpired||ac(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:i,header:a,signature:o},error:null}}const u=ic(a.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Wl(`${l}.${c}`)))throw new Ys("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(s){if(F(s))return{data:null,error:s};throw s}}}bt.nextInstanceID=0;const jc=bt;class kc extends jc{constructor(e){super(e)}}var _c=function(r,e,t,s){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class Nc{constructor(e,t,s){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=Tl(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:wl,realtime:kl,auth:Object.assign(Object.assign({},jl),{storageKey:d}),global:vl},h=Pl(s??{},u);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=El(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new qo(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new gl(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new go(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return _c(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:a,storageKey:i,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kc({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:a,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new nl(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Sc=(r,e,t)=>new Nc(r,e,t);function Ec(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Ec()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Yn="https://xxziychdaarykpquzqhi.supabase.co",Lt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh4eml5Y2hkYWFyeWtwcXV6cWhpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5MTc1NzIsImV4cCI6MjA3MDQ5MzU3Mn0.D2MckEdepyEiIVfMO3vgjT7j16b-vrVlCYrW-nm_5qc";console.log("🔧 Supabase Config:",{url:`${Yn.substring(0,20)}...`,hasKey:!0,keyLength:(Lt==null?void 0:Lt.length)||0});const T=Sc(Yn,Lt,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});console.log("✅ Supabase client created successfully");const Ts={async getCurrentUser(){const{data:{user:r},error:e}=await T.auth.getUser();if(e)throw e;return r},async signIn(r,e){const{data:t,error:s}=await T.auth.signInWithPassword({email:r,password:e});if(s)throw s;return t},async signUp(r,e,t={}){const{data:s,error:a}=await T.auth.signUp({email:r,password:e,options:{data:t}});if(a)throw a;return s},async signOut(){const{error:r}=await T.auth.signOut();if(r)throw r},async getModels(r={}){let e=T.from("models").select(`
        *,
        creator:profiles!models_user_id_fkey(
          id,
          username,
          avatar_url,
          bio
        )
      `);r.category&&(e=e.eq("category",r.category)),r.featured&&(e=e.eq("is_featured",!0)),r.trending&&(e=e.order("view_count",{ascending:!1})),r.limit&&(e=e.limit(r.limit));const{data:t,error:s}=await e;if(s)throw s;return t},async getStats(){const{data:r,error:e}=await T.from("models").select("*",{count:"exact",head:!0});if(e)throw e;const{data:t}=await T.from("models").select("category"),s=(t==null?void 0:t.reduce((a,i)=>(a[i.category]=(a[i.category]||0)+1,a),{}))||{};return{overview:{totalModels:(r==null?void 0:r.length)||0,totalUsers:0,totalDownloads:0,totalViews:0,totalLikes:0,totalComments:0},topCategories:Object.entries(s).map(([a,i])=>({category:a,count:i})).sort((a,i)=>i.count-a.count).slice(0,5)}}},Xn=j.createContext(),ee=()=>{const r=j.useContext(Xn);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r},Cc=({children:r})=>{const[e,t]=j.useState(null),[s,a]=j.useState(null),[i,o]=j.useState(!0),[l,c]=j.useState(!1);j.useEffect(()=>{let _=setTimeout(()=>{console.log("⏰ AuthContext: Loading timeout reached, forcing loading to false"),o(!1)},5e3);const R=async()=>{try{console.log("🔍 AuthContext: Getting initial session...");const{data:{session:b},error:k}=await T.auth.getSession();if(k){console.error("❌ AuthContext: Error getting session:",k),o(!1),clearTimeout(_);return}if(b!=null&&b.user){console.log("✅ AuthContext: Session found, user:",b.user.id),t(b.user);try{await u(b.user.id)}catch(D){console.error("❌ AuthContext: Error fetching profile:",D)}}else console.log("ℹ️ AuthContext: No session found")}catch(b){console.error("❌ AuthContext: Error getting initial session:",b)}finally{console.log("🏁 AuthContext: Initial session check complete, setting loading to false"),o(!1),clearTimeout(_)}},{data:{subscription:A}}=T.auth.onAuthStateChange(async(b,k)=>{var D;console.log("🔄 AuthContext: Auth state change:",b,(D=k==null?void 0:k.user)==null?void 0:D.id);try{if(b==="SIGNED_IN"&&(k!=null&&k.user)){t(k.user);try{await u(k.user.id)}catch($){console.error("❌ AuthContext: Error fetching profile on sign in:",$)}}else b==="SIGNED_OUT"?(t(null),a(null)):b==="TOKEN_REFRESHED"&&(k!=null&&k.user)&&t(k.user)}catch($){console.error("❌ AuthContext: Error in auth state change handler:",$)}finally{o(!1),clearTimeout(_)}});return R(),()=>{A.unsubscribe(),clearTimeout(_)}},[]);const d=async()=>{try{console.log("🔍 AuthContext: Checking if profiles table exists...");const{data:_,error:R}=await T.from("profiles").select("*").limit(0);return R?(console.error("❌ AuthContext: Profiles table check failed:",R),!1):(console.log("✅ AuthContext: Profiles table exists and is accessible"),!0)}catch(_){return console.error("❌ AuthContext: Exception checking profiles table:",_),!1}},u=async _=>{if(l){console.log("⚠️ AuthContext: Profile fetch already in progress, skipping...");return}const R=setTimeout(()=>{console.log("⏰ AuthContext: Profile fetch timeout reached, forcing completion"),c(!1)},15e3);try{if(c(!0),console.log("🔍 AuthContext: Starting profile fetch for user:",_),!await d()){console.error("❌ AuthContext: Profiles table does not exist or is not accessible"),clearTimeout(R);return}console.log("🔍 AuthContext: Testing Supabase connection...");try{const{data:D,error:$}=await T.from("profiles").select("id").limit(1);if($){console.error("❌ AuthContext: Supabase connection test failed:",$),console.log("❌ AuthContext: Error details:",{code:$.code,message:$.message,details:$.details}),clearTimeout(R);return}console.log("✅ AuthContext: Supabase connection test successful, test data:",D)}catch(D){console.error("❌ AuthContext: Supabase connection test exception:",D),clearTimeout(R);return}console.log("🔍 AuthContext: Fetching profile from profiles table...");const{data:b,error:k}=await T.from("profiles").select("*").eq("id",_).single();if(console.log("🔍 AuthContext: Profile query result:",{data:b,error:k,errorCode:k==null?void 0:k.code,errorMessage:k==null?void 0:k.message,hasData:!!b,dataKeys:b?Object.keys(b):null}),k)if(console.log("❌ AuthContext: Database error details:",{code:k.code,message:k.message,details:k.details,hint:k.hint}),k.code==="PGRST116"){console.log("⚠️ AuthContext: No profile found for user, creating one...");const{data:D,error:$}=await T.from("profiles").insert([{id:_,username:`user_${_.slice(0,8)}`,bio:"",role:"creator"}]).select().single();if($){console.error("❌ AuthContext: Error creating profile:",$),clearTimeout(R);return}a(D),console.log("✅ AuthContext: Profile created successfully:",D)}else console.error("❌ AuthContext: Error fetching profile:",k);else a(b),console.log("✅ AuthContext: Profile loaded successfully:",b)}catch(A){console.error("❌ AuthContext: Unexpected error in fetchUserProfile:",A)}finally{clearTimeout(R),c(!1),console.log("🏁 AuthContext: Profile fetch process complete")}},h=async(_,R,A)=>{try{o(!0);const{data:b,error:k}=await T.from("profiles").select("username").eq("username",A).single();if(b)throw new Error("Username already taken");const{data:D,error:$}=await T.auth.signUp({email:_,password:R,options:{data:{username:A}}});if($)throw $;if(D.user){const{error:E}=await T.from("profiles").insert([{id:D.user.id,username:A,bio:"",role:"creator"}]);return E&&console.error("Profile creation error:",E),O.success("Account created successfully! Please check your email to verify your account."),{success:!0,message:"Account created successfully!"}}return{success:!0,message:"Please check your email to verify your account."}}catch(b){console.error("Signup error:",b);const k=b.message==="Username already taken"?"Username already taken":"Failed to create account";return O.error(k),{success:!1,message:k}}finally{o(!1)}},m=async(_,R)=>{const A=setTimeout(()=>{console.log("⏰ AuthContext: Login timeout reached, forcing loading to false"),o(!1)},1e4);try{console.log("🔐 AuthContext: Starting login process..."),o(!0);const{data:b,error:k}=await T.auth.signInWithPassword({email:_,password:R});if(k)throw console.error("❌ AuthContext: Login error:",k),k;if(b.user){console.log("✅ AuthContext: Login successful, user:",b.user.id),t(b.user);try{console.log("🔍 AuthContext: Fetching profile after login..."),await u(b.user.id)}catch(D){console.error("❌ AuthContext: Error fetching profile after login:",D)}return O.success("Welcome back!"),{success:!0}}else throw console.error("❌ AuthContext: No user data in login response"),new Error("No user data received")}catch(b){return console.error("❌ AuthContext: Login error:",b),O.error("Invalid email or password"),{success:!1,message:b.message}}finally{console.log("🏁 AuthContext: Login process complete, setting loading to false"),clearTimeout(A),o(!1)}},f=async()=>{try{console.log("🚪 AuthContext: Starting logout process...");const{error:_}=await T.auth.signOut();if(_)throw console.error("❌ AuthContext: Supabase logout error:",_),_;console.log("✅ AuthContext: Supabase logout successful, clearing local state..."),t(null),a(null),o(!1),console.log("✅ AuthContext: Logout completed successfully"),O.success("Signed out successfully")}catch(_){console.error("❌ AuthContext: Logout error:",_),O.error("Failed to sign out"),o(!1)}},p=async()=>{try{console.log("🚪 AuthContext: Force logout - bypassing loading states..."),t(null),a(null),o(!1);const{error:_}=await T.auth.signOut();_&&console.error("❌ AuthContext: Supabase logout error (but states cleared):",_),console.log("✅ AuthContext: Force logout completed"),O.success("Signed out successfully")}catch(_){console.error("❌ AuthContext: Force logout error:",_)}},w=()=>{console.log("🔄 AuthContext: Manually resetting loading state"),o(!1),c(!1)},g=()=>{console.log("🚨 AuthContext: Force resetting all states"),o(!1),c(!1),a(null)},y=()=>{a(null),c(!1),console.log("🔄 AuthContext: Profile state reset")},N=async()=>{if(!e){console.log("⚠️ AuthContext: No user to fetch profile for");return}console.log("🧪 AuthContext: Manual profile fetch triggered"),await u(e.id)},x=async()=>{const _=setTimeout(()=>{console.log("⏰ AuthContext: Basic connection test timeout reached")},1e4);try{console.log("🔍 AuthContext: Testing basic Supabase connectivity..."),console.log("🔍 Test 1: Testing auth connection...");const{data:R,error:A}=await T.auth.getSession();if(A)return console.error("❌ Test 1 Failed: Auth error:",A),clearTimeout(_),!1;console.log("✅ Test 1 Passed: Auth connection successful"),console.log("🔍 Test 2: Testing basic database access...");try{const{data:b,error:k}=await T.from("profiles").select("id").limit(1);return k?(console.error("❌ Test 2 Failed: Database query error:",k),console.log("❌ Error details:",{code:k.code,message:k.message,details:k.details,hint:k.hint}),k.code==="PGRST116"?console.log("⚠️ Table not found - this suggests the profiles table is missing"):k.code==="42501"&&console.log("⚠️ Permission denied - this suggests RLS policies are blocking access"),clearTimeout(_),!1):(console.log("✅ Test 2 Passed: Database query successful, data:",b),clearTimeout(_),!0)}catch(b){return console.error("❌ Test 2 Failed: Database exception:",b),clearTimeout(_),!1}}catch(R){return console.error("❌ Basic connection test failed:",R),clearTimeout(_),!1}},C=async()=>{try{if(console.log("🔍 AuthContext: Testing basic Supabase client connection..."),console.log("🔍 Test 1: Checking Supabase client..."),!T)return console.error("❌ Test 1 Failed: Supabase client is null/undefined"),!1;console.log("✅ Test 1 Passed: Supabase client exists"),console.log("🔍 Test 2: Checking environment variables...");const _="https://xxziychdaarykpquzqhi.supabase.co",R="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh4eml5Y2hkYWFyeWtwcXV6cWhpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5MTc1NzIsImV4cCI6MjA3MDQ5MzU3Mn0.D2MckEdepyEiIVfMO3vgjT7j16b-vrVlCYrW-nm_5qc";console.log("✅ Test 2 Passed: Environment variables are set"),console.log("🔍 URL length:",_.length),console.log("🔍 Key length:",R.length),console.log("🔍 Test 3: Testing basic auth connection...");const{data:A,error:b}=await T.auth.getSession();return b?(console.error("❌ Test 3 Failed: Auth connection error:",b),!1):(console.log("✅ Test 3 Passed: Auth connection successful"),console.log("✅ All Supabase connection tests passed!"),!0)}catch(_){return console.error("❌ Supabase connection test failed:",_),!1}},P=async()=>{try{if(console.log("🔍 AuthContext: Starting Supabase connection diagnosis..."),await C()){console.log("✅ Supabase connection: All tests passed"),console.log("🔍 Now testing database access...");const R=await x();console.log(R?"✅ Database access: All tests passed":"❌ Database access: Tests failed - connection works but database has issues")}else console.log("❌ Supabase connection: Tests failed - connection issue detected");console.log("🏁 Supabase diagnosis complete")}catch(_){console.error("❌ Supabase diagnosis failed:",_)}},S={user:e,profile:s,loading:i,isAuthenticated:!!e,isCreator:((s==null?void 0:s.role)||"").toLowerCase()==="creator",signup:h,login:m,logout:f,forceLogout:p,fetchUserProfile:u,manualFetchProfile:N,diagnoseDatabase:P,resetProfile:y,resetLoading:w,forceReset:g,debugAuth:async()=>{console.log("🔍 Debug: Current auth state:",{user:e,profile:s,loading:i});try{const{data:{session:_}}=await T.auth.getSession();console.log("🔍 Debug: Current session:",_);const{data:{user:R}}=await T.auth.getUser();if(console.log("🔍 Debug: Current user:",R),R){console.log("🔍 Debug: Testing database connection...");const{data:A,error:b}=await T.from("profiles").select("*").limit(1);console.log("🔍 Debug: Profiles table test:",{tableInfo:A,tableError:b});const{data:k,error:D}=await T.from("profiles").select("*").eq("id",R.id).single();console.log("🔍 Debug: Profile query result:",{profileData:k,profileError:D});const{count:$,error:E}=await T.from("profiles").select("*",{count:"exact",head:!0});console.log("🔍 Debug: Table count result:",{count:$,countError:E})}}catch(_){console.error("🔍 Debug: Error getting auth info:",_)}}};return n.jsx(Xn.Provider,{value:S,children:r})},Zn=j.createContext(),ea=()=>{const r=j.useContext(Zn);if(!r)throw new Error("useTheme must be used within a ThemeProvider");return r},Tc=({children:r})=>{const[e,t]=j.useState(()=>{const i=localStorage.getItem("theme");return i||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});j.useEffect(()=>{localStorage.setItem("theme",e),e==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[e]),j.useEffect(()=>{const i=window.matchMedia("(prefers-color-scheme: dark)"),o=l=>{localStorage.getItem("theme")||t(l.matches?"dark":"light")};return i.addEventListener("change",o),()=>i.removeEventListener("change",o)},[]);const a={theme:e,setTheme:t,toggleTheme:()=>{t(i=>i==="light"?"dark":"light")},isDark:e==="dark",isLight:e==="light"};return n.jsx(Zn.Provider,{value:a,children:r})},Pc=()=>{const{theme:r,toggleTheme:e}=ea();return n.jsx("button",{onClick:e,className:"p-2 rounded-md text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white hover:bg-secondary-100 dark:hover:bg-secondary-800 transition-colors duration-200 focus-ring","aria-label":`Switch to ${r==="light"?"dark":"light"} mode`,children:r==="light"?n.jsx(Ea,{className:"w-5 h-5"}):n.jsx(Ca,{className:"w-5 h-5"})})},Ac=()=>{var d;const{user:r,profile:e,logout:t}=ee(),[s,a]=j.useState(!1),i=j.useRef(null);console.log("🔍 UserMenu: Render state:",{user:!!r,profile:!!e,userData:r,profileData:e}),j.useEffect(()=>{const u=h=>{i.current&&!i.current.contains(h.target)&&a(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const o=async()=>{await t(),a(!1)};if(!r)return null;const l=(e==null?void 0:e.username)||((d=r.email)==null?void 0:d.split("@")[0])||"User",c=e==null?void 0:e.avatar_url;return n.jsxs("div",{className:"relative",ref:i,children:[n.jsxs("button",{onClick:()=>a(!s),className:"flex items-center space-x-2 text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white transition-colors",children:[n.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-secondary-200 dark:bg-secondary-700",children:c?n.jsx("img",{src:c,alt:l,className:"w-full h-full object-cover"}):n.jsx(Ne,{className:"w-full h-full p-1 text-secondary-400"})}),n.jsx("span",{className:"font-medium",children:l}),n.jsx(Ta,{className:`w-4 h-4 transition-transform ${s?"rotate-180":""}`})]}),s&&n.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-secondary-800 rounded-lg shadow-lg border border-secondary-200 dark:border-secondary-700 py-2 z-50",children:[n.jsxs("div",{className:"px-4 py-2 border-b border-secondary-200 dark:border-secondary-700",children:[n.jsx("p",{className:"text-sm font-medium text-secondary-900 dark:text-white",children:l}),n.jsx("p",{className:"text-xs text-secondary-500 dark:text-secondary-400",children:r.email})]}),e&&n.jsxs(n.Fragment,{children:[n.jsxs(L,{to:`/profile/${e.username}`,className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(Ne,{className:"w-4 h-4 mr-2"}),"View Profile"]}),n.jsxs(L,{to:"/profile/edit",className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(Bt,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})]}),n.jsxs(L,{to:"/upload",className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(Z,{className:"w-4 h-4 mr-2"}),"Upload Model"]}),n.jsxs(L,{to:"/models",className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(zt,{className:"w-4 h-4 mr-2"}),"Manage Models"]}),n.jsxs(L,{to:"/analytics",className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(ke,{className:"w-4 h-4 mr-2"}),"Analytics"]}),n.jsxs(L,{to:"/downloads",className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(de,{className:"w-4 h-4 mr-2"}),"Download History"]}),n.jsxs(L,{to:"/dashboard",className:"flex items-center px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-700 transition-colors",onClick:()=>a(!1),children:[n.jsx(Pa,{className:"w-4 h-4 mr-2"}),"Dashboard"]}),n.jsx("div",{className:"border-t border-secondary-200 dark:border-secondary-700 mt-2 pt-2",children:n.jsxs("button",{onClick:o,className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[n.jsx(Aa,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]})]})},Oc=({children:r})=>{const{user:e,profile:t,loading:s,isAuthenticated:a,resetLoading:i,fetchUserProfile:o,manualFetchProfile:l,diagnoseDatabase:c,logout:d,forceLogout:u,resetProfile:h,forceReset:m}=ee(),{theme:f,toggleTheme:p}=ea(),w=Va(),g=()=>{s&&(console.log("🖱️ Layout: User clicked, resetting loading state"),i())};return j.useEffect(()=>{const y=()=>{s&&(console.log("🌍 Layout: Global click detected, resetting loading state"),i())};return document.addEventListener("click",y),()=>document.removeEventListener("click",y)},[s,i]),s?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-secondary-50 dark:bg-secondary-900",children:n.jsxs("div",{className:"text-center",children:[n.jsx(me,{className:"w-12 h-12 animate-spin text-primary-600 mx-auto mb-4"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-4",children:"Loading your account..."}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors mr-2",children:"Refresh Page"}),!1]})]})}):n.jsxs("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900",onClick:g,children:[!1,n.jsx("header",{className:"bg-white dark:bg-secondary-800 shadow-sm border-b border-secondary-200 dark:border-secondary-700",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"flex justify-between items-center h-16",children:[n.jsxs(L,{to:"/",className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold text-lg",children:"3D"})}),n.jsx("span",{className:"text-xl font-bold text-secondary-900 dark:text-white",children:"3DShareSpace"})]}),n.jsxs("nav",{className:"hidden md:flex items-center space-x-8",children:[n.jsxs(L,{to:"/",className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${w.pathname==="/"?"text-primary-600 bg-primary-50 dark:bg-primary-900/20":"text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white"}`,children:[n.jsx(Oa,{className:"w-4 h-4"}),n.jsx("span",{children:"Home"})]}),n.jsxs(L,{to:"/explore",className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${w.pathname==="/explore"?"text-primary-600 bg-primary-50 dark:bg-primary-900/20":"text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white"}`,children:[n.jsx(De,{className:"w-4 h-4"}),n.jsx("span",{children:"Explore"})]}),a&&n.jsxs(n.Fragment,{children:[n.jsxs(L,{to:"/upload",className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${w.pathname==="/upload"?"text-primary-600 bg-primary-50 dark:bg-primary-900/20":"text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white"}`,children:[n.jsx(Z,{className:"w-4 h-4"}),n.jsx("span",{children:"Upload"})]}),n.jsxs(L,{to:"/dashboard",className:`flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${w.pathname==="/dashboard"?"text-primary-600 bg-primary-50 dark:bg-primary-900/20":"text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white"}`,children:[n.jsx(ke,{className:"w-4 h-4"}),n.jsx("span",{children:"Dashboard"})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(Pc,{}),a?n.jsx(Ac,{}):n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(L,{to:"/login",className:"px-4 py-2 text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white transition-colors",children:"Login"}),n.jsx(L,{to:"/signup",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Sign Up"})]})]})]})})}),n.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r}),n.jsx("footer",{className:"bg-white dark:bg-secondary-800 border-t border-secondary-200 dark:border-secondary-700 mt-auto",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:n.jsx("div",{className:"text-center text-secondary-600 dark:text-secondary-400",children:n.jsx("p",{children:"© 2024 3DShareSpace. All rights reserved."})})})})]})};function ta(r,e){return function(){return r.apply(e,arguments)}}const{toString:Rc}=Object.prototype,{getPrototypeOf:fr}=Object,{iterator:us,toStringTag:sa}=Symbol,hs=(r=>e=>{const t=Rc.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),pe=r=>(r=r.toLowerCase(),e=>hs(e)===r),fs=r=>e=>typeof e===r,{isArray:ct}=Array,vt=fs("undefined");function St(r){return r!==null&&!vt(r)&&r.constructor!==null&&!vt(r.constructor)&&ne(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const ra=pe("ArrayBuffer");function Dc(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&ra(r.buffer),e}const $c=fs("string"),ne=fs("function"),na=fs("number"),Et=r=>r!==null&&typeof r=="object",Fc=r=>r===!0||r===!1,It=r=>{if(hs(r)!=="object")return!1;const e=fr(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(sa in r)&&!(us in r)},Uc=r=>{if(!Et(r)||St(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},Lc=pe("Date"),Ic=pe("File"),Mc=pe("Blob"),qc=pe("FileList"),Bc=r=>Et(r)&&ne(r.pipe),zc=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||ne(r.append)&&((e=hs(r))==="formdata"||e==="object"&&ne(r.toString)&&r.toString()==="[object FormData]"))},Hc=pe("URLSearchParams"),[Wc,Kc,Vc,Jc]=["ReadableStream","Request","Response","Headers"].map(pe),Gc=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ct(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let s,a;if(typeof r!="object"&&(r=[r]),ct(r))for(s=0,a=r.length;s<a;s++)e.call(null,r[s],s,r);else{if(St(r))return;const i=t?Object.getOwnPropertyNames(r):Object.keys(r),o=i.length;let l;for(s=0;s<o;s++)l=i[s],e.call(null,r[l],l,r)}}function aa(r,e){if(St(r))return null;e=e.toLowerCase();const t=Object.keys(r);let s=t.length,a;for(;s-- >0;)if(a=t[s],e===a.toLowerCase())return a;return null}const He=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ia=r=>!vt(r)&&r!==He;function Xs(){const{caseless:r}=ia(this)&&this||{},e={},t=(s,a)=>{const i=r&&aa(e,a)||a;It(e[i])&&It(s)?e[i]=Xs(e[i],s):It(s)?e[i]=Xs({},s):ct(s)?e[i]=s.slice():e[i]=s};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Ct(arguments[s],t);return e}const Qc=(r,e,t,{allOwnKeys:s}={})=>(Ct(e,(a,i)=>{t&&ne(a)?r[i]=ta(a,t):r[i]=a},{allOwnKeys:s}),r),Yc=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Xc=(r,e,t,s)=>{r.prototype=Object.create(e.prototype,s),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},Zc=(r,e,t,s)=>{let a,i,o;const l={};if(e=e||{},r==null)return e;do{for(a=Object.getOwnPropertyNames(r),i=a.length;i-- >0;)o=a[i],(!s||s(o,r,e))&&!l[o]&&(e[o]=r[o],l[o]=!0);r=t!==!1&&fr(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},ed=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const s=r.indexOf(e,t);return s!==-1&&s===t},td=r=>{if(!r)return null;if(ct(r))return r;let e=r.length;if(!na(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},sd=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&fr(Uint8Array)),rd=(r,e)=>{const s=(r&&r[us]).call(r);let a;for(;(a=s.next())&&!a.done;){const i=a.value;e.call(r,i[0],i[1])}},nd=(r,e)=>{let t;const s=[];for(;(t=r.exec(e))!==null;)s.push(t);return s},ad=pe("HTMLFormElement"),id=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,a){return s.toUpperCase()+a}),Jr=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),od=pe("RegExp"),oa=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),s={};Ct(t,(a,i)=>{let o;(o=e(a,i,r))!==!1&&(s[i]=o||a)}),Object.defineProperties(r,s)},ld=r=>{oa(r,(e,t)=>{if(ne(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=r[t];if(ne(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},cd=(r,e)=>{const t={},s=a=>{a.forEach(i=>{t[i]=!0})};return ct(r)?s(r):s(String(r).split(e)),t},dd=()=>{},ud=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e;function hd(r){return!!(r&&ne(r.append)&&r[sa]==="FormData"&&r[us])}const fd=r=>{const e=new Array(10),t=(s,a)=>{if(Et(s)){if(e.indexOf(s)>=0)return;if(St(s))return s;if(!("toJSON"in s)){e[a]=s;const i=ct(s)?[]:{};return Ct(s,(o,l)=>{const c=t(o,a+1);!vt(c)&&(i[l]=c)}),e[a]=void 0,i}}return s};return t(r,0)},md=pe("AsyncFunction"),pd=r=>r&&(Et(r)||ne(r))&&ne(r.then)&&ne(r.catch),la=((r,e)=>r?setImmediate:e?((t,s)=>(He.addEventListener("message",({source:a,data:i})=>{a===He&&i===t&&s.length&&s.shift()()},!1),a=>{s.push(a),He.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ne(He.postMessage)),xd=typeof queueMicrotask<"u"?queueMicrotask.bind(He):typeof process<"u"&&process.nextTick||la,gd=r=>r!=null&&ne(r[us]),v={isArray:ct,isArrayBuffer:ra,isBuffer:St,isFormData:zc,isArrayBufferView:Dc,isString:$c,isNumber:na,isBoolean:Fc,isObject:Et,isPlainObject:It,isEmptyObject:Uc,isReadableStream:Wc,isRequest:Kc,isResponse:Vc,isHeaders:Jc,isUndefined:vt,isDate:Lc,isFile:Ic,isBlob:Mc,isRegExp:od,isFunction:ne,isStream:Bc,isURLSearchParams:Hc,isTypedArray:sd,isFileList:qc,forEach:Ct,merge:Xs,extend:Qc,trim:Gc,stripBOM:Yc,inherits:Xc,toFlatObject:Zc,kindOf:hs,kindOfTest:pe,endsWith:ed,toArray:td,forEachEntry:rd,matchAll:nd,isHTMLForm:ad,hasOwnProperty:Jr,hasOwnProp:Jr,reduceDescriptors:oa,freezeMethods:ld,toObjectSet:cd,toCamelCase:id,noop:dd,toFiniteNumber:ud,findKey:aa,global:He,isContextDefined:ia,isSpecCompliantForm:hd,toJSONObject:fd,isAsyncFn:md,isThenable:pd,setImmediate:la,asap:xd,isIterable:gd};function U(r,e,t,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}v.inherits(U,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:v.toJSONObject(this.config),code:this.code,status:this.status}}});const ca=U.prototype,da={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{da[r]={value:r}});Object.defineProperties(U,da);Object.defineProperty(ca,"isAxiosError",{value:!0});U.from=(r,e,t,s,a,i)=>{const o=Object.create(ca);return v.toFlatObject(r,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),U.call(o,r.message,e,t,s,a),o.cause=r,o.name=r.name,i&&Object.assign(o,i),o};const yd=null;function Zs(r){return v.isPlainObject(r)||v.isArray(r)}function ua(r){return v.endsWith(r,"[]")?r.slice(0,-2):r}function Gr(r,e,t){return r?r.concat(e).map(function(a,i){return a=ua(a),!t&&i?"["+a+"]":a}).join(t?".":""):e}function bd(r){return v.isArray(r)&&!r.some(Zs)}const vd=v.toFlatObject(v,{},null,function(e){return/^is[A-Z]/.test(e)});function ms(r,e,t){if(!v.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=v.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,g){return!v.isUndefined(g[w])});const s=t.metaTokens,a=t.visitor||u,i=t.dots,o=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&v.isSpecCompliantForm(e);if(!v.isFunction(a))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(v.isDate(p))return p.toISOString();if(v.isBoolean(p))return p.toString();if(!c&&v.isBlob(p))throw new U("Blob is not supported. Use a Buffer instead.");return v.isArrayBuffer(p)||v.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,w,g){let y=p;if(p&&!g&&typeof p=="object"){if(v.endsWith(w,"{}"))w=s?w:w.slice(0,-2),p=JSON.stringify(p);else if(v.isArray(p)&&bd(p)||(v.isFileList(p)||v.endsWith(w,"[]"))&&(y=v.toArray(p)))return w=ua(w),y.forEach(function(x,C){!(v.isUndefined(x)||x===null)&&e.append(o===!0?Gr([w],C,i):o===null?w:w+"[]",d(x))}),!1}return Zs(p)?!0:(e.append(Gr(g,w,i),d(p)),!1)}const h=[],m=Object.assign(vd,{defaultVisitor:u,convertValue:d,isVisitable:Zs});function f(p,w){if(!v.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(p),v.forEach(p,function(y,N){(!(v.isUndefined(y)||y===null)&&a.call(e,y,v.isString(N)?N.trim():N,w,m))===!0&&f(y,w?w.concat(N):[N])}),h.pop()}}if(!v.isObject(r))throw new TypeError("data must be an object");return f(r),e}function Qr(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function mr(r,e){this._pairs=[],r&&ms(r,this,e)}const ha=mr.prototype;ha.append=function(e,t){this._pairs.push([e,t])};ha.toString=function(e){const t=e?function(s){return e.call(this,s,Qr)}:Qr;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function wd(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function fa(r,e,t){if(!e)return r;const s=t&&t.encode||wd;v.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let i;if(a?i=a(e,t):i=v.isURLSearchParams(e)?e.toString():new mr(e,t).toString(s),i){const o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+i}return r}class Yr{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){v.forEach(this.handlers,function(s){s!==null&&e(s)})}}const ma={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jd=typeof URLSearchParams<"u"?URLSearchParams:mr,kd=typeof FormData<"u"?FormData:null,_d=typeof Blob<"u"?Blob:null,Nd={isBrowser:!0,classes:{URLSearchParams:jd,FormData:kd,Blob:_d},protocols:["http","https","file","blob","url","data"]},pr=typeof window<"u"&&typeof document<"u",er=typeof navigator=="object"&&navigator||void 0,Sd=pr&&(!er||["ReactNative","NativeScript","NS"].indexOf(er.product)<0),Ed=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Cd=pr&&window.location.href||"http://localhost",Td=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:pr,hasStandardBrowserEnv:Sd,hasStandardBrowserWebWorkerEnv:Ed,navigator:er,origin:Cd},Symbol.toStringTag,{value:"Module"})),Q={...Td,...Nd};function Pd(r,e){return ms(r,new Q.classes.URLSearchParams,{visitor:function(t,s,a,i){return Q.isNode&&v.isBuffer(t)?(this.append(s,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function Ad(r){return v.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Od(r){const e={},t=Object.keys(r);let s;const a=t.length;let i;for(s=0;s<a;s++)i=t[s],e[i]=r[i];return e}function pa(r){function e(t,s,a,i){let o=t[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=i>=t.length;return o=!o&&v.isArray(a)?a.length:o,c?(v.hasOwnProp(a,o)?a[o]=[a[o],s]:a[o]=s,!l):((!a[o]||!v.isObject(a[o]))&&(a[o]=[]),e(t,s,a[o],i)&&v.isArray(a[o])&&(a[o]=Od(a[o])),!l)}if(v.isFormData(r)&&v.isFunction(r.entries)){const t={};return v.forEachEntry(r,(s,a)=>{e(Ad(s),a,t,0)}),t}return null}function Rd(r,e,t){if(v.isString(r))try{return(e||JSON.parse)(r),v.trim(r)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(r)}const Tt={transitional:ma,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",a=s.indexOf("application/json")>-1,i=v.isObject(e);if(i&&v.isHTMLForm(e)&&(e=new FormData(e)),v.isFormData(e))return a?JSON.stringify(pa(e)):e;if(v.isArrayBuffer(e)||v.isBuffer(e)||v.isStream(e)||v.isFile(e)||v.isBlob(e)||v.isReadableStream(e))return e;if(v.isArrayBufferView(e))return e.buffer;if(v.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Pd(e,this.formSerializer).toString();if((l=v.isFileList(e))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return ms(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||a?(t.setContentType("application/json",!1),Rd(e)):e}],transformResponse:[function(e){const t=this.transitional||Tt.transitional,s=t&&t.forcedJSONParsing,a=this.responseType==="json";if(v.isResponse(e)||v.isReadableStream(e))return e;if(e&&v.isString(e)&&(s&&!this.responseType||a)){const o=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?U.from(l,U.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Q.classes.FormData,Blob:Q.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};v.forEach(["delete","get","head","post","put","patch"],r=>{Tt.headers[r]={}});const Dd=v.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$d=r=>{const e={};let t,s,a;return r&&r.split(`
`).forEach(function(o){a=o.indexOf(":"),t=o.substring(0,a).trim().toLowerCase(),s=o.substring(a+1).trim(),!(!t||e[t]&&Dd[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},Xr=Symbol("internals");function ft(r){return r&&String(r).trim().toLowerCase()}function Mt(r){return r===!1||r==null?r:v.isArray(r)?r.map(Mt):String(r)}function Fd(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(r);)e[s[1]]=s[2];return e}const Ud=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Ps(r,e,t,s,a){if(v.isFunction(s))return s.call(this,e,t);if(a&&(e=t),!!v.isString(e)){if(v.isString(s))return e.indexOf(s)!==-1;if(v.isRegExp(s))return s.test(e)}}function Ld(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function Id(r,e){const t=v.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(r,s+t,{value:function(a,i,o){return this[s].call(this,e,a,i,o)},configurable:!0})})}let ae=class{constructor(e){e&&this.set(e)}set(e,t,s){const a=this;function i(l,c,d){const u=ft(c);if(!u)throw new Error("header name must be a non-empty string");const h=v.findKey(a,u);(!h||a[h]===void 0||d===!0||d===void 0&&a[h]!==!1)&&(a[h||c]=Mt(l))}const o=(l,c)=>v.forEach(l,(d,u)=>i(d,u,c));if(v.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(v.isString(e)&&(e=e.trim())&&!Ud(e))o($d(e),t);else if(v.isObject(e)&&v.isIterable(e)){let l={},c,d;for(const u of e){if(!v.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[d=u[0]]=(c=l[d])?v.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}o(l,t)}else e!=null&&i(t,e,s);return this}get(e,t){if(e=ft(e),e){const s=v.findKey(this,e);if(s){const a=this[s];if(!t)return a;if(t===!0)return Fd(a);if(v.isFunction(t))return t.call(this,a,s);if(v.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ft(e),e){const s=v.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||Ps(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let a=!1;function i(o){if(o=ft(o),o){const l=v.findKey(s,o);l&&(!t||Ps(s,s[l],l,t))&&(delete s[l],a=!0)}}return v.isArray(e)?e.forEach(i):i(e),a}clear(e){const t=Object.keys(this);let s=t.length,a=!1;for(;s--;){const i=t[s];(!e||Ps(this,this[i],i,e,!0))&&(delete this[i],a=!0)}return a}normalize(e){const t=this,s={};return v.forEach(this,(a,i)=>{const o=v.findKey(s,i);if(o){t[o]=Mt(a),delete t[i];return}const l=e?Ld(i):String(i).trim();l!==i&&delete t[i],t[l]=Mt(a),s[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return v.forEach(this,(s,a)=>{s!=null&&s!==!1&&(t[a]=e&&v.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(a=>s.set(a)),s}static accessor(e){const s=(this[Xr]=this[Xr]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=ft(o);s[l]||(Id(a,o),s[l]=!0)}return v.isArray(e)?e.forEach(i):i(e),this}};ae.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);v.reduceDescriptors(ae.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(s){this[t]=s}}});v.freezeMethods(ae);function As(r,e){const t=this||Tt,s=e||t,a=ae.from(s.headers);let i=s.data;return v.forEach(r,function(l){i=l.call(t,i,a.normalize(),e?e.status:void 0)}),a.normalize(),i}function xa(r){return!!(r&&r.__CANCEL__)}function dt(r,e,t){U.call(this,r??"canceled",U.ERR_CANCELED,e,t),this.name="CanceledError"}v.inherits(dt,U,{__CANCEL__:!0});function ga(r,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?r(t):e(new U("Request failed with status code "+t.status,[U.ERR_BAD_REQUEST,U.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Md(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function qd(r,e){r=r||10;const t=new Array(r),s=new Array(r);let a=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),u=s[i];o||(o=d),t[a]=c,s[a]=d;let h=i,m=0;for(;h!==a;)m+=t[h++],h=h%r;if(a=(a+1)%r,a===i&&(i=(i+1)%r),d-o<e)return;const f=u&&d-u;return f?Math.round(m*1e3/f):void 0}}function Bd(r,e){let t=0,s=1e3/e,a,i;const o=(d,u=Date.now())=>{t=u,a=null,i&&(clearTimeout(i),i=null),r(...d)};return[(...d)=>{const u=Date.now(),h=u-t;h>=s?o(d,u):(a=d,i||(i=setTimeout(()=>{i=null,o(a)},s-h)))},()=>a&&o(a)]}const Yt=(r,e,t=3)=>{let s=0;const a=qd(50,250);return Bd(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,c=o-s,d=a(c),u=o<=l;s=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&u?(l-o)/d:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};r(h)},t)},Zr=(r,e)=>{const t=r!=null;return[s=>e[0]({lengthComputable:t,total:r,loaded:s}),e[1]]},en=r=>(...e)=>v.asap(()=>r(...e)),zd=Q.hasStandardBrowserEnv?((r,e)=>t=>(t=new URL(t,Q.origin),r.protocol===t.protocol&&r.host===t.host&&(e||r.port===t.port)))(new URL(Q.origin),Q.navigator&&/(msie|trident)/i.test(Q.navigator.userAgent)):()=>!0,Hd=Q.hasStandardBrowserEnv?{write(r,e,t,s,a,i){const o=[r+"="+encodeURIComponent(e)];v.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),v.isString(s)&&o.push("path="+s),v.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Wd(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Kd(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function ya(r,e,t){let s=!Wd(e);return r&&(s||t==!1)?Kd(r,e):e}const tn=r=>r instanceof ae?{...r}:r;function Ke(r,e){e=e||{};const t={};function s(d,u,h,m){return v.isPlainObject(d)&&v.isPlainObject(u)?v.merge.call({caseless:m},d,u):v.isPlainObject(u)?v.merge({},u):v.isArray(u)?u.slice():u}function a(d,u,h,m){if(v.isUndefined(u)){if(!v.isUndefined(d))return s(void 0,d,h,m)}else return s(d,u,h,m)}function i(d,u){if(!v.isUndefined(u))return s(void 0,u)}function o(d,u){if(v.isUndefined(u)){if(!v.isUndefined(d))return s(void 0,d)}else return s(void 0,u)}function l(d,u,h){if(h in e)return s(d,u);if(h in r)return s(void 0,d)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,u,h)=>a(tn(d),tn(u),h,!0)};return v.forEach(Object.keys({...r,...e}),function(u){const h=c[u]||a,m=h(r[u],e[u],u);v.isUndefined(m)&&h!==l||(t[u]=m)}),t}const ba=r=>{const e=Ke({},r);let{data:t,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=e;e.headers=o=ae.from(o),e.url=fa(ya(e.baseURL,e.url,e.allowAbsoluteUrls),r.params,r.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(v.isFormData(t)){if(Q.hasStandardBrowserEnv||Q.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[d,...u]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Q.hasStandardBrowserEnv&&(s&&v.isFunction(s)&&(s=s(e)),s||s!==!1&&zd(e.url))){const d=a&&i&&Hd.read(i);d&&o.set(a,d)}return e},Vd=typeof XMLHttpRequest<"u",Jd=Vd&&function(r){return new Promise(function(t,s){const a=ba(r);let i=a.data;const o=ae.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,u,h,m,f,p;function w(){f&&f(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(a.method.toUpperCase(),a.url,!0),g.timeout=a.timeout;function y(){if(!g)return;const x=ae.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),P={data:!l||l==="text"||l==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:x,config:r,request:g};ga(function(_){t(_),w()},function(_){s(_),w()},P),g=null}"onloadend"in g?g.onloadend=y:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(y)},g.onabort=function(){g&&(s(new U("Request aborted",U.ECONNABORTED,r,g)),g=null)},g.onerror=function(){s(new U("Network Error",U.ERR_NETWORK,r,g)),g=null},g.ontimeout=function(){let C=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const P=a.transitional||ma;a.timeoutErrorMessage&&(C=a.timeoutErrorMessage),s(new U(C,P.clarifyTimeoutError?U.ETIMEDOUT:U.ECONNABORTED,r,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&v.forEach(o.toJSON(),function(C,P){g.setRequestHeader(P,C)}),v.isUndefined(a.withCredentials)||(g.withCredentials=!!a.withCredentials),l&&l!=="json"&&(g.responseType=a.responseType),d&&([m,p]=Yt(d,!0),g.addEventListener("progress",m)),c&&g.upload&&([h,f]=Yt(c),g.upload.addEventListener("progress",h),g.upload.addEventListener("loadend",f)),(a.cancelToken||a.signal)&&(u=x=>{g&&(s(!x||x.type?new dt(null,r,g):x),g.abort(),g=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const N=Md(a.url);if(N&&Q.protocols.indexOf(N)===-1){s(new U("Unsupported protocol "+N+":",U.ERR_BAD_REQUEST,r));return}g.send(i||null)})},Gd=(r,e)=>{const{length:t}=r=r?r.filter(Boolean):[];if(e||t){let s=new AbortController,a;const i=function(d){if(!a){a=!0,l();const u=d instanceof Error?d:this.reason;s.abort(u instanceof U?u:new dt(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new U(`timeout ${e} of ms exceeded`,U.ETIMEDOUT))},e);const l=()=>{r&&(o&&clearTimeout(o),o=null,r.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),r=null)};r.forEach(d=>d.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>v.asap(l),c}},Qd=function*(r,e){let t=r.byteLength;if(t<e){yield r;return}let s=0,a;for(;s<t;)a=s+e,yield r.slice(s,a),s=a},Yd=async function*(r,e){for await(const t of Xd(r))yield*Qd(t,e)},Xd=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},sn=(r,e,t,s)=>{const a=Yd(r,e);let i=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await a.next();if(d){l(),c.close();return}let h=u.byteLength;if(t){let m=i+=h;t(m)}c.enqueue(new Uint8Array(u))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},ps=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",va=ps&&typeof ReadableStream=="function",Zd=ps&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),wa=(r,...e)=>{try{return!!r(...e)}catch{return!1}},eu=va&&wa(()=>{let r=!1;const e=new Request(Q.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),rn=64*1024,tr=va&&wa(()=>v.isReadableStream(new Response("").body)),Xt={stream:tr&&(r=>r.body)};ps&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Xt[e]&&(Xt[e]=v.isFunction(r[e])?t=>t[e]():(t,s)=>{throw new U(`Response type '${e}' is not supported`,U.ERR_NOT_SUPPORT,s)})})})(new Response);const tu=async r=>{if(r==null)return 0;if(v.isBlob(r))return r.size;if(v.isSpecCompliantForm(r))return(await new Request(Q.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(v.isArrayBufferView(r)||v.isArrayBuffer(r))return r.byteLength;if(v.isURLSearchParams(r)&&(r=r+""),v.isString(r))return(await Zd(r)).byteLength},su=async(r,e)=>{const t=v.toFiniteNumber(r.getContentLength());return t??tu(e)},ru=ps&&(async r=>{let{url:e,method:t,data:s,signal:a,cancelToken:i,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:u,withCredentials:h="same-origin",fetchOptions:m}=ba(r);d=d?(d+"").toLowerCase():"text";let f=Gd([a,i&&i.toAbortSignal()],o),p;const w=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(c&&eu&&t!=="get"&&t!=="head"&&(g=await su(u,s))!==0){let P=new Request(e,{method:"POST",body:s,duplex:"half"}),S;if(v.isFormData(s)&&(S=P.headers.get("content-type"))&&u.setContentType(S),P.body){const[_,R]=Zr(g,Yt(en(c)));s=sn(P.body,rn,_,R)}}v.isString(h)||(h=h?"include":"omit");const y="credentials"in Request.prototype;p=new Request(e,{...m,signal:f,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:y?h:void 0});let N=await fetch(p,m);const x=tr&&(d==="stream"||d==="response");if(tr&&(l||x&&w)){const P={};["status","statusText","headers"].forEach(A=>{P[A]=N[A]});const S=v.toFiniteNumber(N.headers.get("content-length")),[_,R]=l&&Zr(S,Yt(en(l),!0))||[];N=new Response(sn(N.body,rn,_,()=>{R&&R(),w&&w()}),P)}d=d||"text";let C=await Xt[v.findKey(Xt,d)||"text"](N,r);return!x&&w&&w(),await new Promise((P,S)=>{ga(P,S,{data:C,headers:ae.from(N.headers),status:N.status,statusText:N.statusText,config:r,request:p})})}catch(y){throw w&&w(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new U("Network Error",U.ERR_NETWORK,r,p),{cause:y.cause||y}):U.from(y,y&&y.code,r,p)}}),sr={http:yd,xhr:Jd,fetch:ru};v.forEach(sr,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const nn=r=>`- ${r}`,nu=r=>v.isFunction(r)||r===null||r===!1,ja={getAdapter:r=>{r=v.isArray(r)?r:[r];const{length:e}=r;let t,s;const a={};for(let i=0;i<e;i++){t=r[i];let o;if(s=t,!nu(t)&&(s=sr[(o=String(t)).toLowerCase()],s===void 0))throw new U(`Unknown adapter '${o}'`);if(s)break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(nn).join(`
`):" "+nn(i[0]):"as no adapter specified";throw new U("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:sr};function Os(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new dt(null,r)}function an(r){return Os(r),r.headers=ae.from(r.headers),r.data=As.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),ja.getAdapter(r.adapter||Tt.adapter)(r).then(function(s){return Os(r),s.data=As.call(r,r.transformResponse,s),s.headers=ae.from(s.headers),s},function(s){return xa(s)||(Os(r),s&&s.response&&(s.response.data=As.call(r,r.transformResponse,s.response),s.response.headers=ae.from(s.response.headers))),Promise.reject(s)})}const ka="1.11.0",xs={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{xs[r]=function(s){return typeof s===r||"a"+(e<1?"n ":" ")+r}});const on={};xs.transitional=function(e,t,s){function a(i,o){return"[Axios v"+ka+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,l)=>{if(e===!1)throw new U(a(o," has been removed"+(t?" in "+t:"")),U.ERR_DEPRECATED);return t&&!on[o]&&(on[o]=!0,console.warn(a(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,o,l):!0}};xs.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function au(r,e,t){if(typeof r!="object")throw new U("options must be an object",U.ERR_BAD_OPTION_VALUE);const s=Object.keys(r);let a=s.length;for(;a-- >0;){const i=s[a],o=e[i];if(o){const l=r[i],c=l===void 0||o(l,i,r);if(c!==!0)throw new U("option "+i+" must be "+c,U.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new U("Unknown option "+i,U.ERR_BAD_OPTION)}}const qt={assertOptions:au,validators:xs},xe=qt.validators;let We=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Yr,response:new Yr}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ke(this.defaults,t);const{transitional:s,paramsSerializer:a,headers:i}=t;s!==void 0&&qt.assertOptions(s,{silentJSONParsing:xe.transitional(xe.boolean),forcedJSONParsing:xe.transitional(xe.boolean),clarifyTimeoutError:xe.transitional(xe.boolean)},!1),a!=null&&(v.isFunction(a)?t.paramsSerializer={serialize:a}:qt.assertOptions(a,{encode:xe.function,serialize:xe.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),qt.assertOptions(t,{baseUrl:xe.spelling("baseURL"),withXsrfToken:xe.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&v.merge(i.common,i[t.method]);i&&v.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),t.headers=ae.concat(o,i);const l=[];let c=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(t)===!1||(c=c&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const d=[];this.interceptors.response.forEach(function(w){d.push(w.fulfilled,w.rejected)});let u,h=0,m;if(!c){const p=[an.bind(this),void 0];for(p.unshift(...l),p.push(...d),m=p.length,u=Promise.resolve(t);h<m;)u=u.then(p[h++],p[h++]);return u}m=l.length;let f=t;for(h=0;h<m;){const p=l[h++],w=l[h++];try{f=p(f)}catch(g){w.call(this,g);break}}try{u=an.call(this,f)}catch(p){return Promise.reject(p)}for(h=0,m=d.length;h<m;)u=u.then(d[h++],d[h++]);return u}getUri(e){e=Ke(this.defaults,e);const t=ya(e.baseURL,e.url,e.allowAbsoluteUrls);return fa(t,e.params,e.paramsSerializer)}};v.forEach(["delete","get","head","options"],function(e){We.prototype[e]=function(t,s){return this.request(Ke(s||{},{method:e,url:t,data:(s||{}).data}))}});v.forEach(["post","put","patch"],function(e){function t(s){return function(i,o,l){return this.request(Ke(l||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}We.prototype[e]=t(),We.prototype[e+"Form"]=t(!0)});let iu=class _a{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const s=this;this.promise.then(a=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](a);s._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{s.subscribe(l),i=l}).then(a);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i,o,l){s.reason||(s.reason=new dt(i,o,l),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new _a(function(a){e=a}),cancel:e}}};function ou(r){return function(t){return r.apply(null,t)}}function lu(r){return v.isObject(r)&&r.isAxiosError===!0}const rr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(rr).forEach(([r,e])=>{rr[e]=r});function Na(r){const e=new We(r),t=ta(We.prototype.request,e);return v.extend(t,We.prototype,e,{allOwnKeys:!0}),v.extend(t,e,null,{allOwnKeys:!0}),t.create=function(a){return Na(Ke(r,a))},t}const H=Na(Tt);H.Axios=We;H.CanceledError=dt;H.CancelToken=iu;H.isCancel=xa;H.VERSION=ka;H.toFormData=ms;H.AxiosError=U;H.Cancel=H.CanceledError;H.all=function(e){return Promise.all(e)};H.spread=ou;H.isAxiosError=lu;H.mergeConfig=Ke;H.AxiosHeaders=ae;H.formToJSON=r=>pa(v.isHTMLForm(r)?new FormData(r):r);H.getAdapter=ja.getAdapter;H.HttpStatusCode=rr;H.default=H;const{Axios:Hu,AxiosError:Wu,CanceledError:Ku,isCancel:Vu,CancelToken:Ju,VERSION:Gu,all:Qu,Cancel:Yu,isAxiosError:Xu,spread:Zu,toFormData:eh,AxiosHeaders:th,HttpStatusCode:sh,formToJSON:rh,getAdapter:nh,mergeConfig:ah}=H,ge=H.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});ge.interceptors.request.use(r=>{const e=localStorage.getItem("token");return e&&(r.headers.Authorization=`Bearer ${e}`),r},r=>Promise.reject(r));ge.interceptors.response.use(r=>r,r=>{var e;return((e=r.response)==null?void 0:e.status)===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(r)});const cu={getAllModels:(r={})=>ge.get("/models",{params:r}).then(e=>e.data),getModelById:r=>ge.get(`/models/${r}`).then(e=>e.data),like:r=>ge.post(`/models/${r}/like`).then(e=>e.data),likeModel:r=>ge.post(`/models/${r}/like`).then(e=>e.data),addComment:(r,e)=>ge.post(`/models/${r}/comments`,{content:e}).then(t=>t.data),getFeaturedModels:(r=10)=>ge.get(`/models/featured?limit=${r}`).then(e=>e.data),getTrendingModels:(r=10)=>ge.get(`/models/trending?limit=${r}`).then(e=>e.data),getStats:()=>ge.get("/stats/platform").then(r=>r.data)},du={formatFileSize:r=>{if(r===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(r)/Math.log(e));return parseFloat((r/Math.pow(e,s)).toFixed(2))+" "+t[s]},formatDate:r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),formatRelativeTime:r=>{const t=new Date-new Date(r),s=Math.floor(t/1e3),a=Math.floor(s/60),i=Math.floor(a/60),o=Math.floor(i/24);return o>0?`${o} day${o>1?"s":""} ago`:i>0?`${i} hour${i>1?"s":""} ago`:a>0?`${a} minute${a>1?"s":""} ago`:"Just now"},validateFileType:(r,e)=>{const t=r.name.split(".").pop().toLowerCase();return e.includes(t)},validateFileSize:(r,e)=>r.size<=e,createUploadFormData:(r,e)=>{const t=new FormData;return t.append("model",r),Object.keys(e).forEach(s=>{e[s]!==void 0&&e[s]!==null&&(Array.isArray(e[s])?t.append(s,JSON.stringify(e[s])):t.append(s,e[s]))}),t}},ln=({model:r,compact:e=!1})=>{const[t,s]=j.useState(r.isLiked||!1),[a,i]=j.useState(r.likeCount||0),[o,l]=j.useState(!1),{isAuthenticated:c}=ee(),d=r.creator||r.user||{},u=Array.isArray(r.tags)?r.tags:typeof r.tags=="string"?r.tags.split(",").map(f=>f.trim()).filter(Boolean):[],h=async()=>{if(!c){O.error("Please sign in to like models");return}try{l(!0);const f=await cu.like(r.id);s(f.liked),i(p=>f.liked?p+1:p-1),f.liked?O.success("Model added to favorites!"):O.success("Model removed from favorites")}catch{O.error("Failed to update like status")}finally{l(!1)}},m=()=>{if(!c){O.error("Please sign in to download models");return}O.success("Starting download...")};return e?n.jsxs(L,{to:`/models/${r.id}`,className:"card hover:shadow-lg transition-all duration-200 group",children:[n.jsxs("div",{className:"relative",children:[r.thumbnailUrl?n.jsx("img",{src:r.thumbnailUrl,alt:r.title,className:"w-full h-32 object-cover rounded-t-lg group-hover:scale-105 transition-transform duration-200"}):n.jsx("div",{className:"w-full h-32 bg-gradient-to-br from-secondary-100 to-secondary-200 dark:from-secondary-700 dark:to-secondary-800 rounded-t-lg flex items-center justify-center",children:n.jsx("div",{className:"text-secondary-400 dark:text-secondary-500",children:n.jsx("svg",{className:"w-12 h-12",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"})})})}),n.jsx("div",{className:"absolute top-2 left-2",children:n.jsx("span",{className:"badge-primary text-xs px-2 py-1",children:r.category})})]}),n.jsxs("div",{className:"card-body p-4",children:[n.jsx("h3",{className:"font-semibold text-secondary-900 dark:text-white text-sm mb-2 line-clamp-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-200",children:r.title}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-secondary-500 dark:text-secondary-400",children:[n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(Ne,{className:"w-3 h-3"}),n.jsx("span",{children:d==null?void 0:d.username})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(V,{className:"w-3 h-3"}),n.jsx("span",{children:r.viewCount})]}),n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(de,{className:"w-3 h-3"}),n.jsx("span",{children:r.downloadCount})]})]})]})]})]}):n.jsxs("div",{className:"card hover:shadow-lg transition-all duration-200 group",children:[n.jsxs("div",{className:"relative",children:[r.thumbnailUrl?n.jsx("img",{src:r.thumbnailUrl,alt:r.title,className:"w-full h-48 object-cover rounded-t-lg group-hover:scale-105 transition-transform duration-200"}):n.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-secondary-100 to-secondary-200 dark:from-secondary-700 dark:to-secondary-800 rounded-t-lg flex items-center justify-center",children:n.jsx("div",{className:"text-secondary-400 dark:text-secondary-500",children:n.jsx("svg",{className:"w-16 h-16",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"})})})}),n.jsx("div",{className:"absolute top-3 left-3",children:n.jsx("span",{className:"badge-primary px-3 py-1",children:r.category})}),n.jsxs("div",{className:"absolute top-3 right-3 flex space-x-2",children:[n.jsx("button",{onClick:h,disabled:o,className:`p-2 rounded-full transition-all duration-200 ${t?"bg-red-500 text-white hover:bg-red-600":"bg-white/90 dark:bg-secondary-800/90 text-secondary-600 dark:text-secondary-400 hover:bg-white dark:hover:bg-secondary-800"}`,"aria-label":t?"Unlike model":"Like model",children:n.jsx(_e,{className:`w-4 h-4 ${t?"fill-current":""}`})}),n.jsx("button",{onClick:m,className:"p-2 rounded-full bg-white/90 dark:bg-secondary-800/90 text-secondary-600 dark:text-secondary-400 hover:bg-white dark:hover:bg-secondary-800 transition-all duration-200","aria-label":"Download model",children:n.jsx(de,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"card-body",children:[n.jsx(L,{to:`/models/${r.id}`,children:n.jsx("h3",{className:"font-semibold text-lg text-secondary-900 dark:text-white mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-200 line-clamp-2",children:r.title})}),r.description&&n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 text-sm mb-4 line-clamp-2",children:r.description}),u.length>0&&n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[u.slice(0,3).map((f,p)=>n.jsx("span",{className:"badge-secondary text-xs px-2 py-1",children:f},p)),u.length>3&&n.jsxs("span",{className:"badge-secondary text-xs px-2 py-1",children:["+",u.length-3]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-500 dark:text-secondary-400",children:[n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(V,{className:"w-4 h-4"}),n.jsx("span",{children:r.viewCount})]}),n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(de,{className:"w-4 h-4"}),n.jsx("span",{children:r.downloadCount})]}),n.jsxs("span",{className:"flex items-center space-x-1",children:[n.jsx(_e,{className:"w-4 h-4"}),n.jsx("span",{children:a})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[d!=null&&d.avatar?n.jsx("img",{src:d.avatar,alt:d.username,className:"w-6 h-6 rounded-full object-cover"}):n.jsx("div",{className:"w-6 h-6 bg-primary-600 rounded-full flex items-center justify-center",children:n.jsx(Ne,{className:"w-3 h-3 text-white"})}),n.jsx(L,{to:`/creators/${d==null?void 0:d.username}`,className:"text-sm text-secondary-600 dark:text-secondary-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",children:d==null?void 0:d.username})]})]}),n.jsx("div",{className:"mt-3 pt-3 border-t border-secondary-200 dark:border-secondary-700",children:n.jsxs("div",{className:"flex items-center space-x-1 text-xs text-secondary-500 dark:text-secondary-400",children:[n.jsx(at,{className:"w-3 h-3"}),n.jsx("span",{children:du.formatRelativeTime(r.createdAt)})]})})]})]})},uu=()=>{var w,g,y,N;const[r,e]=j.useState([]),[t,s]=j.useState([]),[a,i]=j.useState(null),[o,l]=j.useState(!0),[c,d]=j.useState(!0),[u,h]=j.useState(!0);j.useEffect(()=>{m()},[]);const m=async()=>{try{const x=await Ts.getModels({featured:!0,limit:6});e(x||[]),l(!1);const C=await Ts.getModels({trending:!0,limit:6});s(C||[]),d(!1);const P=await Ts.getStats();i(P),h(!1),console.log("Featured models loaded:",{models:x}),console.log("Trending models loaded:",{models:C}),console.log("Stats loaded:",P)}catch(x){console.error("Error fetching data:",x),O.error("Failed to load data. Please refresh the page."),l(!1),d(!1),h(!1)}},f=({icon:x,title:C,value:P,description:S})=>n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg p-6 shadow-sm border border-secondary-200 dark:border-secondary-700",children:[n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"p-2 bg-primary-100 dark:bg-primary-900 rounded-lg",children:n.jsx(x,{className:"w-6 h-6 text-primary-600 dark:text-primary-400"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-white",children:P}),n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:C})]})]}),S&&n.jsx("p",{className:"text-xs text-secondary-500 dark:text-secondary-500 mt-2",children:S})]}),p=()=>{l(!0),d(!0),h(!0),m()};return n.jsxs("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900",children:[n.jsx("section",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 text-white py-20",children:n.jsxs("div",{className:"container mx-auto px-4 text-center",children:[n.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:"Find the Perfect 3D Model for Your Project"}),n.jsx("p",{className:"text-xl md:text-2xl mb-8 text-primary-100 max-w-3xl mx-auto",children:"Explore thousands of high-quality 3D models, textures, and materials. All free to download and use in your creative projects."}),n.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:n.jsxs("div",{className:"flex",children:[n.jsx("input",{type:"text",placeholder:"Search for models, characters, environments...",className:"flex-1 px-6 py-4 text-secondary-900 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-primary-400"}),n.jsx("button",{className:"px-8 py-4 bg-primary-500 hover:bg-primary-400 rounded-r-lg transition-colors duration-200 font-semibold",children:"Search"})]})}),n.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:["All","Characters","Environments","Props","Vehicles","Weapons"].map(x=>n.jsx("button",{className:`px-6 py-2 rounded-full transition-colors duration-200 ${x==="All"?"bg-white text-primary-700 font-semibold":"bg-white/20 text-white hover:bg-white/30"}`,children:x},x))})]})}),n.jsx("section",{className:"py-16 bg-white dark:bg-secondary-800",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsx("h2",{className:"text-3xl font-bold text-center text-secondary-900 dark:text-white mb-12",children:"Platform Statistics"}),u?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((x,C)=>n.jsxs("div",{className:"bg-secondary-100 dark:bg-secondary-700 rounded-lg p-6 animate-pulse",children:[n.jsx("div",{className:"h-4 bg-secondary-300 dark:bg-secondary-600 rounded mb-2"}),n.jsx("div",{className:"h-6 bg-secondary-300 dark:bg-secondary-600 rounded"})]},C))}):a?n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx(f,{icon:De,title:"Total Models",value:((w=a.overview)==null?void 0:w.totalModels)||0,description:"High-quality 3D assets"}),n.jsx(f,{icon:cn,title:"Active Creators",value:((g=a.overview)==null?void 0:g.totalUsers)||0,description:"Talented artists"}),n.jsx(f,{icon:de,title:"Downloads",value:((y=a.overview)==null?void 0:y.totalDownloads)||0,description:"Models downloaded"}),n.jsx(f,{icon:V,title:"Total Views",value:((N=a.overview)==null?void 0:N.totalViews)||0,description:"Page views"})]}):n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-4",children:"Failed to load statistics"}),n.jsx("button",{onClick:p,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200",children:"Refresh Page"})]})]})}),n.jsx("section",{className:"py-16 bg-secondary-50 dark:bg-secondary-900",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("h2",{className:"text-3xl font-bold text-secondary-900 dark:text-white flex items-center",children:[n.jsx(Ra,{className:"w-8 h-8 text-yellow-500 mr-3"}),"Featured Models"]}),n.jsx(L,{to:"/explore",className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-semibold flex items-center",children:"View All →"})]}),o?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((x,C)=>n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg p-4 animate-pulse",children:[n.jsx("div",{className:"h-48 bg-secondary-200 dark:bg-secondary-700 rounded-lg mb-4"}),n.jsx("div",{className:"h-4 bg-secondary-200 dark:bg-secondary-700 rounded mb-2"}),n.jsx("div",{className:"h-3 bg-secondary-200 dark:bg-secondary-700 rounded w-2/3"})]},C))}):r&&r.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(x=>n.jsx(ln,{model:x},x.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx(De,{className:"w-16 h-16 text-secondary-400 dark:text-secondary-500 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-secondary-600 dark:text-secondary-400 mb-2",children:"No featured models yet"}),n.jsx("p",{className:"text-secondary-500 dark:text-secondary-500 mb-6",children:"Be the first to upload an amazing 3D model!"}),n.jsx(L,{to:"/upload",className:"inline-flex items-center px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200 font-semibold",children:"Upload Model"})]})]})}),n.jsx("section",{className:"py-16 bg-white dark:bg-secondary-800",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("h2",{className:"text-3xl font-bold text-secondary-900 dark:text-white flex items-center",children:[n.jsx(Ht,{className:"w-8 h-8 text-green-500 mr-3"}),"Trending Models"]}),n.jsx(L,{to:"/explore",className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-semibold flex items-center",children:"View All →"})]}),c?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((x,C)=>n.jsxs("div",{className:"bg-secondary-50 dark:bg-secondary-900 rounded-lg p-4 animate-pulse",children:[n.jsx("div",{className:"h-48 bg-secondary-200 dark:bg-secondary-700 rounded-lg mb-4"}),n.jsx("div",{className:"h-4 bg-secondary-200 dark:bg-secondary-700 rounded mb-2"}),n.jsx("div",{className:"h-3 bg-secondary-200 dark:bg-secondary-700 rounded w-2/3"})]},C))}):t&&t.length>0?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(x=>n.jsx(ln,{model:x,compact:!0},x.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Ht,{className:"w-16 h-16 text-secondary-400 dark:text-secondary-500 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-secondary-600 dark:text-secondary-400 mb-2",children:"No trending models yet"}),n.jsx("p",{className:"text-secondary-500 dark:text-secondary-500 mb-6",children:"Popular models will appear here as users interact with them."})]})]})})]})},hu=()=>{const[r,e]=j.useState(""),[t,s]=j.useState(""),[a,i]=j.useState(!1),[o,l]=j.useState(""),{login:c,loading:d}=ee(),u=Ve(),h=async m=>{if(m.preventDefault(),!r||!t){l("Please fill in all fields");return}l("");const f=await c(r,t);if(f!=null&&f.success){u("/");return}l((f==null?void 0:f.message)||"Invalid email or password")};return n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs(L,{to:"/",className:"inline-flex items-center text-2xl font-bold text-primary-600 dark:text-primary-400 mb-2",children:[n.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg mr-2 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold",children:"3D"})}),"3Dsharespace"]}),n.jsx("h2",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Welcome back"}),n.jsx("p",{className:"mt-2 text-sm text-secondary-600 dark:text-secondary-400",children:"Sign in to your account to continue"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:h,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Email address"}),n.jsxs("div",{className:"relative",children:[n.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:r,onChange:m=>e(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Enter your email"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"password",name:"password",type:a?"text":"password",autoComplete:"current-password",required:!0,value:t,onChange:m=>s(m.target.value),className:"w-full pl-10 pr-12 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Enter your password"}),n.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary-400 hover:text-secondary-600 dark:hover:text-secondary-300",children:a?n.jsx(Ds,{className:"w-5 h-5"}):n.jsx(V,{className:"w-5 h-5"})})]})]})]}),o&&n.jsx("div",{className:"text-center",children:n.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg",children:o})}),n.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:d?n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:["Sign in",n.jsx(ar,{className:"ml-2 w-4 h-4"})]})}),n.jsxs("div",{className:"text-center space-y-2",children:[n.jsx(L,{to:"/forgot-password",className:"text-sm text-primary-600 dark:text-primary-400 hover:text-primary-500 dark:hover:text-primary-300",children:"Forgot your password?"}),n.jsxs("div",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:["Don't have an account?"," ",n.jsx(L,{to:"/signup",className:"text-primary-600 dark:text-primary-400 hover:text-primary-500 dark:hover:text-primary-300 font-medium",children:"Sign up"})]})]})]})]})})},fu=()=>{const[r,e]=j.useState({username:"",email:"",password:"",confirmPassword:"",displayName:"",bio:""}),[t,s]=j.useState(!1),[a,i]=j.useState(!1),[o,l]=j.useState(""),{signup:c,loading:d}=ee();Ve();const u=f=>{e({...r,[f.target.name]:f.target.value})},h=()=>!r.username||!r.email||!r.password||!r.confirmPassword?(l("Please fill in all required fields"),!1):r.password!==r.confirmPassword?(l("Passwords do not match"),!1):r.password.length<6?(l("Password must be at least 6 characters long"),!1):r.username.length<3?(l("Username must be at least 3 characters long"),!1):!0,m=async f=>{if(f.preventDefault(),!h())return;l("");const p=await c(r);p.success||l(p.error)};return n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs(L,{to:"/",className:"inline-flex items-center text-2xl font-bold text-primary-600 dark:text-primary-400 mb-2",children:[n.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg mr-2 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold",children:"3D"})}),"3Dsharespace"]}),n.jsx("h2",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Create your account"}),n.jsx("p",{className:"mt-2 text-sm text-secondary-600 dark:text-secondary-400",children:"Join our community of 3D creators"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:m,children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Username *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,value:r.username,onChange:u,className:"w-full pl-10 pr-4 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Choose a username"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Display Name"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"displayName",name:"displayName",type:"text",autoComplete:"name",value:r.displayName,onChange:u,className:"w-full pl-10 pr-4 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Your display name"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Email address *"}),n.jsxs("div",{className:"relative",children:[n.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:r.email,onChange:u,className:"w-full pl-10 pr-4 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Enter your email"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Password *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"password",name:"password",type:t?"text":"password",autoComplete:"new-password",required:!0,value:r.password,onChange:u,className:"w-full pl-10 pr-12 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Create a password"}),n.jsx("button",{type:"button",onClick:()=>s(!t),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary-400 hover:text-secondary-600 dark:hover:text-secondary-300",children:t?n.jsx(Ds,{className:"w-5 h-5"}):n.jsx(V,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Confirm Password *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:a?"text":"password",autoComplete:"new-password",required:!0,value:r.confirmPassword,onChange:u,className:"w-full pl-10 pr-12 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Confirm your password"}),n.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary-400 hover:text-secondary-600 dark:hover:text-secondary-300",children:a?n.jsx(Ds,{className:"w-5 h-5"}):n.jsx(V,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Bio"}),n.jsxs("div",{className:"relative",children:[n.jsx(dn,{className:"absolute left-3 top-3 w-5 h-5 text-secondary-400"}),n.jsx("textarea",{id:"bio",name:"bio",rows:"3",value:r.bio,onChange:u,className:"w-full pl-10 pr-4 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white resize-none",placeholder:"Tell us about yourself..."})]})]})]}),o&&n.jsx("div",{className:"text-center",children:n.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg",children:o})}),n.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:d?n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:["Create Account",n.jsx(ar,{className:"ml-2 w-4 h-4"})]})}),n.jsx("div",{className:"text-center",children:n.jsxs("div",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:["Already have an account?"," ",n.jsx(L,{to:"/login",className:"text-primary-600 dark:text-primary-400 hover:text-primary-500 dark:hover:text-primary-300 font-medium",children:"Sign in"})]})})]})]})})},mu=()=>n.jsxs("div",{className:"container mx-auto px-4 py-8",children:[n.jsx("h1",{className:"text-4xl font-bold text-secondary-900 dark:text-white mb-8",children:"Creator Dashboard"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Manage your 3D models, track performance, and view earnings analytics."}),n.jsx("p",{className:"mt-4 text-sm text-secondary-500 dark:text-secondary-400",children:"Dashboard with charts, model management, and analytics will be implemented here."})]}),pu=()=>n.jsxs("div",{className:"container mx-auto px-4 py-8",children:[n.jsx("h1",{className:"text-4xl font-bold text-secondary-900 dark:text-white mb-8",children:"Explore 3D Models"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Search and discover amazing 3D models from talented creators around the world."}),n.jsx("p",{className:"mt-4 text-sm text-secondary-500 dark:text-secondary-400",children:"Explore page with search, filters, and model grid will be implemented here."})]}),xu=()=>{const{user:r,profile:e,isAuthenticated:t}=ee(),s=Ve(),a=j.useRef(null),i=j.useRef(null),o=j.useRef(null),[l,c]=j.useState(!1),[d,u]=j.useState(0),[h,m]=j.useState({title:"",description:"",category:"Characters",tags:"",price:0,isFree:!0}),[f,p]=j.useState({model:null,thumbnail:null,preview:null}),[w,g]=j.useState(!1),[y,N]=j.useState({}),x=j.useCallback(b=>{b.preventDefault(),b.stopPropagation(),b.type==="dragenter"||b.type==="dragover"?g(!0):b.type==="dragleave"&&g(!1)},[]),C=j.useCallback(b=>{b.preventDefault(),b.stopPropagation(),g(!1),b.dataTransfer.files&&b.dataTransfer.files[0]&&P(b.dataTransfer.files[0],"model")},[]);if(!t)return n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-4",children:"Authentication Required"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"You need to be logged in to upload 3D models."}),n.jsx("button",{onClick:()=>s("/login"),className:"btn-primary",children:"Sign In"})]})});const P=(b,k)=>{console.log("🔍 File selected:",b.name,"Type:",k,"Size:",(b.size/1024/1024).toFixed(2),"MB");const D=["obj","fbx","glb","gltf","dae","blend","3ds","max","ma","mb"],$=["jpg","jpeg","png","webp","gif"],E=b.name.split(".").pop().toLowerCase();if(console.log("🔍 File extension:",E),k==="model"){if(!D.includes(E)){console.error("❌ Invalid model file type:",E),O.error(`Invalid model file type. Allowed: ${D.join(", ")}`);return}if(b.size>100*1024*1024){console.error("❌ File too large:",(b.size/1024/1024).toFixed(2),"MB"),O.error("Model file size must be less than 100MB");return}console.log("✅ Model file validation passed")}else if(k==="thumbnail"||k==="preview"){if(!$.includes(E)){console.error("❌ Invalid image file type:",E),O.error(`Invalid image file type. Allowed: ${$.join(", ")}`);return}if(b.size>10*1024*1024){console.error("❌ Image file too large:",(b.size/1024/1024).toFixed(2),"MB"),O.error("Image file size must be less than 10MB");return}console.log("✅ Image file validation passed")}p(I=>({...I,[k]:b})),N(I=>({...I,[k]:null})),console.log("✅ File set successfully")},S=b=>{const{name:k,value:D,type:$,checked:E}=b.target;m(I=>({...I,[k]:$==="checkbox"?E:D})),N(I=>({...I,[k]:null}))},_=()=>{const b={};return h.title.trim()||(b.title="Title is required"),h.description.trim()||(b.description="Description is required"),h.category||(b.category="Category is required"),f.model||(b.model="3D model file is required"),N(b),Object.keys(b).length===0},R=async b=>{if(b.preventDefault(),console.log("🎯 Form submitted, starting validation..."),!_()){console.log("❌ Form validation failed"),O.error("Please fix the errors before submitting");return}console.log("✅ Form validation passed, starting upload..."),c(!0),u(0);try{console.log("🚀 Starting upload process..."),console.log("User ID:",r.id),console.log("File:",f.model),console.log("Form data:",h),console.log("🔍 Testing Supabase connection...");const{data:k,error:D}=await T.from("models").select("count").limit(1);if(D)throw console.error("❌ Database connection failed:",D),new Error(`Database connection failed: ${D.message}`);console.log("✅ Database connection successful"),console.log("🔍 Testing storage access...");const{data:$,error:E}=await T.storage.from("models").list("",{limit:1});if(E)throw console.error("❌ Storage access failed:",E),new Error(`Storage access failed: ${E.message}`);console.log("✅ Storage access successful"),u(10),console.log("📤 Uploading model file...");const I=`${Date.now()}_${f.model.name}`;console.log("Model filename:",I),console.log("File size:",(f.model.size/1024/1024).toFixed(2),"MB");const z=T.storage.from("models").upload(I,f.model),le=new Promise((Qe,gs)=>{setTimeout(()=>gs(new Error("Upload timeout after 30 seconds")),3e4)}),{data:ie,error:J}=await Promise.race([z,le]);if(J)throw console.error("❌ Model upload failed:",J),J;console.log("✅ Model upload successful:",ie),u(30);const{data:{publicUrl:ye}}=T.storage.from("models").getPublicUrl(I);console.log("Model URL:",ye);let ce=null;if(f.thumbnail){console.log("📤 Uploading thumbnail...");const Qe=`${Date.now()}_${f.thumbnail.name}`,{data:gs,error:ut}=await T.storage.from("thumbnails").upload(Qe,f.thumbnail);if(ut)throw ut;const{data:{publicUrl:ys}}=T.storage.from("thumbnails").getPublicUrl(Qe);ce=ys,console.log("✅ Thumbnail upload successful")}u(60);let Ee=null;if(f.preview){console.log("📤 Uploading preview...");const Qe=`${Date.now()}_${f.preview.name}`,{data:gs,error:ut}=await T.storage.from("previews").upload(Qe,f.preview);if(ut)throw ut;const{data:{publicUrl:ys}}=T.storage.from("previews").getPublicUrl(Qe);Ee=ys,console.log("✅ Preview upload successful")}u(80),console.log("💾 Creating database record...");const oe={title:h.title,description:h.description,category:h.category,tags:h.tags,file_url:ye,thumbnail_url:ce,preview_url:Ee,file_size:f.model.size,file_type:f.model.name.split(".").pop().toLowerCase(),user_id:r.id,is_featured:!1};console.log("Model record data:",oe),console.log("Model record data (JSON):",JSON.stringify(oe,null,2)),console.log("🔍 Field validation:"),console.log("- title:",!!oe.title,"value:",oe.title),console.log("- description:",!!oe.description,"value:",oe.description),console.log("- category:",!!oe.category,"value:",oe.category),console.log("- file_url:",!!oe.file_url,"value:",oe.file_url),console.log("- user_id:",!!oe.user_id,"value:",oe.user_id);const{data:xr,error:Ue}=await T.from("models").insert(oe).select().single();if(Ue)throw console.error("❌ Database insert failed:",Ue),console.error("❌ Error details:",{message:Ue.message,details:Ue.details,hint:Ue.hint,code:Ue.code}),Ue;console.log("✅ Database record created:",xr),u(100),O.success("3D model uploaded successfully!"),s(`/models/${xr.id}`)}catch(k){console.error("❌ Upload error:",k),O.error(k.message||"Failed to upload model")}finally{console.log("🏁 Upload process finished (success or failure)"),c(!1),u(0)}},A=b=>{p(k=>({...k,[b]:null})),N(k=>({...k,[b]:null}))};return n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white mb-2",children:"Upload 3D Model"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Share your 3D models with the community. Upload files, add descriptions, and set categories."}),n.jsxs("div",{className:"mt-4 flex space-x-2",children:[n.jsx("button",{type:"button",onClick:async()=>{try{console.log("🧪 Testing Supabase connection...");const{data:b,error:k}=await T.from("models").select("count").limit(1);k?(console.error("❌ Test failed:",k),O.error(`Test failed: ${k.message}`)):(console.log("✅ Test successful:",b),O.success("Supabase connection working!"))}catch(b){console.error("❌ Test error:",b),O.error(`Test error: ${b.message}`)}},className:"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 text-sm",children:"🧪 Test Supabase Connection"}),n.jsx("button",{type:"button",onClick:async()=>{try{console.log("🧪 Testing storage access...");const{data:b,error:k}=await T.storage.from("models").list("",{limit:1});k?(console.error("❌ Storage test failed:",k),O.error(`Storage test failed: ${k.message}`)):(console.log("✅ Storage test successful:",b),O.success("Storage access working!"))}catch(b){console.error("❌ Storage test error:",b),O.error(`Storage test error: ${b.message}`)}},className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 text-sm",children:"🧪 Test Storage Access"}),n.jsx("button",{type:"button",onClick:async()=>{try{console.log("🧪 Testing file upload...");const b="test content for upload",k=new Blob([b],{type:"text/plain"});if(typeof gr<"u"){const D=new gr([k],"test.txt",{type:"text/plain"});console.log("Test file created:",D);const{data:$,error:E}=await T.storage.from("models").upload(`test_${Date.now()}.txt`,D);E?(console.error("❌ File upload test failed:",E),O.error(`Upload test failed: ${E.message}`)):(console.log("✅ File upload test successful:",$),O.success("File upload working!"),await T.storage.from("models").remove([$.path]))}else{console.log("File constructor not available, using Blob directly");const{data:D,error:$}=await T.storage.from("models").upload(`test_${Date.now()}.txt`,k,{contentType:"text/plain"});$?(console.error("❌ Blob upload test failed:",$),O.error(`Blob upload test failed: ${$.message}`)):(console.log("✅ Blob upload test successful:",D),O.success("Blob upload working!"),await T.storage.from("models").remove([D.path]))}}catch(b){console.error("❌ File upload test error:",b),O.error(`Upload test error: ${b.message}`)}},className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 text-sm",children:"🧪 Test File Upload"}),n.jsx("button",{type:"button",onClick:async()=>{try{console.log("🧪 Testing database schema...");const{data:b,error:k}=await T.from("models").select("*").limit(0);if(k)console.error("❌ Schema test failed:",k),O.error(`Schema test failed: ${k.message}`);else{console.log("✅ Schema test successful"),console.log("Table structure:",b);const{data:D,error:$}=await T.rpc("get_table_columns",{table_name:"models"}).catch(()=>({data:null,error:"RPC not available"}));if(D)console.log("Table columns:",D);else{console.log("RPC not available, trying direct query...");const E={title:"Test Model",description:"Test Description",category:"Props",file_url:"https://example.com/test.glb",user_id:r.id},{error:I}=await T.from("models").insert(E);I?console.log("Test insert error:",I):(console.log("Test insert successful"),await T.from("models").delete().eq("title","Test Model"))}}}catch(b){console.error("❌ Schema test error:",b),O.error(`Schema test error: ${b.message}`)}},className:"bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 text-sm",children:"🧪 Test Database Schema"}),n.jsx("button",{type:"button",onClick:async()=>{try{console.log("🧪 Testing minimal insert...");const b={title:"Test",description:"Test",category:"Props",file_url:"https://example.com/test.glb",user_id:r.id};console.log("Trying to insert:",b);const{data:k,error:D}=await T.from("models").insert(b).select();D?(console.error("❌ Minimal insert failed:",D),console.error("Error details:",{message:D.message,details:D.details,hint:D.hint,code:D.code})):(console.log("✅ Minimal insert successful:",k),await T.from("models").delete().eq("id",k[0].id))}catch(b){console.error("❌ Structure test error:",b)}},className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 text-sm",children:"🧪 Test Minimal Insert"})]})]}),n.jsxs("form",{onSubmit:R,className:"space-y-8",children:[n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Model Files"}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:["3D Model File * ",n.jsx("span",{className:"text-red-500",children:"Required"})]}),n.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${w?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-secondary-300 dark:border-secondary-600"}`,onDragEnter:x,onDragLeave:x,onDragOver:x,onDrop:C,children:f.model?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2 text-green-600",children:[n.jsx(Zt,{className:"w-6 h-6"}),n.jsx("span",{className:"font-medium",children:f.model.name})]}),n.jsxs("p",{className:"text-sm text-secondary-500",children:["Size: ",(f.model.size/1024/1024).toFixed(2)," MB"]}),n.jsx("button",{type:"button",onClick:()=>A("model"),className:"text-red-600 hover:text-red-700 text-sm",children:"Remove File"})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsx(Z,{className:"w-12 h-12 text-secondary-400 mx-auto"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-lg font-medium text-secondary-900 dark:text-white",children:"Drop your 3D model here"}),n.jsx("p",{className:"text-sm text-secondary-500",children:"or click to browse files"})]}),n.jsx("button",{type:"button",onClick:()=>{var b;return(b=a.current)==null?void 0:b.click()},className:"btn-primary",children:"Choose File"}),n.jsx("input",{ref:a,type:"file",accept:".obj,.fbx,.glb,.gltf,.dae,.blend,.3ds,.max,.ma,.mb",onChange:b=>{var k;return((k=b.target.files)==null?void 0:k[0])&&P(b.target.files[0],"model")},className:"hidden"}),n.jsx("p",{className:"text-xs text-secondary-400",children:"Supported formats: OBJ, FBX, GLB, GLTF, DAE, BLEND, 3DS, MAX, MA, MB (Max 100MB)"})]})}),y.model&&n.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),y.model]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Thumbnail Image (Optional)"}),n.jsx("div",{className:"border-2 border-dashed border-secondary-300 dark:border-secondary-600 rounded-lg p-6 text-center",children:f.thumbnail?n.jsxs("div",{className:"space-y-4",children:[n.jsx("img",{src:URL.createObjectURL(f.thumbnail),alt:"Thumbnail preview",className:"w-32 h-32 object-cover rounded mx-auto"}),n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("span",{className:"text-sm text-secondary-600",children:f.thumbnail.name}),n.jsx("button",{type:"button",onClick:()=>A("thumbnail"),className:"text-red-600 hover:text-red-700",children:n.jsx(yr,{className:"w-4 h-4"})})]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsx(br,{className:"w-8 h-8 text-secondary-400 mx-auto"}),n.jsx("button",{type:"button",onClick:()=>{var b;return(b=i.current)==null?void 0:b.click()},className:"btn-secondary",children:"Choose Thumbnail"}),n.jsx("input",{ref:i,type:"file",accept:"image/*",onChange:b=>{var k;return((k=b.target.files)==null?void 0:k[0])&&P(b.target.files[0],"thumbnail")},className:"hidden"})]})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Preview Image (Optional)"}),n.jsx("div",{className:"border-2 border-dashed border-secondary-300 dark:border-secondary-600 rounded-lg p-6 text-center",children:f.preview?n.jsxs("div",{className:"space-y-4",children:[n.jsx("img",{src:URL.createObjectURL(f.preview),alt:"Preview",className:"w-32 h-32 object-cover rounded mx-auto"}),n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("span",{className:"text-sm text-secondary-600",children:f.preview.name}),n.jsx("button",{type:"button",onClick:()=>A("preview"),className:"text-red-600 hover:text-red-700",children:n.jsx(yr,{className:"w-4 h-4"})})]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsx(br,{className:"w-8 h-8 text-secondary-400 mx-auto"}),n.jsx("button",{type:"button",onClick:()=>{var b;return(b=o.current)==null?void 0:b.click()},className:"btn-secondary",children:"Choose Preview"}),n.jsx("input",{ref:o,type:"file",accept:"image/*",onChange:b=>{var k;return((k=b.target.files)==null?void 0:k[0])&&P(b.target.files[0],"preview")},className:"hidden"})]})})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Model Information"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Title *"}),n.jsx("input",{type:"text",id:"title",name:"title",value:h.title,onChange:S,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Enter model title"}),y.title&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.title})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Description *"}),n.jsx("textarea",{id:"description",name:"description",rows:"4",value:h.description,onChange:S,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Describe your 3D model..."}),y.description&&n.jsx("p",{className:"mt-1 text-sm text-red-600",children:y.description})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Category *"}),n.jsxs("select",{id:"category",name:"category",value:h.category,onChange:S,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",children:[n.jsx("option",{value:"Characters",children:"Characters"}),n.jsx("option",{value:"Environments",children:"Environments"}),n.jsx("option",{value:"Props",children:"Props"}),n.jsx("option",{value:"Vehicles",children:"Vehicles"}),n.jsx("option",{value:"Weapons",children:"Weapons"}),n.jsx("option",{value:"Architecture",children:"Architecture"}),n.jsx("option",{value:"Nature",children:"Nature"}),n.jsx("option",{value:"Sci-Fi",children:"Sci-Fi"}),n.jsx("option",{value:"Fantasy",children:"Fantasy"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Tags"}),n.jsx("input",{type:"text",id:"tags",name:"tags",value:h.tags,onChange:S,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"tag1, tag2, tag3"}),n.jsx("p",{className:"mt-1 text-xs text-secondary-500",children:"Separate tags with commas"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("div",{className:"flex items-center space-x-4",children:n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",name:"isFree",checked:h.isFree,onChange:S,className:"mr-2"}),n.jsx("span",{className:"text-sm text-secondary-700 dark:text-secondary-300",children:"This model is free"})]})}),!h.isFree&&n.jsxs("div",{className:"mt-4",children:[n.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Price ($)"}),n.jsx("input",{type:"number",id:"price",name:"price",value:h.price,onChange:S,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"0.00"})]})]})]})]}),l&&n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[n.jsx(me,{className:"w-6 h-6 text-primary-600 animate-spin"}),n.jsx("span",{className:"text-lg font-medium text-secondary-900 dark:text-white",children:"Uploading your 3D model..."})]}),n.jsx("div",{className:"w-full bg-secondary-200 dark:bg-secondary-700 rounded-full h-2",children:n.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${d}%`}})}),n.jsxs("p",{className:"mt-2 text-sm text-secondary-600 dark:text-secondary-400",children:[d,"% complete"]})]}),n.jsxs("div",{className:"flex justify-end space-x-4",children:[n.jsx("button",{type:"button",onClick:()=>s("/"),className:"btn-secondary",disabled:l,children:"Cancel"}),n.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?n.jsxs(n.Fragment,{children:[n.jsx(me,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Z,{className:"w-4 h-4 mr-2"}),"Upload Model"]})})]})]})]})},gu=()=>{const[r,e]=j.useState(""),[t,s]=j.useState(""),[a,i]=j.useState(!1),{forgotPassword:o,loading:l}=ee(),c=async d=>{if(d.preventDefault(),!r){s("Please enter your email address");return}s(""),i(!1);const u=await o(r);u.success?i(!0):s(u.error)};return a?n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs(L,{to:"/",className:"inline-flex items-center text-2xl font-bold text-primary-600 dark:text-primary-400 mb-2",children:[n.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg mr-2 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold",children:"3D"})}),"3Dsharespace"]}),n.jsx("h2",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Check your email"}),n.jsxs("p",{className:"mt-2 text-sm text-secondary-600 dark:text-secondary-400",children:["We've sent a password reset link to ",n.jsx("strong",{children:r})]})]}),n.jsxs("div",{className:"text-center space-y-4",children:[n.jsx("div",{className:"text-center",children:n.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 px-4 py-2 rounded-lg",children:"Password reset link sent successfully!"})}),n.jsxs(L,{to:"/login",className:"inline-flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-500 dark:hover:text-primary-300",children:[n.jsx(wt,{className:"mr-2 w-4 h-4"}),"Back to login"]})]})]})}):n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs(L,{to:"/",className:"inline-flex items-center text-2xl font-bold text-primary-600 dark:text-primary-400 mb-2",children:[n.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg mr-2 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold",children:"3D"})}),"3Dsharespace"]}),n.jsx("h2",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Reset your password"}),n.jsx("p",{className:"mt-2 text-sm text-secondary-600 dark:text-secondary-400",children:"Enter your email address and we'll send you a link to reset your password"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:c,children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Email address"}),n.jsxs("div",{className:"relative",children:[n.jsx(nr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:r,onChange:d=>e(d.target.value),className:"w-full pl-10 pr-4 py-3 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-800 dark:text-white",placeholder:"Enter your email"})]})]}),t&&n.jsx("div",{className:"text-center",children:n.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 px-4 py-2 rounded-lg",children:t})}),n.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:l?n.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsxs(n.Fragment,{children:["Send reset link",n.jsx(ar,{className:"ml-2 w-4 h-4"})]})}),n.jsx("div",{className:"text-center",children:n.jsx(L,{to:"/login",className:"text-sm text-primary-600 dark:text-primary-400 hover:text-primary-500 dark:hover:text-primary-300",children:"Back to login"})})]})]})})},yu=()=>{const{username:r}=ir(),{user:e,profile:t}=ee(),[s,a]=j.useState(null),[i,o]=j.useState([]),[l,c]=j.useState(!0),[d,u]=j.useState("models");j.useEffect(()=>{h()},[r]);const h=async()=>{try{c(!0);const{data:p,error:w}=await T.from("profiles").select("*").eq("username",r).single();if(w)throw w;a(p);const{data:g,error:y}=await T.from("models").select("*").eq("user_id",p.id).order("created_at",{ascending:!1});if(y)throw y;o(g||[])}catch(p){console.error("Error fetching profile:",p),O.error("Failed to load profile")}finally{c(!1)}},m=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),f=e&&s&&e.id===s.id;return l?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),n.jsx("p",{className:"text-secondary-600",children:"Loading profile..."})]})}):s?n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-primary-800 text-white rounded-lg p-8 mb-8",children:n.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center space-y-4 md:space-y-0 md:space-x-6",children:[n.jsx("div",{className:"relative",children:n.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-full overflow-hidden bg-white/20 border-4 border-white/30",children:s.avatar_url?n.jsx("img",{src:s.avatar_url,alt:s.username,className:"w-full h-full object-cover"}):n.jsx(Ne,{className:"w-full h-full p-6 text-white/80"})})}),n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:s.username}),s.bio&&n.jsx("p",{className:"text-lg text-white/90 mb-4 max-w-2xl",children:s.bio}),n.jsxs("div",{className:"flex flex-wrap items-center space-x-6 text-white/80",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Z,{className:"w-4 h-4"}),n.jsxs("span",{children:[i.length," Models"]})]}),s.location&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Da,{className:"w-4 h-4"}),n.jsx("span",{children:s.location})]}),s.created_at&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(at,{className:"w-4 h-4"}),n.jsxs("span",{children:["Joined ",m(s.created_at)]})]})]})]}),n.jsx("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 mt-4 md:mt-0",children:f?n.jsxs(n.Fragment,{children:[n.jsxs(L,{to:"/profile/edit",className:"btn-secondary bg-white/20 hover:bg-white/30 text-white border-white/30",children:[n.jsx(Bt,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),n.jsxs(L,{to:"/upload",className:"btn-primary bg-white text-primary-600 hover:bg-white/90",children:[n.jsx(Z,{className:"w-4 h-4 mr-2"}),"Upload Model"]})]}):n.jsxs("button",{className:"btn-secondary bg-white/20 hover:bg-white/30 text-white border-white/30",children:[n.jsx(_e,{className:"w-4 h-4 mr-2"}),"Follow"]})})]})})]})}),(s.website||s.twitter||s.instagram||s.linkedin||s.github)&&n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6 mb-8",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Connect"}),n.jsxs("div",{className:"flex flex-wrap items-center space-x-4",children:[s.website&&n.jsxs("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-secondary-600 dark:text-secondary-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[n.jsx($a,{className:"w-5 h-5"}),n.jsx("span",{children:"Website"})]}),s.twitter&&n.jsxs("a",{href:`https://twitter.com/${s.twitter.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-secondary-600 dark:text-secondary-400 hover:text-blue-500 transition-colors",children:[n.jsx(un,{className:"w-5 h-5"}),n.jsx("span",{children:s.twitter})]}),s.instagram&&n.jsxs("a",{href:`https://instagram.com/${s.instagram.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-secondary-600 dark:text-secondary-400 hover:text-pink-500 transition-colors",children:[n.jsx(hn,{className:"w-5 h-5"}),n.jsx("span",{children:s.instagram})]}),s.linkedin&&n.jsxs("a",{href:s.linkedin,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-secondary-600 dark:text-secondary-400 hover:text-blue-600 transition-colors",children:[n.jsx(fn,{className:"w-5 h-5"}),n.jsx("span",{children:"LinkedIn"})]}),s.github&&n.jsxs("a",{href:`https://github.com/${s.github}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-secondary-600 dark:text-secondary-400 hover:text-gray-800 dark:hover:text-white transition-colors",children:[n.jsx(mn,{className:"w-5 h-5"}),n.jsx("span",{children:s.github})]})]})]}),(s.skills||s.experience||s.education||s.interests)&&n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6 mb-8",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Professional Information"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.skills&&n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-secondary-900 dark:text-white mb-2",children:"Skills & Expertise"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:s.skills})]}),s.experience&&n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-secondary-900 dark:text-white mb-2",children:"Experience"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:s.experience})]}),s.education&&n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-secondary-900 dark:text-white mb-2",children:"Education & Training"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:s.education})]}),s.interests&&n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-secondary-900 dark:text-white mb-2",children:"Interests & Specializations"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:s.interests})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700",children:[n.jsx("div",{className:"border-b border-secondary-200 dark:border-secondary-700",children:n.jsxs("div",{className:"flex space-x-8 px-6",children:[n.jsxs("button",{onClick:()=>u("models"),className:`py-4 px-2 border-b-2 font-medium transition-colors ${d==="models"?"border-primary-500 text-primary-600":"border-transparent text-secondary-500 hover:text-secondary-700 dark:hover:text-secondary-300"}`,children:["Models (",i.length,")"]}),n.jsx("button",{onClick:()=>u("liked"),className:`py-4 px-2 border-b-2 font-medium transition-colors ${d==="liked"?"border-primary-500 text-primary-600":"border-transparent text-secondary-500 hover:text-secondary-700 dark:hover:text-secondary-300"}`,children:"Liked"})]})}),n.jsxs("div",{className:"p-6",children:[d==="models"&&n.jsx("div",{children:i.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Z,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-secondary-900 dark:text-white mb-2",children:"No models yet"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:f?"Start building your portfolio by uploading your first 3D model!":"This creator hasn't uploaded any models yet."}),f&&n.jsxs(L,{to:"/upload",className:"btn-primary",children:[n.jsx(Z,{className:"w-4 h-4 mr-2"}),"Upload Your First Model"]})]}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(p=>n.jsxs("div",{className:"bg-white dark:bg-secondary-700 rounded-lg border border-secondary-200 dark:border-secondary-600 overflow-hidden hover:shadow-lg transition-shadow",children:[n.jsx("div",{className:"aspect-video bg-secondary-100 dark:bg-secondary-600",children:p.thumbnail_url?n.jsx("img",{src:p.thumbnail_url,alt:p.title,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Z,{className:"w-12 h-12 text-secondary-400"})})}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-2 line-clamp-2",children:p.title}),n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 mb-3 line-clamp-2",children:p.description}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200 rounded-full",children:p.category}),n.jsxs("div",{className:"flex items-center space-x-3 text-sm text-secondary-500",children:[n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(V,{className:"w-4 h-4"}),n.jsx("span",{children:"0"})]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(_e,{className:"w-4 h-4"}),n.jsx("span",{children:"0"})]})]})]})]}),n.jsx(L,{to:`/models/${p.id}`,className:"block p-4 bg-secondary-50 dark:bg-secondary-600 text-center text-sm font-medium text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-500 transition-colors",children:"View Details"})]},p.id))})}),d==="liked"&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx(_e,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-secondary-900 dark:text-white mb-2",children:"Liked models"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:f?"Models you've liked will appear here.":"Liked models will appear here."})]})]})]})]}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-4",children:"Profile Not Found"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"The profile you're looking for doesn't exist."}),n.jsx(L,{to:"/",className:"btn-primary",children:"Go Home"})]})})},bu=()=>{const{user:r,profile:e,fetchUserProfile:t}=ee(),s=Ve(),a=j.useRef(null),[i,o]=j.useState(!1),[l,c]=j.useState(!1),[d,u]=j.useState({}),[h,m]=j.useState({username:"",bio:"",website:"",twitter:"",instagram:"",linkedin:"",github:"",location:"",skills:"",experience:"",education:"",interests:""}),[f,p]=j.useState(null),[w,g]=j.useState("");j.useEffect(()=>{if(e){console.log("🔄 Loading profile data:",e);const S={username:e.username||"",bio:e.bio||"",website:e.website||"",twitter:e.twitter||"",instagram:e.instagram||"",linkedin:e.linkedin||"",github:e.github||"",location:e.location||"",skills:e.skills||"",experience:e.experience||"",education:e.education||"",interests:e.interests||""};console.log("📝 Setting form data:",S),m(S),e.avatar_url&&g(e.avatar_url)}else console.log("⚠️ No profile data available")},[e]);const y=(e==null?void 0:e.id)||"no-profile",N=S=>{const{name:_,value:R}=S.target;m(A=>({...A,[_]:R})),u(A=>({...A,[_]:null}))},x=S=>{if(S){if(S.size>5*1024*1024){O.error("Avatar image must be less than 5MB");return}if(!["image/jpeg","image/png","image/webp"].includes(S.type)){O.error("Please select a JPEG, PNG, or WebP image");return}p(S),g(URL.createObjectURL(S)),u(R=>({...R,avatar:null}))}},C=()=>{const S={};return h.username.trim()?h.username.length<3?S.username="Username must be at least 3 characters":h.username.length>30&&(S.username="Username must be less than 30 characters"):S.username="Username is required",h.bio&&h.bio.length>500&&(S.bio="Bio must be less than 500 characters"),u(S),Object.keys(S).length===0},P=async S=>{if(S.preventDefault(),!C()){O.error("Please fix the errors before saving");return}c(!0);try{let _=(e==null?void 0:e.avatar_url)||null;if(f){console.log("📤 Uploading avatar...");const k=`avatar_${r.id}_${Date.now()}.${f.name.split(".").pop()}`,{data:D,error:$}=await T.storage.from("avatars").upload(k,f);if($)throw $;const{data:{publicUrl:E}}=T.storage.from("avatars").getPublicUrl(k);_=E,console.log("✅ Avatar upload successful")}console.log("💾 Updating profile...");const{data:R,error:A}=await T.from("profiles").update({username:h.username,bio:h.bio,website:h.website,twitter:h.twitter,instagram:h.instagram,linkedin:h.linkedin,github:h.github,location:h.location,skills:h.skills,experience:h.experience,education:h.education,interests:h.interests,avatar_url:_,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(A)throw A;console.log("✅ Profile updated successfully"),O.success("Profile updated successfully!");const b=h.username;await t(),m({username:"",bio:"",website:"",twitter:"",instagram:"",linkedin:"",github:"",location:"",skills:"",experience:"",education:"",interests:""}),await new Promise(k=>setTimeout(k,200)),s(`/profile/${b}`)}catch(_){console.error("❌ Profile update failed:",_),O.error(_.message||"Failed to update profile")}finally{c(!1)}};return n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[n.jsxs("button",{onClick:()=>s(-1),className:"btn-secondary",children:[n.jsx(wt,{className:"w-4 h-4 mr-2"}),"Back"]}),n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Edit Profile"}),n.jsx("button",{onClick:()=>t(),className:"btn-secondary text-sm",children:"🔄 Refresh Profile"})]}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Customize your creator profile to showcase your work and connect with the community."})]}),n.jsxs("form",{onSubmit:P,className:"space-y-8",children:[n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Profile Picture"}),n.jsxs("div",{className:"flex items-center space-x-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-secondary-200 dark:bg-secondary-700",children:w?n.jsx("img",{src:w,alt:"Avatar preview",className:"w-full h-full object-cover"}):n.jsx(Ne,{className:"w-full h-full p-4 text-secondary-400"})}),n.jsx("button",{type:"button",onClick:()=>{var S;return(S=a.current)==null?void 0:S.click()},className:"absolute -bottom-2 -right-2 bg-primary-600 text-white p-2 rounded-full hover:bg-primary-700 transition-colors",children:n.jsx($s,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("button",{type:"button",onClick:()=>{var S;return(S=a.current)==null?void 0:S.click()},className:"btn-secondary",children:"Choose Image"}),n.jsx("p",{className:"text-sm text-secondary-500 mt-2",children:"Recommended: Square image, 400x400px or larger. Max 5MB."}),n.jsx("input",{ref:a,type:"file",accept:"image/*",onChange:S=>{var _;return x((_=S.target.files)==null?void 0:_[0])},className:"hidden"})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Username *"}),n.jsx("input",{type:"text",id:"username",name:"username",value:h.username,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Enter your username"}),d.username&&n.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),d.username]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Bio"}),n.jsx("textarea",{id:"bio",name:"bio",rows:"4",value:h.bio,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Tell us about yourself, your skills, and what you create..."}),n.jsxs("p",{className:"mt-1 text-sm text-secondary-500",children:[h.bio.length,"/500 characters"]}),d.bio&&n.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),d.bio]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Location"}),n.jsx("input",{type:"text",id:"location",name:"location",value:h.location,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"City, Country"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"website",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Website"}),n.jsx("input",{type:"url",id:"website",name:"website",value:h.website,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"https://yourwebsite.com"})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Social Media & Links"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"twitter",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Twitter"}),n.jsxs("div",{className:"relative",children:[n.jsx(un,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{type:"text",id:"twitter",name:"twitter",value:h.twitter,onChange:N,className:"w-full pl-10 pr-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"@username"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"instagram",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Instagram"}),n.jsxs("div",{className:"relative",children:[n.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{type:"text",id:"instagram",name:"instagram",value:h.instagram,onChange:N,className:"w-full pl-10 pr-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"@username"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"linkedin",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"LinkedIn"}),n.jsxs("div",{className:"relative",children:[n.jsx(fn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{type:"url",id:"linkedin",name:"linkedin",value:h.linkedin,onChange:N,className:"w-full pl-10 pr-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"https://linkedin.com/in/username"})]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"github",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"GitHub"}),n.jsxs("div",{className:"relative",children:[n.jsx(mn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{type:"text",id:"github",name:"github",value:h.github,onChange:N,className:"w-full pl-10 pr-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"username"})]})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4",children:"Professional Information"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"skills",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Skills & Expertise"}),n.jsx("textarea",{id:"skills",name:"skills",rows:"3",value:h.skills,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"3D modeling, texturing, animation, game development..."}),n.jsx("p",{className:"mt-1 text-sm text-secondary-500",children:"List your key skills and areas of expertise"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"experience",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Experience"}),n.jsx("textarea",{id:"experience",name:"experience",rows:"3",value:h.experience,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Years of experience, notable projects, companies worked with..."})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"education",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Education & Training"}),n.jsx("textarea",{id:"education",name:"education",rows:"3",value:h.education,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Degrees, certifications, courses, workshops..."})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{htmlFor:"interests",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Interests & Specializations"}),n.jsx("textarea",{id:"interests",name:"interests",rows:"3",value:h.interests,onChange:N,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Specific areas you're passionate about, favorite styles, genres..."})]})]})]}),n.jsxs("div",{className:"flex justify-end space-x-4",children:[n.jsx("button",{type:"button",onClick:()=>s(-1),className:"btn-secondary",disabled:l,children:"Cancel"}),n.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?n.jsxs(n.Fragment,{children:[n.jsx(me,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(pn,{className:"w-4 h-4 mr-2"}),"Save Profile"]})})]})]})]},y)},vu=()=>{const{user:r,profile:e}=ee(),t=Ve(),[s,a]=j.useState([]),[i,o]=j.useState(!0),[l,c]=j.useState(""),[d,u]=j.useState("all"),[h,m]=j.useState("grid"),[f,p]=j.useState(null);j.useEffect(()=>{r&&w()},[r]);const w=async()=>{try{o(!0);const{data:x,error:C}=await T.from("models").select(`
          *,
          creator:profiles!models_user_id_fkey(username, avatar_url)
        `).eq("user_id",r.id).order("created_at",{ascending:!1});if(C)throw C;a(x||[]),console.log("📦 User models loaded:",x)}catch(x){console.error("❌ Error fetching models:",x),O.error("Failed to load your models")}finally{o(!1)}},g=s.filter(x=>{const C=x.title.toLowerCase().includes(l.toLowerCase())||x.description.toLowerCase().includes(l.toLowerCase())||x.tags.toLowerCase().includes(l.toLowerCase()),P=d==="all"||x.category===d;return C&&P}),y=async(x,C)=>{if(confirm(`Are you sure you want to delete "${C}"? This action cannot be undone.`))try{p(x);const{error:P}=await T.storage.from("models").remove([`${r.id}/${x}.obj`]);P&&P.code!=="PGRST116"&&console.warn("Storage deletion warning:",P);const{error:S}=await T.storage.from("thumbnails").remove([`${r.id}/${x}.jpg`]);S&&S.code!=="PGRST116"&&console.warn("Thumbnail deletion warning:",S);const{error:_}=await T.storage.from("previews").remove([`${r.id}/${x}.jpg`]);_&&_.code!=="PGRST116"&&console.warn("Preview deletion warning:",_);const{error:R}=await T.from("models").delete().eq("id",x);if(R)throw R;O.success("Model deleted successfully"),await w()}catch(P){console.error("❌ Error deleting model:",P),O.error("Failed to delete model")}finally{p(null)}},N=["all",...new Set(s.map(x=>x.category).filter(Boolean))];return r?n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("button",{onClick:()=>t(-1),className:"btn-secondary",children:[n.jsx(wt,{className:"w-4 h-4 mr-2"}),"Back"]}),n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Model Management"})]}),n.jsxs("button",{onClick:()=>t("/upload"),className:"btn-primary",children:[n.jsx(vr,{className:"w-4 h-4 mr-2"}),"Upload New Model"]}),n.jsxs("button",{onClick:()=>t("/analytics"),className:"btn-secondary",children:[n.jsx(ke,{className:"w-4 h-4 mr-2"}),"View Analytics"]})]}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Manage your uploaded 3D models. Edit details, delete models, and organize your portfolio."})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(zt,{className:"w-8 h-8 text-primary-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Total Models"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:s.length})]})]})}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(V,{className:"w-8 h-8 text-blue-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Total Views"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:s.reduce((x,C)=>x+(C.views||0),0)})]})]})}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Zt,{className:"w-8 h-8 text-green-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Published"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:s.filter(x=>x.status==="published").length})]})]})}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Z,{className:"w-8 h-8 text-purple-600 mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"This Month"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:s.filter(x=>{const C=new Date(x.created_at),P=new Date;return P.setMonth(P.getMonth()-1),C>P}).length})]})]})})]}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4 mb-6",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Fa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary-400"}),n.jsx("input",{type:"text",placeholder:"Search models by title, description, or tags...",value:l,onChange:x=>c(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white"})]})}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Ua,{className:"w-5 h-5 text-secondary-400"}),n.jsx("select",{value:d,onChange:x=>u(x.target.value),className:"px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",children:N.map(x=>n.jsx("option",{value:x,children:x==="all"?"All Categories":x},x))})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:()=>m("grid"),className:`p-2 rounded-lg transition-colors ${h==="grid"?"bg-primary-100 text-primary-600 dark:bg-primary-900 dark:text-primary-400":"text-secondary-400 hover:text-secondary-600 dark:hover:text-secondary-300"}`,children:n.jsx(zt,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>m("list"),className:`p-2 rounded-lg transition-colors ${h==="list"?"bg-primary-100 text-primary-600 dark:bg-primary-900 dark:text-primary-400":"text-secondary-400 hover:text-secondary-600 dark:hover:text-secondary-300"}`,children:n.jsx(La,{className:"w-5 h-5"})})]})]})}),i?n.jsxs("div",{className:"flex items-center justify-center py-12",children:[n.jsx(me,{className:"w-8 h-8 animate-spin text-primary-600"}),n.jsx("span",{className:"ml-2 text-secondary-600 dark:text-secondary-400",children:"Loading your models..."})]}):g.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Z,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-2",children:l||d!=="all"?"No models found":"No models yet"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:l||d!=="all"?"Try adjusting your search or filters":"Start building your portfolio by uploading your first 3D model"}),!l&&d==="all"&&n.jsxs("button",{onClick:()=>t("/upload"),className:"btn-primary",children:[n.jsx(vr,{className:"w-4 h-4 mr-2"}),"Upload Your First Model"]})]}):n.jsx("div",{className:h==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:g.map(x=>n.jsx(wu,{model:x,viewMode:h,onEdit:()=>t(`/models/${x.id}/edit`),onDelete:()=>y(x.id,x.title),onView:()=>t(`/models/${x.id}`),isDeleting:f===x.id},x.id))})]}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-4",children:"Authentication Required"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"You need to be logged in to manage your models."}),n.jsx("button",{onClick:()=>t("/login"),className:"btn-primary",children:"Sign In"})]})})},wu=({model:r,viewMode:e,onEdit:t,onDelete:s,onView:a,isDeleting:i})=>{const o=c=>{if(c===0)return"0 Bytes";const d=1024,u=["Bytes","KB","MB","GB"],h=Math.floor(Math.log(c)/Math.log(d));return parseFloat((c/Math.pow(d,h)).toFixed(2))+" "+u[h]},l=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e==="list"?n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden bg-secondary-200 dark:bg-secondary-700 flex-shrink-0",children:r.thumbnail_url?n.jsx("img",{src:r.thumbnail_url,alt:r.title,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Z,{className:"w-8 h-8 text-secondary-400"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-white truncate",children:r.title}),n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 line-clamp-2 mb-2",children:r.description}),n.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-500",children:[n.jsx("span",{className:"bg-secondary-100 dark:bg-secondary-700 px-2 py-1 rounded",children:r.category}),n.jsx("span",{children:o(r.file_size)}),n.jsx("span",{children:l(r.created_at)})]})]}),n.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-500",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-secondary-900 dark:text-white",children:r.views||0}),n.jsx("div",{children:"Views"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-secondary-900 dark:text-white",children:r.likes||0}),n.jsx("div",{children:"Likes"})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("button",{onClick:a,className:"p-2 text-secondary-400 hover:text-secondary-600 dark:hover:text-secondary-300 transition-colors",title:"View Model",children:n.jsx(V,{className:"w-4 h-4"})}),n.jsx("button",{onClick:t,className:"p-2 text-blue-400 hover:text-blue-600 transition-colors",title:"Edit Model",children:n.jsx(Bt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:s,disabled:i,className:"p-2 text-red-400 hover:text-red-600 disabled:opacity-50 transition-colors",title:"Delete Model",children:i?n.jsx(me,{className:"w-4 h-4 animate-spin"}):n.jsx(wr,{className:"w-4 h-4"})})]})]})}):n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 overflow-hidden hover:shadow-lg transition-shadow",children:[n.jsxs("div",{className:"aspect-video bg-secondary-200 dark:bg-secondary-700 relative group",children:[r.thumbnail_url?n.jsx("img",{src:r.thumbnail_url,alt:r.title,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Z,{className:"w-16 h-16 text-secondary-400"})}),n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-200 flex items-center justify-center",children:n.jsxs("div",{className:"flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[n.jsx("button",{onClick:a,className:"p-2 bg-white text-secondary-900 rounded-lg hover:bg-secondary-100 transition-colors",title:"View Model",children:n.jsx(V,{className:"w-4 h-4"})}),n.jsx("button",{onClick:t,className:"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",title:"Edit Model",children:n.jsx(Bt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:s,disabled:i,className:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 transition-colors",title:"Delete Model",children:i?n.jsx(me,{className:"w-4 h-4 animate-spin"}):n.jsx(wr,{className:"w-4 h-4"})})]})})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-white mb-2 line-clamp-1",children:r.title}),n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 line-clamp-2 mb-3",children:r.description}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-secondary-500 mb-3",children:[n.jsx("span",{className:"bg-secondary-100 dark:bg-secondary-700 px-2 py-1 rounded",children:r.category}),n.jsx("span",{children:o(r.file_size)})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-secondary-500",children:l(r.created_at)}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("span",{className:"flex items-center",children:[n.jsx(V,{className:"w-4 h-4 mr-1"}),r.views||0]}),n.jsxs("span",{className:"flex items-center",children:[n.jsx(Zt,{className:"w-4 h-4 mr-1"}),r.likes||0]})]})]})]})]})},ju=()=>{var $;const{user:r}=ee(),e=Ve(),{modelId:t}=ir(),[s,a]=j.useState(null),[i,o]=j.useState(!0),[l,c]=j.useState(!1),[d,u]=j.useState({}),[h,m]=j.useState({title:"",description:"",category:"",tags:""}),[f,p]=j.useState(null),[w,g]=j.useState(null),[y,N]=j.useState(""),[x,C]=j.useState(""),P=j.useRef(null),S=j.useRef(null);j.useEffect(()=>{t&&r&&_()},[t,r]);const _=async()=>{try{o(!0);const{data:E,error:I}=await T.from("models").select("*").eq("id",t).eq("user_id",r.id).single();if(I)throw I;if(!E){O.error("Model not found or you do not have permission to edit it"),e("/models");return}a(E),m({title:E.title||"",description:E.description||"",category:E.category||"",tags:E.tags||""}),E.thumbnail_url&&N(E.thumbnail_url),E.preview_url&&C(E.preview_url),console.log("📦 Model loaded for editing:",E)}catch(E){console.error("❌ Error fetching model:",E),O.error("Failed to load model"),e("/models")}finally{o(!1)}},R=E=>{const{name:I,value:z}=E.target;m(le=>({...le,[I]:z})),u(le=>({...le,[I]:null}))},A=E=>{if(E){if(E.size>5*1024*1024){O.error("Thumbnail image must be less than 5MB");return}if(!["image/jpeg","image/png","image/webp"].includes(E.type)){O.error("Please select a JPEG, PNG, or WebP image");return}p(E),N(URL.createObjectURL(E)),u(z=>({...z,thumbnail:null}))}},b=E=>{if(E){if(E.size>10*1024*1024){O.error("Preview image must be less than 10MB");return}if(!["image/jpeg","image/png","image/webp"].includes(E.type)){O.error("Please select a JPEG, PNG, or WebP image");return}g(E),C(URL.createObjectURL(E)),u(z=>({...z,preview:null}))}},k=()=>{const E={};return h.title.trim()?h.title.length<3?E.title="Title must be at least 3 characters":h.title.length>100&&(E.title="Title must be less than 100 characters"):E.title="Title is required",h.description.trim()?h.description.length<10?E.description="Description must be at least 10 characters":h.description.length>1e3&&(E.description="Description must be less than 1000 characters"):E.description="Description is required",h.category.trim()||(E.category="Category is required"),h.tags&&h.tags.length>200&&(E.tags="Tags must be less than 200 characters"),u(E),Object.keys(E).length===0},D=async E=>{if(E.preventDefault(),!k()){O.error("Please fix the errors before saving");return}c(!0);try{let I=(s==null?void 0:s.thumbnail_url)||null,z=(s==null?void 0:s.preview_url)||null;if(f){console.log("📤 Uploading new thumbnail...");const J=`thumbnail_${t}_${Date.now()}.${f.name.split(".").pop()}`,{data:ye,error:ce}=await T.storage.from("thumbnails").upload(`${r.id}/${J}`,f);if(ce)throw ce;const{data:{publicUrl:Ee}}=T.storage.from("thumbnails").getPublicUrl(`${r.id}/${J}`);I=Ee,console.log("✅ Thumbnail upload successful")}if(w){console.log("📤 Uploading new preview...");const J=`preview_${t}_${Date.now()}.${w.name.split(".").pop()}`,{data:ye,error:ce}=await T.storage.from("previews").upload(`${r.id}/${J}`,w);if(ce)throw ce;const{data:{publicUrl:Ee}}=T.storage.from("previews").getPublicUrl(`${r.id}/${J}`);z=Ee,console.log("✅ Preview upload successful")}console.log("💾 Updating model...");const{data:le,error:ie}=await T.from("models").update({title:h.title,description:h.description,category:h.category,tags:h.tags,thumbnail_url:I,preview_url:z,updated_at:new Date().toISOString()}).eq("id",t).eq("user_id",r.id).select().single();if(ie)throw ie;console.log("✅ Model updated successfully"),O.success("Model updated successfully!"),e(`/models/${t}`)}catch(I){console.error("❌ Model update failed:",I),O.error(I.message||"Failed to update model")}finally{c(!1)}};return r?i?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(me,{className:"w-8 h-8 animate-spin text-primary-600 mx-auto mb-4"}),n.jsx("span",{className:"text-secondary-600 dark:text-secondary-400",children:"Loading model..."})]})}):s?n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[n.jsxs("button",{onClick:()=>e(-1),className:"btn-secondary",children:[n.jsx(wt,{className:"w-4 h-4 mr-2"}),"Back"]}),n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Edit Model"})]}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Update your 3D model details, images, and metadata."})]}),n.jsxs("form",{onSubmit:D,className:"space-y-8",children:[n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4 flex items-center",children:[n.jsx(dn,{className:"w-5 h-5 mr-2"}),"Model Information"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Title *"}),n.jsx("input",{type:"text",id:"title",name:"title",value:h.title,onChange:R,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Enter model title"}),d.title&&n.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),d.title]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Description *"}),n.jsx("textarea",{id:"description",name:"description",rows:"4",value:h.description,onChange:R,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"Describe your 3D model, its features, and intended use..."}),n.jsxs("p",{className:"mt-1 text-sm text-secondary-500",children:[h.description.length,"/1000 characters"]}),d.description&&n.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),d.description]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Category *"}),n.jsxs("select",{id:"category",name:"category",value:h.category,onChange:R,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",children:[n.jsx("option",{value:"",children:"Select a category"}),n.jsx("option",{value:"Characters",children:"Characters"}),n.jsx("option",{value:"Vehicles",children:"Vehicles"}),n.jsx("option",{value:"Buildings",children:"Buildings"}),n.jsx("option",{value:"Props",children:"Props"}),n.jsx("option",{value:"Environment",children:"Environment"}),n.jsx("option",{value:"Weapons",children:"Weapons"}),n.jsx("option",{value:"Animals",children:"Animals"}),n.jsx("option",{value:"Furniture",children:"Furniture"}),n.jsx("option",{value:"Machinery",children:"Machinery"}),n.jsx("option",{value:"Other",children:"Other"})]}),d.category&&n.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),d.category]})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Tags"}),n.jsx("input",{type:"text",id:"tags",name:"tags",value:h.tags,onChange:R,className:"w-full px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",placeholder:"3d,model,game,realistic,low-poly (comma separated)"}),n.jsxs("p",{className:"mt-1 text-sm text-secondary-500",children:["Separate tags with commas. ",h.tags.length,"/200 characters"]}),d.tags&&n.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[n.jsx(Re,{className:"w-4 h-4 mr-1"}),d.tags]})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4 flex items-center",children:[n.jsx($s,{className:"w-5 h-5 mr-2"}),"Images"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-secondary-900 dark:text-white mb-3",children:"Thumbnail"}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden bg-secondary-200 dark:bg-secondary-700",children:y?n.jsx("img",{src:y,alt:"Thumbnail preview",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx($s,{className:"w-12 h-12 text-secondary-400"})})}),n.jsxs("button",{type:"button",onClick:()=>{var E;return(E=P.current)==null?void 0:E.click()},className:"btn-secondary w-full",children:[n.jsx(Z,{className:"w-4 h-4 mr-2"}),"Update Thumbnail"]}),n.jsx("input",{ref:P,type:"file",accept:"image/*",onChange:E=>{var I;return A((I=E.target.files)==null?void 0:I[0])},className:"hidden"}),n.jsx("p",{className:"text-xs text-secondary-500 text-center",children:"Recommended: 16:9 ratio, max 5MB"})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-secondary-900 dark:text-white mb-3",children:"Preview Image"}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden bg-secondary-200 dark:bg-secondary-700",children:x?n.jsx("img",{src:x,alt:"Preview image",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(V,{className:"w-12 h-12 text-secondary-400"})})}),n.jsxs("button",{type:"button",onClick:()=>{var E;return(E=S.current)==null?void 0:E.click()},className:"btn-secondary w-full",children:[n.jsx(Z,{className:"w-4 h-4 mr-2"}),"Update Preview"]}),n.jsx("input",{ref:S,type:"file",accept:"image/*",onChange:E=>{var I;return b((I=E.target.files)==null?void 0:I[0])},className:"hidden"}),n.jsx("p",{className:"text-xs text-secondary-500 text-center",children:"High-quality preview, max 10MB"})]})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4 flex items-center",children:[n.jsx(zt,{className:"w-5 h-5 mr-2"}),"Model File Information"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"text-center p-4 bg-secondary-50 dark:bg-secondary-700 rounded-lg",children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"File Size"}),n.jsx("p",{className:"text-lg font-semibold text-secondary-900 dark:text-white",children:s.file_size?`${(s.file_size/1024/1024).toFixed(2)} MB`:"Unknown"})]}),n.jsxs("div",{className:"text-center p-4 bg-secondary-50 dark:bg-secondary-700 rounded-lg",children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"File Type"}),n.jsx("p",{className:"text-lg font-semibold text-secondary-900 dark:text-white",children:(($=s.file_type)==null?void 0:$.toUpperCase())||"Unknown"})]}),n.jsxs("div",{className:"text-center p-4 bg-secondary-50 dark:bg-secondary-700 rounded-lg",children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Upload Date"}),n.jsx("p",{className:"text-lg font-semibold text-secondary-900 dark:text-white",children:new Date(s.created_at).toLocaleDateString()})]})]}),n.jsx("p",{className:"text-sm text-secondary-500 text-center mt-4",children:"The 3D model file cannot be changed. Contact support if you need to replace the file."})]}),n.jsxs("div",{className:"flex justify-end space-x-4",children:[n.jsx("button",{type:"button",onClick:()=>e(-1),className:"btn-secondary",disabled:l,children:"Cancel"}),n.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?n.jsxs(n.Fragment,{children:[n.jsx(me,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(pn,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})]}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-4",children:"Model Not Found"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"The model you're looking for doesn't exist or you don't have permission to edit it."}),n.jsx("button",{onClick:()=>e("/models"),className:"btn-primary",children:"Back to Models"})]})}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-4",children:"Authentication Required"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"You need to be logged in to edit models."}),n.jsx("button",{onClick:()=>e("/login"),className:"btn-primary",children:"Sign In"})]})})},Sa={async downloadModel(r,e){var t;try{const a=await(await fetch("https://api.ipify.org?format=json")).json(),{error:i}=await T.from("downloads").insert({model_id:r,user_id:(t=(await T.auth.getUser()).data.user)==null?void 0:t.id,ip_address:a.ip,user_agent:navigator.userAgent});i&&console.error("Error recording download:",i);const{data:o,error:l}=await T.storage.from("models").download(e.file_url);if(l)throw new Error("Failed to download file from storage");const c=window.URL.createObjectURL(o),d=document.createElement("a");return d.href=c,d.download=`${e.title}.${e.file_type||"zip"}`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),document.body.removeChild(d),{success:!0}}catch(s){throw console.error("Download error:",s),s}},async getDownloadStats(r){try{const{data:e,error:t}=await T.from("downloads").select("*").eq("model_id",r);if(t)throw t;const s=new Date,a=new Date(s.getFullYear(),s.getMonth(),s.getDate()),i=new Date(a.getTime()-7*24*60*60*1e3),o=new Date(a.getTime()-30*24*60*60*1e3);return{total:e.length,today:e.filter(l=>new Date(l.downloaded_at)>=a).length,thisWeek:e.filter(l=>new Date(l.downloaded_at)>=i).length,thisMonth:e.filter(l=>new Date(l.downloaded_at)>=o).length}}catch(e){throw console.error("Error getting download stats:",e),e}},async getUserDownloadHistory(){try{const{data:{user:r}}=await T.auth.getUser();if(!r)throw new Error("User not authenticated");const{data:e,error:t}=await T.from("downloads").select(`
          *,
          model:models(
            id,
            title,
            description,
            thumbnail_url,
            category,
            file_type,
            file_size
          )
        `).eq("user_id",r.id).order("downloaded_at",{ascending:!1});if(t)throw t;return e}catch(r){throw console.error("Error getting download history:",r),r}}},ku=({model:r,className:e=""})=>{const[t,s]=j.useState(!1),[a,i]=j.useState(!1),[o,l]=j.useState(null),{user:c,isAuthenticated:d}=ee(),u=async()=>{if(!d){O.error("Please log in to download models");return}if(!r.file_url){O.error("No file available for download");return}s(!0),l(null);try{await Sa.downloadModel(r.id,r),i(!0),O.success("Download completed successfully!"),setTimeout(()=>i(!1),3e3)}catch(f){console.error("Download error:",f),l(f.message),O.error("Download failed. Please try again.")}finally{s(!1)}},h=()=>a?n.jsxs(n.Fragment,{children:[n.jsx(Zt,{className:"w-4 h-4"}),"Downloaded"]}):t?n.jsxs(n.Fragment,{children:[n.jsx(me,{className:"w-4 h-4 animate-spin"}),"Downloading..."]}):o?n.jsxs(n.Fragment,{children:[n.jsx(Re,{className:"w-4 h-4"}),"Retry Download"]}):n.jsxs(n.Fragment,{children:[n.jsx(de,{className:"w-4 h-4"}),"Download"]}),m=()=>{let f="inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2";return a?`${f} bg-green-600 text-white hover:bg-green-700 focus:ring-green-500`:t?`${f} bg-blue-600 text-white cursor-not-allowed opacity-75`:o?`${f} bg-red-600 text-white hover:bg-red-700 focus:ring-red-500`:`${f} bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500 ${e}`};return n.jsxs("div",{className:"space-y-2",children:[n.jsx("button",{onClick:u,disabled:t,className:m(),children:h()}),r.download_count>0&&n.jsxs("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 text-center",children:[r.download_count," download",r.download_count!==1?"s":""]}),o&&n.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:o})]})},_u=()=>{var u,h,m,f,p,w;const{modelId:r}=ir(),[e,t]=j.useState(null),[s,a]=j.useState(!0),[i,o]=j.useState(null),{user:l,isAuthenticated:c}=ee();j.useEffect(()=>{r&&d()},[r]);const d=async()=>{try{a(!0);const g=await fetch(`/api/models/${r}`);if(!g.ok)throw new Error("Failed to fetch model details");const y=await g.json();t(y)}catch(g){console.error("Error fetching model:",g),o(g.message),O.error("Failed to load model details")}finally{a(!1)}};return s?n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-8 h-8 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Loading model details..."})]})}):i||!e?n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(De,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-2",children:"Model Not Found"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-4",children:i||"The model you are looking for could not be found."}),n.jsx(L,{to:"/explore",className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Explore Models"})]})}):n.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-secondary-600 dark:text-secondary-400 mb-6",children:[n.jsx(L,{to:"/",className:"hover:text-secondary-900 dark:hover:text-white transition-colors",children:"Home"}),n.jsx("span",{children:"/"}),n.jsx(L,{to:"/explore",className:"hover:text-secondary-900 dark:hover:text-white transition-colors",children:"Explore"}),n.jsx("span",{children:"/"}),n.jsx("span",{className:"text-secondary-900 dark:text-white",children:e.title})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg shadow-sm border border-secondary-200 dark:border-secondary-700 overflow-hidden",children:n.jsx("div",{className:"aspect-video bg-secondary-100 dark:bg-secondary-700 flex items-center justify-center",children:e.preview_url?n.jsx("img",{src:e.preview_url,alt:e.title,className:"w-full h-full object-cover"}):n.jsxs("div",{className:"text-center",children:[n.jsx(De,{className:"w-16 h-16 text-secondary-400 mx-auto mb-2"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"3D Preview"}),n.jsx("p",{className:"text-sm text-secondary-500 dark:text-secondary-400",children:"Preview not available"})]})})}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg shadow-sm border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white mb-4",children:e.title}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:e.description||"No description available."}),e.tags&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-2",children:"Tags"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e.tags.split(",").map((g,y)=>n.jsx("span",{className:"px-3 py-1 bg-secondary-100 dark:bg-secondary-700 text-secondary-700 dark:text-secondary-300 rounded-full text-sm",children:g.trim()},y))})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 py-4 border-t border-secondary-200 dark:border-secondary-700",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg mx-auto mb-2",children:n.jsx(V,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:e.view_count||0}),n.jsx("p",{className:"text-xs text-secondary-500 dark:text-secondary-400",children:"Views"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-green-100 dark:bg-green-900 rounded-lg mx-auto mb-2",children:n.jsx(de,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:e.download_count||0}),n.jsx("p",{className:"text-xs text-secondary-500 dark:text-secondary-400",children:"Downloads"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-red-100 dark:bg-red-900 rounded-lg mx-auto mb-2",children:n.jsx(_e,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:e.like_count||0}),n.jsx("p",{className:"text-xs text-secondary-500 dark:text-secondary-400",children:"Likes"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-lg mx-auto mb-2",children:n.jsx(Ia,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:e.comment_count||0}),n.jsx("p",{className:"text-xs text-secondary-500 dark:text-secondary-400",children:"Comments"})]})]})]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg shadow-sm border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-white mb-4",children:"Download Model"}),n.jsx(ku,{model:e,className:"w-full"}),n.jsxs("div",{className:"mt-4 space-y-2 text-sm text-secondary-600 dark:text-secondary-400",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"File Type:"}),n.jsx("span",{className:"font-medium",children:((u=e.file_type)==null?void 0:u.toUpperCase())||"Unknown"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"File Size:"}),n.jsx("span",{className:"font-medium",children:e.file_size?`${(e.file_size/1024/1024).toFixed(2)} MB`:"Unknown"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Category:"}),n.jsx("span",{className:"font-medium",children:e.category||"Uncategorized"})]})]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg shadow-sm border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-white mb-4",children:"Creator"}),n.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[(h=e.creator)!=null&&h.avatar_url?n.jsx("img",{src:e.creator.avatar_url,alt:e.creator.username,className:"w-12 h-12 rounded-full object-cover"}):n.jsx("div",{className:"w-12 h-12 bg-secondary-200 dark:bg-secondary-700 rounded-full flex items-center justify-center",children:n.jsx(Ne,{className:"w-6 h-6 text-secondary-400"})}),n.jsxs("div",{children:[n.jsx(L,{to:`/profile/${(m=e.creator)==null?void 0:m.username}`,className:"font-medium text-secondary-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:((f=e.creator)==null?void 0:f.username)||"Unknown Creator"}),((p=e.creator)==null?void 0:p.bio)&&n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:e.creator.bio})]})]}),n.jsx(L,{to:`/profile/${(w=e.creator)==null?void 0:w.username}`,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg text-sm font-medium text-secondary-700 dark:text-secondary-300 hover:bg-secondary-50 dark:hover:bg-secondary-700 transition-colors",children:"View Profile"})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg shadow-sm border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-secondary-900 dark:text-white mb-4",children:"Model Details"}),n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(at,{className:"w-4 h-4 text-secondary-400"}),n.jsxs("span",{className:"text-secondary-600 dark:text-secondary-400",children:["Created: ",new Date(e.created_at).toLocaleDateString()]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Ma,{className:"w-4 h-4 text-secondary-400"}),n.jsxs("span",{className:"text-secondary-600 dark:text-secondary-400",children:["Category: ",e.category||"Uncategorized"]})]}),e.is_featured&&n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-4 h-4 bg-yellow-400 rounded-full"}),n.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-medium",children:"Featured Model"})]})]})]})]})]})]})},Nu=()=>{const{user:r}=ee(),e=Ve(),[t,s]=j.useState([]),[a,i]=j.useState(!0),[o,l]=j.useState("30"),[c,d]=j.useState("all"),[u,h]=j.useState({totalViews:0,totalDownloads:0,totalLikes:0,avgViewsPerModel:0,topPerformingModel:null,recentActivity:[]});j.useEffect(()=>{r&&m()},[r,o]);const m=async()=>{try{i(!0);const{data:y,error:N}=await T.from("models").select(`
          *,
          creator:profiles!models_user_id_fkey(username, avatar_url)
        `).eq("user_id",r.id).order("created_at",{ascending:!1});if(N)throw N;s(y||[]),await f(y||[]),console.log("📊 Analytics loaded for models:",y)}catch(y){console.error("❌ Error fetching models:",y),O.error("Failed to load your models")}finally{i(!1)}},f=async y=>{if(!y.length)return;const N=new Date;new Date(N.getTime()-parseInt(o)*24*60*60*1e3);const x=y.reduce((A,b)=>A+(b.views||0),0),C=y.reduce((A,b)=>A+(b.downloads||0),0),P=y.reduce((A,b)=>A+(b.likes||0),0),S=x/y.length,_=y.reduce((A,b)=>{const k=(b.views||0)+(b.likes||0)*2+(b.downloads||0)*3,D=(A.views||0)+(A.likes||0)*2+(A.downloads||0)*3;return k>D?b:A}),R=y.filter(A=>new Date(A.updated_at||A.created_at)>new Date(N.getTime()-7*24*60*60*1e3)).map(A=>({id:A.id,title:A.title,action:A.updated_at?"Updated":"Created",date:new Date(A.updated_at||A.created_at),views:A.views||0,likes:A.likes||0,downloads:A.downloads||0})).sort((A,b)=>b.date-A.date).slice(0,5);h({totalViews:x,totalDownloads:C,totalLikes:P,avgViewsPerModel:Math.round(S*100)/100,topPerformingModel:_,recentActivity:R})},p=async()=>{await m(),O.success("Analytics refreshed!")},w=y=>{const N=y.views||0,x=y.likes||0,C=y.downloads||0,P=N+x*2+C*3;return P===0?{level:"New",color:"text-gray-500",bgColor:"bg-gray-100"}:P<10?{level:"Low",color:"text-red-500",bgColor:"bg-red-100"}:P<50?{level:"Medium",color:"text-yellow-500",bgColor:"bg-yellow-100"}:P<100?{level:"Good",color:"text-blue-500",bgColor:"bg-blue-100"}:{level:"Excellent",color:"text-green-500",bgColor:"bg-green-100"}},g=y=>y>=1e6?(y/1e6).toFixed(1)+"M":y>=1e3?(y/1e3).toFixed(1)+"K":y.toString();return r?n.jsxs("div",{className:"max-w-7xl mx-auto",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsxs("button",{onClick:()=>e(-1),className:"btn-secondary",children:[n.jsx(wt,{className:"w-4 h-4 mr-2"}),"Back"]}),n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:"Model Analytics"})]}),n.jsxs("button",{onClick:p,className:"btn-secondary",disabled:a,children:[n.jsx(qa,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),"Refresh"]})]}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Track the performance of your 3D models and understand what resonates with your audience."})]}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-4 mb-6",children:n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(at,{className:"w-5 h-5 text-secondary-400"}),n.jsx("span",{className:"text-sm font-medium text-secondary-700 dark:text-secondary-300",children:"Time Range:"}),n.jsxs("select",{value:o,onChange:y=>l(y.target.value),className:"px-3 py-2 border border-secondary-300 dark:border-secondary-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-secondary-700 dark:text-white",children:[n.jsx("option",{value:"7",children:"Last 7 days"}),n.jsx("option",{value:"30",children:"Last 30 days"}),n.jsx("option",{value:"90",children:"Last 90 days"})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Total Views"}),n.jsx("p",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:g(u.totalViews)})]}),n.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg",children:n.jsx(V,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})})]}),n.jsxs("div",{className:"mt-4 flex items-center text-sm text-secondary-600 dark:text-secondary-400",children:[n.jsx(bs,{className:"w-4 h-4 mr-1"}),u.avgViewsPerModel," avg per model"]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Total Downloads"}),n.jsx("p",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:g(u.totalDownloads)})]}),n.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:n.jsx(de,{className:"w-8 h-8 text-green-600 dark:text-green-400"})})]}),n.jsxs("div",{className:"mt-4 flex items-center text-sm text-secondary-600 dark:text-secondary-400",children:[n.jsx(Ba,{className:"w-4 h-4 mr-1"}),u.totalViews>0?Math.round(u.totalDownloads/u.totalViews*100):0,"% conversion"]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Total Likes"}),n.jsx("p",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:g(u.totalLikes)})]}),n.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900 rounded-lg",children:n.jsx(_e,{className:"w-8 h-8 text-red-600 dark:text-red-400"})})]}),n.jsxs("div",{className:"mt-4 flex items-center text-sm text-secondary-600 dark:text-secondary-400",children:[n.jsx(cn,{className:"w-4 h-4 mr-1"}),u.totalViews>0?Math.round(u.totalLikes/u.totalViews*100):0,"% engagement"]})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400",children:"Total Models"}),n.jsx("p",{className:"text-3xl font-bold text-secondary-900 dark:text-white",children:t.length})]}),n.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-lg",children:n.jsx(ke,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})})]}),n.jsxs("div",{className:"mt-4 flex items-center text-sm text-secondary-600 dark:text-secondary-400",children:[n.jsx(za,{className:"w-4 h-4 mr-1"}),t.length>0?Math.round(u.totalViews/t.length):0," avg views"]})]})]}),u.topPerformingModel&&n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6 mb-8",children:[n.jsxs("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4 flex items-center",children:[n.jsx(Ht,{className:"w-5 h-5 mr-2 text-green-500"}),"Top Performing Model"]}),n.jsxs("div",{className:"flex items-center space-x-6",children:[n.jsx("div",{className:"w-24 h-24 rounded-lg overflow-hidden bg-secondary-200 dark:bg-secondary-700 flex-shrink-0",children:u.topPerformingModel.thumbnail_url?n.jsx("img",{src:u.topPerformingModel.thumbnail_url,alt:u.topPerformingModel.title,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(ke,{className:"w-12 h-12 text-secondary-400"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-2",children:u.topPerformingModel.title}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-4",children:u.topPerformingModel.description}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.topPerformingModel.views||0}),n.jsx("div",{className:"text-sm text-secondary-500",children:"Views"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:u.topPerformingModel.downloads||0}),n.jsx("div",{className:"text-sm text-secondary-500",children:"Downloads"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-red-600",children:u.topPerformingModel.likes||0}),n.jsx("div",{className:"text-sm text-secondary-500",children:"Likes"})]})]})]}),n.jsx("button",{onClick:()=>e(`/models/${u.topPerformingModel.id}`),className:"btn-primary",children:"View Model"})]})]}),u.recentActivity.length>0&&n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6 mb-8",children:[n.jsxs("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4 flex items-center",children:[n.jsx(bs,{className:"w-5 h-5 mr-2"}),"Recent Activity"]}),n.jsx("div",{className:"space-y-4",children:u.recentActivity.map(y=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-secondary-50 dark:bg-secondary-700 rounded-lg",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900 rounded-full flex items-center justify-center",children:n.jsx(bs,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-secondary-900 dark:text-white",children:[y.title," was ",y.action.toLowerCase()]}),n.jsxs("p",{className:"text-sm text-secondary-500",children:[y.date.toLocaleDateString()," at ",y.date.toLocaleTimeString()]})]})]}),n.jsxs("div",{className:"flex items-center space-x-6 text-sm text-secondary-500",children:[n.jsxs("span",{className:"flex items-center",children:[n.jsx(V,{className:"w-4 h-4 mr-1"}),y.views]}),n.jsxs("span",{className:"flex items-center",children:[n.jsx(_e,{className:"w-4 h-4 mr-1"}),y.likes]}),n.jsxs("span",{className:"flex items-center",children:[n.jsx(de,{className:"w-4 h-4 mr-1"}),y.downloads]})]})]},y.id))})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg border border-secondary-200 dark:border-secondary-700 p-6",children:[n.jsxs("h2",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-4 flex items-center",children:[n.jsx(ke,{className:"w-5 h-5 mr-2"}),"Models Performance"]}),a?n.jsxs("div",{className:"flex items-center justify-center py-12",children:[n.jsx(me,{className:"w-8 h-8 animate-spin text-primary-600"}),n.jsx("span",{className:"ml-2 text-secondary-600 dark:text-secondary-400",children:"Loading analytics..."})]}):t.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx(ke,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-secondary-900 dark:text-white mb-2",children:"No models yet"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"Upload your first 3D model to start tracking analytics."}),n.jsx("button",{onClick:()=>e("/upload"),className:"btn-primary",children:"Upload Model"})]}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-secondary-200 dark:border-secondary-700",children:[n.jsx("th",{className:"text-left py-3 px-4 font-medium text-secondary-700 dark:text-secondary-300",children:"Model"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-secondary-700 dark:text-secondary-300",children:"Views"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-secondary-700 dark:text-secondary-300",children:"Downloads"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-secondary-700 dark:text-secondary-300",children:"Likes"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-secondary-700 dark:text-secondary-300",children:"Performance"}),n.jsx("th",{className:"text-center py-3 px-4 font-medium text-secondary-700 dark:text-secondary-300",children:"Actions"})]})}),n.jsx("tbody",{children:t.map(y=>{const N=w(y);return n.jsxs("tr",{className:"border-b border-secondary-100 dark:border-secondary-800 hover:bg-secondary-50 dark:hover:bg-secondary-700",children:[n.jsx("td",{className:"py-4 px-4",children:n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-secondary-200 dark:bg-secondary-700 flex-shrink-0",children:y.thumbnail_url?n.jsx("img",{src:y.thumbnail_url,alt:y.title,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(ke,{className:"w-6 h-6 text-secondary-400"})})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:y.title}),n.jsx("p",{className:"text-sm text-secondary-500",children:y.category})]})]})}),n.jsx("td",{className:"text-center py-4 px-4",children:n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(V,{className:"w-4 h-4 text-blue-500"}),n.jsx("span",{className:"font-medium",children:y.views||0})]})}),n.jsx("td",{className:"text-center py-4 px-4",children:n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(de,{className:"w-4 h-4 text-green-500"}),n.jsx("span",{className:"font-medium",children:y.downloads||0})]})}),n.jsx("td",{className:"text-center py-4 px-4",children:n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(_e,{className:"w-4 h-4 text-red-500"}),n.jsx("span",{className:"font-medium",children:y.likes||0})]})}),n.jsx("td",{className:"text-center py-4 px-4",children:n.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${N.bgColor} ${N.color}`,children:N.level})}),n.jsx("td",{className:"text-center py-4 px-4",children:n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("button",{onClick:()=>e(`/models/${y.id}`),className:"p-2 text-blue-500 hover:bg-blue-100 dark:hover:bg-blue-900 rounded-lg transition-colors",title:"View Model",children:n.jsx(V,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>e(`/models/${y.id}/edit`),className:"p-2 text-green-500 hover:bg-green-100 dark:hover:bg-green-900 rounded-lg transition-colors",title:"Edit Model",children:n.jsx(ke,{className:"w-4 h-4"})})]})})]},y.id)})})]})})]})]}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-4",children:"Authentication Required"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-6",children:"You need to be logged in to view analytics."}),n.jsx("button",{onClick:()=>e("/login"),className:"btn-primary",children:"Sign In"})]})})},Su=()=>{const[r,e]=j.useState([]),[t,s]=j.useState(!0),[a,i]=j.useState({total:0,thisWeek:0,thisMonth:0}),{user:o,isAuthenticated:l}=ee();j.useEffect(()=>{l&&c()},[l]);const c=async()=>{try{s(!0);const u=await Sa.getUserDownloadHistory();e(u);const h=new Date,m=new Date(h.getTime()-7*24*60*60*1e3),f=new Date(h.getTime()-30*24*60*60*1e3),p=u.filter(g=>new Date(g.downloaded_at)>=m).length,w=u.filter(g=>new Date(g.downloaded_at)>=f).length;i({total:u.length,thisWeek:p,thisMonth:w})}catch(u){console.error("Error fetching download history:",u)}finally{s(!1)}},d=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return l?t?n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-8 h-8 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Loading download history..."})]})}):n.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n.jsxs("div",{className:"mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold text-secondary-900 dark:text-white mb-2",children:"Download History"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Track all the 3D models you've downloaded"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg p-6 shadow-sm border border-secondary-200 dark:border-secondary-700",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:n.jsx(de,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:"Total Downloads"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:a.total})]})]})}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg p-6 shadow-sm border border-secondary-200 dark:border-secondary-700",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:n.jsx(Ht,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:"This Week"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:a.thisWeek})]})]})}),n.jsx("div",{className:"bg-white dark:bg-secondary-800 rounded-lg p-6 shadow-sm border border-secondary-200 dark:border-secondary-700",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg",children:n.jsx(at,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),n.jsxs("div",{className:"ml-4",children:[n.jsx("p",{className:"text-sm font-medium text-secondary-600 dark:text-secondary-400",children:"This Month"}),n.jsx("p",{className:"text-2xl font-bold text-secondary-900 dark:text-white",children:a.thisMonth})]})]})})]}),n.jsxs("div",{className:"bg-white dark:bg-secondary-800 rounded-lg shadow-sm border border-secondary-200 dark:border-secondary-700",children:[n.jsx("div",{className:"px-6 py-4 border-b border-secondary-200 dark:border-secondary-700",children:n.jsx("h2",{className:"text-lg font-semibold text-secondary-900 dark:text-white",children:"Recent Downloads"})}),r.length===0?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx(De,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-secondary-900 dark:text-white mb-2",children:"No downloads yet"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-4",children:"Start exploring and downloading 3D models to see them here."}),n.jsx(L,{to:"/explore",className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Explore Models"})]}):n.jsx("div",{className:"divide-y divide-secondary-200 dark:divide-secondary-700",children:r.map(u=>{var h,m,f,p;return n.jsx("div",{className:"p-6 hover:bg-secondary-50 dark:hover:bg-secondary-700 transition-colors",children:n.jsxs("div",{className:"flex items-start space-x-4",children:[(h=u.model)!=null&&h.thumbnail_url?n.jsx("img",{src:u.model.thumbnail_url,alt:u.model.title,className:"w-16 h-16 object-cover rounded-lg bg-secondary-200 dark:bg-secondary-600"}):n.jsx("div",{className:"w-16 h-16 bg-secondary-200 dark:bg-secondary-600 rounded-lg flex items-center justify-center",children:n.jsx(De,{className:"w-8 h-8 text-secondary-400"})}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-medium text-secondary-900 dark:text-white mb-1",children:((m=u.model)==null?void 0:m.title)||"Unknown Model"}),n.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 mb-2",children:((f=u.model)==null?void 0:f.description)||"No description available"}),n.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-500 dark:text-secondary-400",children:[n.jsxs("span",{className:"flex items-center",children:[n.jsx(at,{className:"w-4 h-4 mr-1"}),d(u.downloaded_at)]}),((p=u.model)==null?void 0:p.category)&&n.jsx("span",{className:"px-2 py-1 bg-secondary-100 dark:bg-secondary-700 rounded-full text-xs",children:u.model.category})]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs(L,{to:`/models/${u.model_id}`,className:"inline-flex items-center px-3 py-2 text-sm font-medium text-secondary-700 dark:text-secondary-300 hover:text-secondary-900 dark:hover:text-white transition-colors",children:[n.jsx(V,{className:"w-4 h-4 mr-1"}),"View"]}),n.jsxs("button",{onClick:()=>{var w;return window.open((w=u.model)==null?void 0:w.file_url,"_blank")},className:"inline-flex items-center px-3 py-2 text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors",children:[n.jsx(de,{className:"w-4 h-4 mr-1"}),"Download Again"]})]})]})})]})},u.id)})})]})]}):n.jsx("div",{className:"min-h-screen bg-secondary-50 dark:bg-secondary-900 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(De,{className:"w-16 h-16 text-secondary-400 mx-auto mb-4"}),n.jsx("h2",{className:"text-2xl font-bold text-secondary-900 dark:text-white mb-2",children:"Access Denied"}),n.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mb-4",children:"Please log in to view your download history."}),n.jsx(L,{to:"/login",className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Go to Login"})]})})};function Eu(){return n.jsx(Cc,{children:n.jsx(Tc,{children:n.jsx(Oc,{children:n.jsxs(Ja,{children:[n.jsx(te,{path:"/",element:n.jsx(uu,{})}),n.jsx(te,{path:"/login",element:n.jsx(hu,{})}),n.jsx(te,{path:"/signup",element:n.jsx(fu,{})}),n.jsx(te,{path:"/dashboard",element:n.jsx(mu,{})}),n.jsx(te,{path:"/explore",element:n.jsx(pu,{})}),n.jsx(te,{path:"/upload",element:n.jsx(xu,{})}),n.jsx(te,{path:"/forgot-password",element:n.jsx(gu,{})}),n.jsx(te,{path:"/profile/:username",element:n.jsx(yu,{})}),n.jsx(te,{path:"/profile/edit",element:n.jsx(bu,{})}),n.jsx(te,{path:"/models",element:n.jsx(vu,{})}),n.jsx(te,{path:"/models/:modelId/edit",element:n.jsx(ju,{})}),n.jsx(te,{path:"/models/:modelId",element:n.jsx(_u,{})}),n.jsx(te,{path:"/analytics",element:n.jsx(Nu,{})}),n.jsx(te,{path:"/downloads",element:n.jsx(Su,{})})]})})})})}const Cu=new pi({defaultOptions:{queries:{retry:3,refetchOnWindowFocus:!1,staleTime:5*60*1e3,cacheTime:10*60*1e3}}});Fs.createRoot(document.getElementById("root")).render(n.jsx(nt.StrictMode,{children:n.jsx(vi,{client:Cu,children:n.jsxs(Ga,{children:[n.jsx(Eu,{}),n.jsx(uo,{position:"top-right",toastOptions:{duration:4e3,style:{background:"var(--toast-bg)",color:"var(--toast-color)",border:"1px solid var(--toast-border)"}}})]})})}));
//# sourceMappingURL=index-D7jYKbQr.js.map
